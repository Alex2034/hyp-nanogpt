W0216 01:29:32.254889 140275123599168 torch/distributed/run.py:779] 
W0216 01:29:32.254889 140275123599168 torch/distributed/run.py:779] *****************************************
W0216 01:29:32.254889 140275123599168 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 01:29:32.254889 140275123599168 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 0] Training DataLoader: 2700000000 tokens across 27 files.
[Rank 0] Validation DataLoader: 100000000 tokens across 1 files.
[Rank 1] Using device: cuda:1
[Rank 0] Model wrapped in DDP.
k params lengths: head = 0, attn = 12
Tokenizer vocab size: 50304
attn.k is learned

=== Report ===
Model Size:    162.20M

Data Path:            data/fineweb10B
Sequence Length:      1024
Batch Size (global):  64
Batch Size (device):  16
n_layers:              12
n_heads:               6
head_dim:             128
n_embd:               768
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/5384_fw_eh_k1.0_lr1e+01_s0/
Writing logs to: runs/02.16/5384_fw_eh_k1.0_lr1e+01_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:10.9830 train_time:0.21s step_avg:nanms
step:10/1000, tokens seen:0.59M, avg_train_loss:10.0153 time:125/nans step_avg:nanms
step:10/1000, tokens seen: 0.66M, val_loss:10.5120 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:1.25M, avg_train_loss:nan time:182/1147s step_avg:1147ms
step:20/1000, tokens seen: 1.31M, val_loss:nan train_time:11.47s step_avg:1147ms
step:30/1000, tokens seen:1.90M, avg_train_loss:nan time:239/1146s step_avg:1146ms
step:30/1000, tokens seen: 1.97M, val_loss:nan train_time:22.92s step_avg:1146ms
step:40/1000, tokens seen:2.56M, avg_train_loss:nan time:296/1145s step_avg:1145ms
step:40/1000, tokens seen: 2.62M, val_loss:nan train_time:34.36s step_avg:1145ms
step:50/1000, tokens seen:3.21M, avg_train_loss:nan time:353/1145s step_avg:1145ms
step:50/1000, tokens seen: 3.28M, val_loss:nan train_time:45.79s step_avg:1145ms
step:60/1000, tokens seen:3.87M, avg_train_loss:nan time:410/1145s step_avg:1145ms
step:60/1000, tokens seen: 3.93M, val_loss:nan train_time:57.23s step_avg:1145ms
step:70/1000, tokens seen:4.52M, avg_train_loss:nan time:467/1145s step_avg:1145ms
step:70/1000, tokens seen: 4.59M, val_loss:nan train_time:68.67s step_avg:1145ms
step:80/1000, tokens seen:5.18M, avg_train_loss:nan time:523/1144s step_avg:1144ms
step:80/1000, tokens seen: 5.24M, val_loss:nan train_time:80.11s step_avg:1144ms
step:90/1000, tokens seen:5.83M, avg_train_loss:nan time:580/1144s step_avg:1144ms
step:90/1000, tokens seen: 5.90M, val_loss:nan train_time:91.54s step_avg:1144ms
step:100/1000, tokens seen:6.49M, avg_train_loss:nan time:637/1144s step_avg:1144ms
step:100/1000, tokens seen: 6.55M, val_loss:nan train_time:102.98s step_avg:1144ms
step:110/1000, tokens seen:7.14M, avg_train_loss:nan time:694/1144s step_avg:1144ms
step:110/1000, tokens seen: 7.21M, val_loss:nan train_time:114.42s step_avg:1144ms
step:120/1000, tokens seen:7.80M, avg_train_loss:nan time:751/1144s step_avg:1144ms
step:120/1000, tokens seen: 7.86M, val_loss:nan train_time:125.86s step_avg:1144ms
step:130/1000, tokens seen:8.45M, avg_train_loss:nan time:808/1144s step_avg:1144ms
step:130/1000, tokens seen: 8.52M, val_loss:nan train_time:137.30s step_avg:1144ms
step:140/1000, tokens seen:9.11M, avg_train_loss:nan time:864/1144s step_avg:1144ms
step:140/1000, tokens seen: 9.18M, val_loss:nan train_time:148.73s step_avg:1144ms
step:150/1000, tokens seen:9.76M, avg_train_loss:nan time:921/1144s step_avg:1144ms
step:150/1000, tokens seen: 9.83M, val_loss:nan train_time:160.17s step_avg:1144ms
step:160/1000, tokens seen:10.42M, avg_train_loss:nan time:978/1144s step_avg:1144ms
step:160/1000, tokens seen: 10.49M, val_loss:nan train_time:171.61s step_avg:1144ms
step:170/1000, tokens seen:11.08M, avg_train_loss:nan time:1035/1144s step_avg:1144ms
step:170/1000, tokens seen: 11.14M, val_loss:nan train_time:183.05s step_avg:1144ms
step:180/1000, tokens seen:11.73M, avg_train_loss:nan time:1092/1144s step_avg:1144ms
step:180/1000, tokens seen: 11.80M, val_loss:nan train_time:194.49s step_avg:1144ms
step:190/1000, tokens seen:12.39M, avg_train_loss:nan time:1149/1144s step_avg:1144ms
step:190/1000, tokens seen: 12.45M, val_loss:nan train_time:205.93s step_avg:1144ms
step:200/1000, tokens seen:13.04M, avg_train_loss:nan time:1206/1144s step_avg:1144ms
step:200/1000, tokens seen: 13.11M, val_loss:nan train_time:217.36s step_avg:1144ms
step:210/1000, tokens seen:13.70M, avg_train_loss:nan time:1263/1144s step_avg:1144ms
step:210/1000, tokens seen: 13.76M, val_loss:nan train_time:228.79s step_avg:1144ms
step:220/1000, tokens seen:14.35M, avg_train_loss:nan time:1319/1144s step_avg:1144ms
step:220/1000, tokens seen: 14.42M, val_loss:nan train_time:240.23s step_avg:1144ms
step:230/1000, tokens seen:15.01M, avg_train_loss:nan time:1376/1144s step_avg:1144ms
step:230/1000, tokens seen: 15.07M, val_loss:nan train_time:251.67s step_avg:1144ms
step:240/1000, tokens seen:15.66M, avg_train_loss:nan time:1433/1144s step_avg:1144ms
step:240/1000, tokens seen: 15.73M, val_loss:nan train_time:263.10s step_avg:1144ms
step:250/1000, tokens seen:16.32M, avg_train_loss:nan time:1490/1144s step_avg:1144ms
step:250/1000, tokens seen: 16.38M, val_loss:nan train_time:274.54s step_avg:1144ms
step:260/1000, tokens seen:16.97M, avg_train_loss:nan time:1547/1144s step_avg:1144ms
step:260/1000, tokens seen: 17.04M, val_loss:nan train_time:285.98s step_avg:1144ms
step:270/1000, tokens seen:17.63M, avg_train_loss:nan time:1604/1144s step_avg:1144ms
step:270/1000, tokens seen: 17.69M, val_loss:nan train_time:297.42s step_avg:1144ms
step:280/1000, tokens seen:18.28M, avg_train_loss:nan time:1661/1144s step_avg:1144ms
step:280/1000, tokens seen: 18.35M, val_loss:nan train_time:308.86s step_avg:1144ms
step:290/1000, tokens seen:18.94M, avg_train_loss:nan time:1717/1144s step_avg:1144ms
step:290/1000, tokens seen: 19.01M, val_loss:nan train_time:320.30s step_avg:1144ms
step:300/1000, tokens seen:19.60M, avg_train_loss:nan time:1774/1144s step_avg:1144ms
step:300/1000, tokens seen: 19.66M, val_loss:nan train_time:331.73s step_avg:1144ms
step:310/1000, tokens seen:20.25M, avg_train_loss:nan time:1831/1144s step_avg:1144ms
step:310/1000, tokens seen: 20.32M, val_loss:nan train_time:343.17s step_avg:1144ms
step:320/1000, tokens seen:20.91M, avg_train_loss:nan time:1888/1144s step_avg:1144ms
step:320/1000, tokens seen: 20.97M, val_loss:nan train_time:354.61s step_avg:1144ms
step:330/1000, tokens seen:21.56M, avg_train_loss:nan time:1945/1144s step_avg:1144ms
step:330/1000, tokens seen: 21.63M, val_loss:nan train_time:366.04s step_avg:1144ms
step:340/1000, tokens seen:22.22M, avg_train_loss:nan time:2002/1144s step_avg:1144ms
step:340/1000, tokens seen: 22.28M, val_loss:nan train_time:377.48s step_avg:1144ms
step:350/1000, tokens seen:22.87M, avg_train_loss:nan time:2058/1144s step_avg:1144ms
step:350/1000, tokens seen: 22.94M, val_loss:nan train_time:388.91s step_avg:1144ms
step:360/1000, tokens seen:23.53M, avg_train_loss:nan time:2115/1144s step_avg:1144ms
step:360/1000, tokens seen: 23.59M, val_loss:nan train_time:400.35s step_avg:1144ms
step:370/1000, tokens seen:24.18M, avg_train_loss:nan time:2172/1144s step_avg:1144ms
step:370/1000, tokens seen: 24.25M, val_loss:nan train_time:411.79s step_avg:1144ms
step:380/1000, tokens seen:24.84M, avg_train_loss:nan time:2229/1144s step_avg:1144ms
step:380/1000, tokens seen: 24.90M, val_loss:nan train_time:423.23s step_avg:1144ms
step:390/1000, tokens seen:25.49M, avg_train_loss:nan time:2286/1144s step_avg:1144ms
step:390/1000, tokens seen: 25.56M, val_loss:nan train_time:434.67s step_avg:1144ms
step:400/1000, tokens seen:26.15M, avg_train_loss:nan time:2343/1144s step_avg:1144ms
step:400/1000, tokens seen: 26.21M, val_loss:nan train_time:446.10s step_avg:1144ms
step:410/1000, tokens seen:26.80M, avg_train_loss:nan time:2400/1144s step_avg:1144ms
step:410/1000, tokens seen: 26.87M, val_loss:nan train_time:457.54s step_avg:1144ms
step:420/1000, tokens seen:27.46M, avg_train_loss:nan time:2457/1144s step_avg:1144ms
step:420/1000, tokens seen: 27.53M, val_loss:nan train_time:468.98s step_avg:1144ms
step:430/1000, tokens seen:28.11M, avg_train_loss:nan time:2513/1144s step_avg:1144ms
step:430/1000, tokens seen: 28.18M, val_loss:nan train_time:480.42s step_avg:1144ms
step:440/1000, tokens seen:28.77M, avg_train_loss:nan time:2570/1144s step_avg:1144ms
step:440/1000, tokens seen: 28.84M, val_loss:nan train_time:491.85s step_avg:1144ms
step:450/1000, tokens seen:29.43M, avg_train_loss:nan time:2627/1144s step_avg:1144ms
step:450/1000, tokens seen: 29.49M, val_loss:nan train_time:503.29s step_avg:1144ms
step:460/1000, tokens seen:30.08M, avg_train_loss:nan time:2684/1144s step_avg:1144ms
step:460/1000, tokens seen: 30.15M, val_loss:nan train_time:514.73s step_avg:1144ms
step:470/1000, tokens seen:30.74M, avg_train_loss:nan time:2741/1144s step_avg:1144ms
step:470/1000, tokens seen: 30.80M, val_loss:nan train_time:526.17s step_avg:1144ms
step:480/1000, tokens seen:31.39M, avg_train_loss:nan time:2798/1144s step_avg:1144ms
step:480/1000, tokens seen: 31.46M, val_loss:nan train_time:537.61s step_avg:1144ms
step:490/1000, tokens seen:32.05M, avg_train_loss:nan time:2855/1144s step_avg:1144ms
step:490/1000, tokens seen: 32.11M, val_loss:nan train_time:549.05s step_avg:1144ms
step:500/1000, tokens seen:32.70M, avg_train_loss:nan time:2911/1144s step_avg:1144ms
step:500/1000, tokens seen: 32.77M, val_loss:nan train_time:560.49s step_avg:1144ms
step:510/1000, tokens seen:33.36M, avg_train_loss:nan time:2968/1144s step_avg:1144ms
step:510/1000, tokens seen: 33.42M, val_loss:nan train_time:571.92s step_avg:1144ms
step:520/1000, tokens seen:34.01M, avg_train_loss:nan time:3025/1144s step_avg:1144ms
step:520/1000, tokens seen: 34.08M, val_loss:nan train_time:583.36s step_avg:1144ms
step:530/1000, tokens seen:34.67M, avg_train_loss:nan time:3082/1144s step_avg:1144ms
step:530/1000, tokens seen: 34.73M, val_loss:nan train_time:594.80s step_avg:1144ms
step:540/1000, tokens seen:35.32M, avg_train_loss:nan time:3139/1144s step_avg:1144ms
step:540/1000, tokens seen: 35.39M, val_loss:nan train_time:606.24s step_avg:1144ms
step:550/1000, tokens seen:35.98M, avg_train_loss:nan time:3196/1144s step_avg:1144ms
step:550/1000, tokens seen: 36.04M, val_loss:nan train_time:617.69s step_avg:1144ms
step:560/1000, tokens seen:36.63M, avg_train_loss:nan time:3253/1144s step_avg:1144ms
step:560/1000, tokens seen: 36.70M, val_loss:nan train_time:629.13s step_avg:1144ms
step:570/1000, tokens seen:37.29M, avg_train_loss:nan time:3309/1144s step_avg:1144ms
step:570/1000, tokens seen: 37.36M, val_loss:nan train_time:640.57s step_avg:1144ms
step:580/1000, tokens seen:37.95M, avg_train_loss:nan time:3366/1144s step_avg:1144ms
step:580/1000, tokens seen: 38.01M, val_loss:nan train_time:652.02s step_avg:1144ms
step:590/1000, tokens seen:38.60M, avg_train_loss:nan time:3423/1144s step_avg:1144ms
step:590/1000, tokens seen: 38.67M, val_loss:nan train_time:663.46s step_avg:1144ms
step:600/1000, tokens seen:39.26M, avg_train_loss:nan time:3480/1144s step_avg:1144ms
step:600/1000, tokens seen: 39.32M, val_loss:nan train_time:674.90s step_avg:1144ms
step:610/1000, tokens seen:39.91M, avg_train_loss:nan time:3537/1144s step_avg:1144ms
step:610/1000, tokens seen: 39.98M, val_loss:nan train_time:686.34s step_avg:1144ms
step:620/1000, tokens seen:40.57M, avg_train_loss:nan time:3594/1144s step_avg:1144ms
step:620/1000, tokens seen: 40.63M, val_loss:nan train_time:697.79s step_avg:1144ms
step:630/1000, tokens seen:41.22M, avg_train_loss:nan time:3651/1144s step_avg:1144ms
step:630/1000, tokens seen: 41.29M, val_loss:nan train_time:709.23s step_avg:1144ms
step:640/1000, tokens seen:41.88M, avg_train_loss:nan time:3707/1144s step_avg:1144ms
step:640/1000, tokens seen: 41.94M, val_loss:nan train_time:720.67s step_avg:1144ms
step:650/1000, tokens seen:42.53M, avg_train_loss:nan time:3764/1144s step_avg:1144ms
step:650/1000, tokens seen: 42.60M, val_loss:nan train_time:732.11s step_avg:1144ms
step:660/1000, tokens seen:43.19M, avg_train_loss:nan time:3821/1144s step_avg:1144ms
step:660/1000, tokens seen: 43.25M, val_loss:nan train_time:743.55s step_avg:1144ms
step:670/1000, tokens seen:43.84M, avg_train_loss:nan time:3878/1144s step_avg:1144ms
step:670/1000, tokens seen: 43.91M, val_loss:nan train_time:754.98s step_avg:1144ms
step:680/1000, tokens seen:44.50M, avg_train_loss:nan time:3935/1144s step_avg:1144ms
step:680/1000, tokens seen: 44.56M, val_loss:nan train_time:766.42s step_avg:1144ms
step:690/1000, tokens seen:45.15M, avg_train_loss:nan time:3992/1144s step_avg:1144ms
step:690/1000, tokens seen: 45.22M, val_loss:nan train_time:777.85s step_avg:1144ms
step:700/1000, tokens seen:45.81M, avg_train_loss:nan time:4049/1144s step_avg:1144ms
step:700/1000, tokens seen: 45.88M, val_loss:nan train_time:789.29s step_avg:1144ms
step:710/1000, tokens seen:46.47M, avg_train_loss:nan time:4106/1144s step_avg:1144ms
step:710/1000, tokens seen: 46.53M, val_loss:nan train_time:800.73s step_avg:1144ms
step:720/1000, tokens seen:47.12M, avg_train_loss:nan time:4162/1144s step_avg:1144ms
step:720/1000, tokens seen: 47.19M, val_loss:nan train_time:812.17s step_avg:1144ms
step:730/1000, tokens seen:47.78M, avg_train_loss:nan time:4219/1144s step_avg:1144ms
step:730/1000, tokens seen: 47.84M, val_loss:nan train_time:823.62s step_avg:1144ms
step:740/1000, tokens seen:48.43M, avg_train_loss:nan time:4276/1144s step_avg:1144ms
step:740/1000, tokens seen: 48.50M, val_loss:nan train_time:835.06s step_avg:1144ms
step:750/1000, tokens seen:49.09M, avg_train_loss:nan time:4333/1144s step_avg:1144ms
step:750/1000, tokens seen: 49.15M, val_loss:nan train_time:846.50s step_avg:1144ms
step:760/1000, tokens seen:49.74M, avg_train_loss:nan time:4390/1144s step_avg:1144ms
step:760/1000, tokens seen: 49.81M, val_loss:nan train_time:857.94s step_avg:1144ms
step:770/1000, tokens seen:50.40M, avg_train_loss:nan time:4447/1144s step_avg:1144ms
step:770/1000, tokens seen: 50.46M, val_loss:nan train_time:869.37s step_avg:1144ms
step:780/1000, tokens seen:51.05M, avg_train_loss:nan time:4503/1144s step_avg:1144ms
step:780/1000, tokens seen: 51.12M, val_loss:nan train_time:880.81s step_avg:1144ms
step:790/1000, tokens seen:51.71M, avg_train_loss:nan time:4560/1144s step_avg:1144ms
step:790/1000, tokens seen: 51.77M, val_loss:nan train_time:892.26s step_avg:1144ms
step:800/1000, tokens seen:52.36M, avg_train_loss:nan time:4617/1144s step_avg:1144ms
step:800/1000, tokens seen: 52.43M, val_loss:nan train_time:903.71s step_avg:1144ms
step:810/1000, tokens seen:53.02M, avg_train_loss:nan time:4674/1144s step_avg:1144ms
step:810/1000, tokens seen: 53.08M, val_loss:nan train_time:915.15s step_avg:1144ms
step:820/1000, tokens seen:53.67M, avg_train_loss:nan time:4731/1144s step_avg:1144ms
step:820/1000, tokens seen: 53.74M, val_loss:nan train_time:926.59s step_avg:1144ms
step:830/1000, tokens seen:54.33M, avg_train_loss:nan time:4788/1144s step_avg:1144ms
step:830/1000, tokens seen: 54.39M, val_loss:nan train_time:938.04s step_avg:1144ms
step:840/1000, tokens seen:54.98M, avg_train_loss:nan time:4845/1144s step_avg:1144ms
step:840/1000, tokens seen: 55.05M, val_loss:nan train_time:949.48s step_avg:1144ms
step:850/1000, tokens seen:55.64M, avg_train_loss:nan time:4902/1144s step_avg:1144ms
step:850/1000, tokens seen: 55.71M, val_loss:nan train_time:960.93s step_avg:1144ms
step:860/1000, tokens seen:56.30M, avg_train_loss:nan time:4959/1144s step_avg:1144ms
step:860/1000, tokens seen: 56.36M, val_loss:nan train_time:972.38s step_avg:1144ms
step:870/1000, tokens seen:56.95M, avg_train_loss:nan time:5015/1144s step_avg:1144ms
step:870/1000, tokens seen: 57.02M, val_loss:nan train_time:983.82s step_avg:1144ms
step:880/1000, tokens seen:57.61M, avg_train_loss:nan time:5072/1144s step_avg:1144ms
step:880/1000, tokens seen: 57.67M, val_loss:nan train_time:995.27s step_avg:1144ms
step:890/1000, tokens seen:58.26M, avg_train_loss:nan time:5129/1144s step_avg:1144ms
step:890/1000, tokens seen: 58.33M, val_loss:nan train_time:1006.71s step_avg:1144ms
step:900/1000, tokens seen:58.92M, avg_train_loss:nan time:5186/1144s step_avg:1144ms
step:900/1000, tokens seen: 58.98M, val_loss:nan train_time:1018.14s step_avg:1144ms
step:910/1000, tokens seen:59.57M, avg_train_loss:nan time:5243/1144s step_avg:1144ms
step:910/1000, tokens seen: 59.64M, val_loss:nan train_time:1029.58s step_avg:1144ms
step:920/1000, tokens seen:60.23M, avg_train_loss:nan time:5300/1144s step_avg:1144ms
step:920/1000, tokens seen: 60.29M, val_loss:nan train_time:1041.02s step_avg:1144ms
step:930/1000, tokens seen:60.88M, avg_train_loss:nan time:5357/1144s step_avg:1144ms
step:930/1000, tokens seen: 60.95M, val_loss:nan train_time:1052.47s step_avg:1144ms
step:940/1000, tokens seen:61.54M, avg_train_loss:nan time:5414/1144s step_avg:1144ms
step:940/1000, tokens seen: 61.60M, val_loss:nan train_time:1063.92s step_avg:1144ms
step:950/1000, tokens seen:62.19M, avg_train_loss:nan time:5470/1144s step_avg:1144ms
step:950/1000, tokens seen: 62.26M, val_loss:nan train_time:1075.36s step_avg:1144ms
step:960/1000, tokens seen:62.85M, avg_train_loss:nan time:5527/1144s step_avg:1144ms
step:960/1000, tokens seen: 62.91M, val_loss:nan train_time:1086.80s step_avg:1144ms
step:970/1000, tokens seen:63.50M, avg_train_loss:nan time:5584/1144s step_avg:1144ms
step:970/1000, tokens seen: 63.57M, val_loss:nan train_time:1098.24s step_avg:1144ms
step:980/1000, tokens seen:64.16M, avg_train_loss:nan time:5641/1144s step_avg:1144ms
step:980/1000, tokens seen: 64.23M, val_loss:nan train_time:1109.68s step_avg:1144ms
step:990/1000, tokens seen:64.82M, avg_train_loss:nan time:5698/1144s step_avg:1144ms
step:990/1000, tokens seen: 64.88M, val_loss:nan train_time:1121.13s step_avg:1144ms
step:1000/1000, tokens seen:65.47M, avg_train_loss:nan time:5755/1144s step_avg:1144ms
step:1000/1000, tokens seen: 65.54M, val_loss:nan train_time:1132.57s step_avg:1144ms
Total training time: 5802.61s
peak memory consumption: 63243 MiB
