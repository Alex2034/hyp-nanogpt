W0216 00:58:18.840695 139726195230528 torch/distributed/run.py:779] 
W0216 00:58:18.840695 139726195230528 torch/distributed/run.py:779] *****************************************
W0216 00:58:18.840695 139726195230528 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 00:58:18.840695 139726195230528 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 0] Training DataLoader: 2700000000 tokens across 27 files.
[Rank 0] Validation DataLoader: 100000000 tokens across 1 files.
[Rank 1] Using device: cuda:1
[Rank 0] Model wrapped in DDP.
k params lengths: head = 0, attn = 0
Tokenizer vocab size: 50304
k is not learned

=== Report ===
Model Size:    162.20M

Data Path:            data/fineweb10B
Sequence Length:      1024
Batch Size (global):  64
Batch Size (device):  16
n_layers:              12
n_heads:               6
head_dim:             128
n_embd:               768
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/3511_fw_ee_s0/
Writing logs to: runs/02.16/3511_fw_ee_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:11.0164 train_time:0.20s step_avg:nanms
step:10/1000, tokens seen:0.59M, avg_train_loss:9.3821 time:64/nans step_avg:nanms
step:10/1000, tokens seen: 0.66M, val_loss:9.3732 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:1.25M, avg_train_loss:8.9464 time:69/100s step_avg:100ms
step:20/1000, tokens seen: 1.31M, val_loss:8.1370 train_time:1.00s step_avg:100ms
step:30/1000, tokens seen:1.90M, avg_train_loss:8.4002 time:75/100s step_avg:100ms
step:30/1000, tokens seen: 1.97M, val_loss:7.7663 train_time:2.00s step_avg:100ms
step:40/1000, tokens seen:2.56M, avg_train_loss:7.7766 time:80/100s step_avg:100ms
step:40/1000, tokens seen: 2.62M, val_loss:7.4165 train_time:3.00s step_avg:100ms
step:50/1000, tokens seen:3.21M, avg_train_loss:7.1842 time:85/100s step_avg:100ms
step:50/1000, tokens seen: 3.28M, val_loss:7.2677 train_time:4.00s step_avg:100ms
step:60/1000, tokens seen:3.87M, avg_train_loss:7.2072 time:91/100s step_avg:100ms
step:60/1000, tokens seen: 3.93M, val_loss:7.0606 train_time:5.00s step_avg:100ms
step:70/1000, tokens seen:4.52M, avg_train_loss:6.9719 time:96/100s step_avg:100ms
step:70/1000, tokens seen: 4.59M, val_loss:6.9633 train_time:6.01s step_avg:100ms
step:80/1000, tokens seen:5.18M, avg_train_loss:6.8490 time:102/100s step_avg:100ms
step:80/1000, tokens seen: 5.24M, val_loss:6.8395 train_time:7.01s step_avg:100ms
step:90/1000, tokens seen:5.83M, avg_train_loss:6.8313 time:107/100s step_avg:100ms
step:90/1000, tokens seen: 5.90M, val_loss:6.7618 train_time:8.01s step_avg:100ms
step:100/1000, tokens seen:6.49M, avg_train_loss:6.6975 time:112/100s step_avg:100ms
step:100/1000, tokens seen: 6.55M, val_loss:6.7317 train_time:9.01s step_avg:100ms
step:110/1000, tokens seen:7.14M, avg_train_loss:6.6960 time:118/100s step_avg:100ms
step:110/1000, tokens seen: 7.21M, val_loss:6.6501 train_time:10.02s step_avg:100ms
step:120/1000, tokens seen:7.80M, avg_train_loss:6.5652 time:123/100s step_avg:100ms
step:120/1000, tokens seen: 7.86M, val_loss:6.5772 train_time:11.02s step_avg:100ms
step:130/1000, tokens seen:8.45M, avg_train_loss:6.5056 time:129/100s step_avg:100ms
step:130/1000, tokens seen: 8.52M, val_loss:6.5090 train_time:12.02s step_avg:100ms
step:140/1000, tokens seen:9.11M, avg_train_loss:6.3713 time:134/100s step_avg:100ms
step:140/1000, tokens seen: 9.18M, val_loss:6.4893 train_time:13.02s step_avg:100ms
step:150/1000, tokens seen:9.76M, avg_train_loss:6.5416 time:140/100s step_avg:100ms
step:150/1000, tokens seen: 9.83M, val_loss:6.4516 train_time:14.03s step_avg:100ms
step:160/1000, tokens seen:10.42M, avg_train_loss:6.3258 time:145/100s step_avg:100ms
step:160/1000, tokens seen: 10.49M, val_loss:6.3877 train_time:15.03s step_avg:100ms
step:170/1000, tokens seen:11.08M, avg_train_loss:6.4252 time:150/100s step_avg:100ms
step:170/1000, tokens seen: 11.14M, val_loss:6.3557 train_time:16.03s step_avg:100ms
step:180/1000, tokens seen:11.73M, avg_train_loss:6.3608 time:156/100s step_avg:100ms
step:180/1000, tokens seen: 11.80M, val_loss:6.3075 train_time:17.04s step_avg:100ms
step:190/1000, tokens seen:12.39M, avg_train_loss:6.3230 time:161/100s step_avg:100ms
step:190/1000, tokens seen: 12.45M, val_loss:6.2610 train_time:18.04s step_avg:100ms
step:200/1000, tokens seen:13.04M, avg_train_loss:6.2096 time:167/100s step_avg:100ms
step:200/1000, tokens seen: 13.11M, val_loss:6.2198 train_time:19.04s step_avg:100ms
step:210/1000, tokens seen:13.70M, avg_train_loss:6.2676 time:172/100s step_avg:100ms
step:210/1000, tokens seen: 13.76M, val_loss:6.2037 train_time:20.04s step_avg:100ms
step:220/1000, tokens seen:14.35M, avg_train_loss:6.1536 time:177/100s step_avg:100ms
step:220/1000, tokens seen: 14.42M, val_loss:6.1559 train_time:21.04s step_avg:100ms
step:230/1000, tokens seen:15.01M, avg_train_loss:6.1379 time:183/100s step_avg:100ms
step:230/1000, tokens seen: 15.07M, val_loss:6.1213 train_time:22.05s step_avg:100ms
step:240/1000, tokens seen:15.66M, avg_train_loss:6.0951 time:188/100s step_avg:100ms
step:240/1000, tokens seen: 15.73M, val_loss:6.0896 train_time:23.05s step_avg:100ms
step:250/1000, tokens seen:16.32M, avg_train_loss:5.9882 time:194/100s step_avg:100ms
step:250/1000, tokens seen: 16.38M, val_loss:6.0635 train_time:24.05s step_avg:100ms
step:260/1000, tokens seen:16.97M, avg_train_loss:6.1102 time:199/100s step_avg:100ms
step:260/1000, tokens seen: 17.04M, val_loss:6.0388 train_time:25.05s step_avg:100ms
step:270/1000, tokens seen:17.63M, avg_train_loss:6.0249 time:205/100s step_avg:100ms
step:270/1000, tokens seen: 17.69M, val_loss:6.0153 train_time:26.05s step_avg:100ms
step:280/1000, tokens seen:18.28M, avg_train_loss:6.1444 time:210/100s step_avg:100ms
step:280/1000, tokens seen: 18.35M, val_loss:5.9903 train_time:27.05s step_avg:100ms
step:290/1000, tokens seen:18.94M, avg_train_loss:6.0184 time:215/100s step_avg:100ms
step:290/1000, tokens seen: 19.01M, val_loss:5.9663 train_time:28.05s step_avg:100ms
step:300/1000, tokens seen:19.60M, avg_train_loss:5.8941 time:221/100s step_avg:100ms
step:300/1000, tokens seen: 19.66M, val_loss:5.9374 train_time:29.05s step_avg:100ms
step:310/1000, tokens seen:20.25M, avg_train_loss:6.0054 time:226/100s step_avg:100ms
step:310/1000, tokens seen: 20.32M, val_loss:5.9138 train_time:30.05s step_avg:100ms
step:320/1000, tokens seen:20.91M, avg_train_loss:5.9092 time:232/100s step_avg:100ms
step:320/1000, tokens seen: 20.97M, val_loss:5.8967 train_time:31.05s step_avg:100ms
step:330/1000, tokens seen:21.56M, avg_train_loss:5.9327 time:237/100s step_avg:100ms
step:330/1000, tokens seen: 21.63M, val_loss:5.8705 train_time:32.05s step_avg:100ms
step:340/1000, tokens seen:22.22M, avg_train_loss:5.8388 time:242/100s step_avg:100ms
step:340/1000, tokens seen: 22.28M, val_loss:5.8495 train_time:33.05s step_avg:100ms
step:350/1000, tokens seen:22.87M, avg_train_loss:5.7841 time:248/100s step_avg:100ms
step:350/1000, tokens seen: 22.94M, val_loss:5.8343 train_time:34.05s step_avg:100ms
step:360/1000, tokens seen:23.53M, avg_train_loss:5.7749 time:253/100s step_avg:100ms
step:360/1000, tokens seen: 23.59M, val_loss:5.8314 train_time:35.05s step_avg:100ms
step:370/1000, tokens seen:24.18M, avg_train_loss:5.8871 time:259/100s step_avg:100ms
step:370/1000, tokens seen: 24.25M, val_loss:5.8108 train_time:36.06s step_avg:100ms
step:380/1000, tokens seen:24.84M, avg_train_loss:5.8008 time:264/100s step_avg:100ms
step:380/1000, tokens seen: 24.90M, val_loss:5.7927 train_time:37.06s step_avg:100ms
step:390/1000, tokens seen:25.49M, avg_train_loss:5.5721 time:270/100s step_avg:100ms
step:390/1000, tokens seen: 25.56M, val_loss:5.7837 train_time:38.06s step_avg:100ms
step:400/1000, tokens seen:26.15M, avg_train_loss:5.6951 time:275/100s step_avg:100ms
step:400/1000, tokens seen: 26.21M, val_loss:5.7608 train_time:39.06s step_avg:100ms
step:410/1000, tokens seen:26.80M, avg_train_loss:5.6825 time:280/100s step_avg:100ms
step:410/1000, tokens seen: 26.87M, val_loss:5.7528 train_time:40.06s step_avg:100ms
step:420/1000, tokens seen:27.46M, avg_train_loss:5.7862 time:286/100s step_avg:100ms
step:420/1000, tokens seen: 27.53M, val_loss:5.7488 train_time:41.06s step_avg:100ms
step:430/1000, tokens seen:28.11M, avg_train_loss:5.7706 time:291/100s step_avg:100ms
step:430/1000, tokens seen: 28.18M, val_loss:5.7250 train_time:42.06s step_avg:100ms
step:440/1000, tokens seen:28.77M, avg_train_loss:5.7242 time:297/100s step_avg:100ms
step:440/1000, tokens seen: 28.84M, val_loss:5.7025 train_time:43.06s step_avg:100ms
step:450/1000, tokens seen:29.43M, avg_train_loss:5.6558 time:302/100s step_avg:100ms
step:450/1000, tokens seen: 29.49M, val_loss:5.6969 train_time:44.06s step_avg:100ms
step:460/1000, tokens seen:30.08M, avg_train_loss:5.7228 time:308/100s step_avg:100ms
step:460/1000, tokens seen: 30.15M, val_loss:5.6719 train_time:45.06s step_avg:100ms
step:470/1000, tokens seen:30.74M, avg_train_loss:5.5471 time:313/100s step_avg:100ms
step:470/1000, tokens seen: 30.80M, val_loss:5.6611 train_time:46.06s step_avg:100ms
step:480/1000, tokens seen:31.39M, avg_train_loss:5.6338 time:318/100s step_avg:100ms
step:480/1000, tokens seen: 31.46M, val_loss:5.6520 train_time:47.06s step_avg:100ms
step:490/1000, tokens seen:32.05M, avg_train_loss:5.6306 time:324/100s step_avg:100ms
step:490/1000, tokens seen: 32.11M, val_loss:5.6303 train_time:48.06s step_avg:100ms
step:500/1000, tokens seen:32.70M, avg_train_loss:5.6180 time:329/100s step_avg:100ms
step:500/1000, tokens seen: 32.77M, val_loss:5.6191 train_time:49.06s step_avg:100ms
step:510/1000, tokens seen:33.36M, avg_train_loss:5.7648 time:335/100s step_avg:100ms
step:510/1000, tokens seen: 33.42M, val_loss:5.6322 train_time:50.05s step_avg:100ms
step:520/1000, tokens seen:34.01M, avg_train_loss:5.6496 time:340/100s step_avg:100ms
step:520/1000, tokens seen: 34.08M, val_loss:5.6057 train_time:51.05s step_avg:100ms
step:530/1000, tokens seen:34.67M, avg_train_loss:5.5824 time:345/100s step_avg:100ms
step:530/1000, tokens seen: 34.73M, val_loss:5.5979 train_time:52.05s step_avg:100ms
step:540/1000, tokens seen:35.32M, avg_train_loss:5.6529 time:351/100s step_avg:100ms
step:540/1000, tokens seen: 35.39M, val_loss:5.6756 train_time:53.05s step_avg:100ms
step:550/1000, tokens seen:35.98M, avg_train_loss:5.7449 time:356/100s step_avg:100ms
step:550/1000, tokens seen: 36.04M, val_loss:5.5813 train_time:54.05s step_avg:100ms
step:560/1000, tokens seen:36.63M, avg_train_loss:5.6091 time:362/100s step_avg:100ms
step:560/1000, tokens seen: 36.70M, val_loss:5.5659 train_time:55.05s step_avg:100ms
step:570/1000, tokens seen:37.29M, avg_train_loss:5.5154 time:367/100s step_avg:100ms
step:570/1000, tokens seen: 37.36M, val_loss:5.5543 train_time:56.05s step_avg:100ms
step:580/1000, tokens seen:37.95M, avg_train_loss:5.5751 time:373/100s step_avg:100ms
step:580/1000, tokens seen: 38.01M, val_loss:5.5535 train_time:57.05s step_avg:100ms
step:590/1000, tokens seen:38.60M, avg_train_loss:5.4499 time:378/100s step_avg:100ms
step:590/1000, tokens seen: 38.67M, val_loss:5.5370 train_time:58.05s step_avg:100ms
step:600/1000, tokens seen:39.26M, avg_train_loss:5.5506 time:383/100s step_avg:100ms
step:600/1000, tokens seen: 39.32M, val_loss:5.5233 train_time:59.05s step_avg:100ms
step:610/1000, tokens seen:39.91M, avg_train_loss:5.6661 time:389/100s step_avg:100ms
step:610/1000, tokens seen: 39.98M, val_loss:5.5291 train_time:60.05s step_avg:100ms
step:620/1000, tokens seen:40.57M, avg_train_loss:5.5610 time:394/100s step_avg:100ms
step:620/1000, tokens seen: 40.63M, val_loss:5.5136 train_time:61.05s step_avg:100ms
step:630/1000, tokens seen:41.22M, avg_train_loss:5.4006 time:400/100s step_avg:100ms
step:630/1000, tokens seen: 41.29M, val_loss:5.5212 train_time:62.05s step_avg:100ms
step:640/1000, tokens seen:41.88M, avg_train_loss:5.4522 time:405/100s step_avg:100ms
step:640/1000, tokens seen: 41.94M, val_loss:5.4943 train_time:63.06s step_avg:100ms
step:650/1000, tokens seen:42.53M, avg_train_loss:5.3783 time:410/100s step_avg:100ms
step:650/1000, tokens seen: 42.60M, val_loss:5.4780 train_time:64.05s step_avg:100ms
step:660/1000, tokens seen:43.19M, avg_train_loss:5.5132 time:416/100s step_avg:100ms
step:660/1000, tokens seen: 43.25M, val_loss:5.4672 train_time:65.05s step_avg:100ms
step:670/1000, tokens seen:43.84M, avg_train_loss:5.5624 time:421/100s step_avg:100ms
step:670/1000, tokens seen: 43.91M, val_loss:5.4511 train_time:66.05s step_avg:100ms
step:680/1000, tokens seen:44.50M, avg_train_loss:5.4830 time:427/100s step_avg:100ms
step:680/1000, tokens seen: 44.56M, val_loss:5.4360 train_time:67.05s step_avg:100ms
step:690/1000, tokens seen:45.15M, avg_train_loss:5.4867 time:432/100s step_avg:100ms
step:690/1000, tokens seen: 45.22M, val_loss:5.4244 train_time:68.05s step_avg:100ms
step:700/1000, tokens seen:45.81M, avg_train_loss:5.3929 time:438/100s step_avg:100ms
step:700/1000, tokens seen: 45.88M, val_loss:5.4119 train_time:69.05s step_avg:100ms
step:710/1000, tokens seen:46.47M, avg_train_loss:5.4549 time:443/100s step_avg:100ms
step:710/1000, tokens seen: 46.53M, val_loss:5.4031 train_time:70.05s step_avg:100ms
step:720/1000, tokens seen:47.12M, avg_train_loss:5.3640 time:448/100s step_avg:100ms
step:720/1000, tokens seen: 47.19M, val_loss:5.3978 train_time:71.05s step_avg:100ms
step:730/1000, tokens seen:47.78M, avg_train_loss:5.3943 time:454/100s step_avg:100ms
step:730/1000, tokens seen: 47.84M, val_loss:5.3838 train_time:72.05s step_avg:100ms
step:740/1000, tokens seen:48.43M, avg_train_loss:5.4416 time:459/100s step_avg:100ms
step:740/1000, tokens seen: 48.50M, val_loss:5.3762 train_time:73.05s step_avg:100ms
step:750/1000, tokens seen:49.09M, avg_train_loss:5.3484 time:465/100s step_avg:100ms
step:750/1000, tokens seen: 49.15M, val_loss:5.3681 train_time:74.05s step_avg:100ms
step:760/1000, tokens seen:49.74M, avg_train_loss:5.3453 time:470/100s step_avg:100ms
step:760/1000, tokens seen: 49.81M, val_loss:5.3556 train_time:75.05s step_avg:100ms
step:770/1000, tokens seen:50.40M, avg_train_loss:5.3054 time:476/100s step_avg:100ms
step:770/1000, tokens seen: 50.46M, val_loss:5.3444 train_time:76.05s step_avg:100ms
step:780/1000, tokens seen:51.05M, avg_train_loss:5.3736 time:481/100s step_avg:100ms
step:780/1000, tokens seen: 51.12M, val_loss:5.3340 train_time:77.05s step_avg:100ms
step:790/1000, tokens seen:51.71M, avg_train_loss:5.3074 time:486/100s step_avg:100ms
step:790/1000, tokens seen: 51.77M, val_loss:5.3248 train_time:78.05s step_avg:100ms
step:800/1000, tokens seen:52.36M, avg_train_loss:5.1966 time:492/100s step_avg:100ms
step:800/1000, tokens seen: 52.43M, val_loss:5.3170 train_time:79.05s step_avg:100ms
step:810/1000, tokens seen:53.02M, avg_train_loss:5.2082 time:497/100s step_avg:100ms
step:810/1000, tokens seen: 53.08M, val_loss:5.3125 train_time:80.05s step_avg:100ms
step:820/1000, tokens seen:53.67M, avg_train_loss:5.2528 time:503/100s step_avg:100ms
step:820/1000, tokens seen: 53.74M, val_loss:5.3027 train_time:81.05s step_avg:100ms
step:830/1000, tokens seen:54.33M, avg_train_loss:5.2248 time:508/100s step_avg:100ms
step:830/1000, tokens seen: 54.39M, val_loss:5.2971 train_time:82.04s step_avg:100ms
step:840/1000, tokens seen:54.98M, avg_train_loss:5.3495 time:513/100s step_avg:100ms
step:840/1000, tokens seen: 55.05M, val_loss:5.2869 train_time:83.04s step_avg:100ms
step:850/1000, tokens seen:55.64M, avg_train_loss:5.3516 time:519/100s step_avg:100ms
step:850/1000, tokens seen: 55.71M, val_loss:5.2785 train_time:84.04s step_avg:100ms
step:860/1000, tokens seen:56.30M, avg_train_loss:5.3136 time:524/100s step_avg:100ms
step:860/1000, tokens seen: 56.36M, val_loss:5.2714 train_time:85.04s step_avg:100ms
step:870/1000, tokens seen:56.95M, avg_train_loss:5.3823 time:530/100s step_avg:100ms
step:870/1000, tokens seen: 57.02M, val_loss:5.2632 train_time:86.04s step_avg:100ms
step:880/1000, tokens seen:57.61M, avg_train_loss:5.2513 time:535/100s step_avg:100ms
step:880/1000, tokens seen: 57.67M, val_loss:5.2558 train_time:87.04s step_avg:100ms
step:890/1000, tokens seen:58.26M, avg_train_loss:5.2734 time:541/100s step_avg:100ms
step:890/1000, tokens seen: 58.33M, val_loss:5.2479 train_time:88.04s step_avg:100ms
step:900/1000, tokens seen:58.92M, avg_train_loss:5.2940 time:546/100s step_avg:100ms
step:900/1000, tokens seen: 58.98M, val_loss:5.2405 train_time:89.04s step_avg:100ms
step:910/1000, tokens seen:59.57M, avg_train_loss:5.1830 time:551/100s step_avg:100ms
step:910/1000, tokens seen: 59.64M, val_loss:5.2346 train_time:90.05s step_avg:100ms
step:920/1000, tokens seen:60.23M, avg_train_loss:5.3151 time:557/100s step_avg:100ms
step:920/1000, tokens seen: 60.29M, val_loss:5.2279 train_time:91.05s step_avg:100ms
step:930/1000, tokens seen:60.88M, avg_train_loss:5.2044 time:562/100s step_avg:100ms
step:930/1000, tokens seen: 60.95M, val_loss:5.2223 train_time:92.05s step_avg:100ms
step:940/1000, tokens seen:61.54M, avg_train_loss:5.1993 time:568/100s step_avg:100ms
step:940/1000, tokens seen: 61.60M, val_loss:5.2166 train_time:93.05s step_avg:100ms
step:950/1000, tokens seen:62.19M, avg_train_loss:5.1658 time:573/100s step_avg:100ms
step:950/1000, tokens seen: 62.26M, val_loss:5.2110 train_time:94.05s step_avg:100ms
step:960/1000, tokens seen:62.85M, avg_train_loss:5.1498 time:579/100s step_avg:100ms
step:960/1000, tokens seen: 62.91M, val_loss:5.2063 train_time:95.06s step_avg:100ms
step:970/1000, tokens seen:63.50M, avg_train_loss:5.2462 time:584/100s step_avg:100ms
step:970/1000, tokens seen: 63.57M, val_loss:5.2013 train_time:96.06s step_avg:100ms
step:980/1000, tokens seen:64.16M, avg_train_loss:5.0992 time:589/100s step_avg:100ms
step:980/1000, tokens seen: 64.23M, val_loss:5.1971 train_time:97.06s step_avg:100ms
step:990/1000, tokens seen:64.82M, avg_train_loss:5.2623 time:595/100s step_avg:100ms
step:990/1000, tokens seen: 64.88M, val_loss:5.1934 train_time:98.06s step_avg:100ms
step:1000/1000, tokens seen:65.47M, avg_train_loss:5.1735 time:600/100s step_avg:100ms
step:1000/1000, tokens seen: 65.54M, val_loss:5.1897 train_time:99.06s step_avg:100ms
Total training time: 607.10s
peak memory consumption: 14977 MiB
