W0216 04:11:57.178831 140477059192640 torch/distributed/run.py:779] 
W0216 04:11:57.178831 140477059192640 torch/distributed/run.py:779] *****************************************
W0216 04:11:57.178831 140477059192640 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 04:11:57.178831 140477059192640 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 0] Training DataLoader: 187975984 tokens across 1 files.
[Rank 0] Validation DataLoader: 1909027 tokens across 1 files.
[Rank 1] Using device: cuda:1
[Rank 0] Model wrapped in DDP.
k params lengths: head = 0, attn = 6
Tokenizer vocab size: 122
attn.k is learned

=== Report ===
Model Size:    310.55K

Data Path:            data/tinystories_char
Sequence Length:      1024
Batch Size (global):  128
Batch Size (device):  64
n_layers:              6
n_heads:               4
head_dim:             16
n_embd:               64
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/15131_tsc_eh_k1.0_lr1e+01_s0/
Writing logs to: runs/02.16/15131_tsc_eh_k1.0_lr1e+01_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:4.9367 train_time:0.19s step_avg:nanms
step:10/1000, tokens seen:1.18M, avg_train_loss:3.1847 time:37/nans step_avg:nanms
step:10/1000, tokens seen: 1.31M, val_loss:2.5141 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:2.49M, avg_train_loss:2.4438 time:48/224s step_avg:224ms
step:20/1000, tokens seen: 2.62M, val_loss:2.3866 train_time:2.24s step_avg:224ms
step:30/1000, tokens seen:3.80M, avg_train_loss:2.3701 time:58/224s step_avg:224ms
step:30/1000, tokens seen: 3.93M, val_loss:2.3551 train_time:4.51s step_avg:226ms
step:40/1000, tokens seen:5.11M, avg_train_loss:2.3473 time:69/225s step_avg:225ms
step:40/1000, tokens seen: 5.24M, val_loss:2.3375 train_time:6.75s step_avg:225ms
step:50/1000, tokens seen:6.42M, avg_train_loss:2.3353 time:80/225s step_avg:225ms
step:50/1000, tokens seen: 6.55M, val_loss:2.3274 train_time:8.99s step_avg:225ms
step:60/1000, tokens seen:7.73M, avg_train_loss:2.3244 time:90/224s step_avg:224ms
step:60/1000, tokens seen: 7.86M, val_loss:2.3254 train_time:11.22s step_avg:224ms
step:70/1000, tokens seen:9.04M, avg_train_loss:2.3230 time:101/224s step_avg:224ms
step:70/1000, tokens seen: 9.18M, val_loss:2.3162 train_time:13.46s step_avg:224ms
step:80/1000, tokens seen:10.35M, avg_train_loss:2.3129 time:112/224s step_avg:224ms
step:80/1000, tokens seen: 10.49M, val_loss:2.3126 train_time:15.69s step_avg:224ms
step:90/1000, tokens seen:11.67M, avg_train_loss:2.3186 time:122/224s step_avg:224ms
step:90/1000, tokens seen: 11.80M, val_loss:2.3107 train_time:17.92s step_avg:224ms
step:100/1000, tokens seen:12.98M, avg_train_loss:2.3053 time:133/224s step_avg:224ms
step:100/1000, tokens seen: 13.11M, val_loss:2.3034 train_time:20.16s step_avg:224ms
step:110/1000, tokens seen:14.29M, avg_train_loss:2.3075 time:144/224s step_avg:224ms
step:110/1000, tokens seen: 14.42M, val_loss:2.2996 train_time:22.39s step_avg:224ms
step:120/1000, tokens seen:15.60M, avg_train_loss:2.2998 time:154/224s step_avg:224ms
step:120/1000, tokens seen: 15.73M, val_loss:2.2938 train_time:24.62s step_avg:224ms
step:130/1000, tokens seen:16.91M, avg_train_loss:2.2968 time:165/224s step_avg:224ms
step:130/1000, tokens seen: 17.04M, val_loss:2.2897 train_time:26.86s step_avg:224ms
step:140/1000, tokens seen:18.22M, avg_train_loss:2.2882 time:175/224s step_avg:224ms
step:140/1000, tokens seen: 18.35M, val_loss:2.2843 train_time:29.09s step_avg:224ms
step:150/1000, tokens seen:19.53M, avg_train_loss:2.2825 time:186/224s step_avg:224ms
step:150/1000, tokens seen: 19.66M, val_loss:2.2829 train_time:31.33s step_avg:224ms
step:160/1000, tokens seen:20.84M, avg_train_loss:2.2765 time:197/224s step_avg:224ms
step:160/1000, tokens seen: 20.97M, val_loss:2.2786 train_time:33.56s step_avg:224ms
step:170/1000, tokens seen:22.15M, avg_train_loss:2.2705 time:207/224s step_avg:224ms
step:170/1000, tokens seen: 22.28M, val_loss:2.2698 train_time:35.79s step_avg:224ms
step:180/1000, tokens seen:23.46M, avg_train_loss:2.2626 time:218/224s step_avg:224ms
step:180/1000, tokens seen: 23.59M, val_loss:2.2574 train_time:38.02s step_avg:224ms
step:190/1000, tokens seen:24.77M, avg_train_loss:2.2600 time:229/224s step_avg:224ms
step:190/1000, tokens seen: 24.90M, val_loss:2.2460 train_time:40.26s step_avg:224ms
step:200/1000, tokens seen:26.08M, avg_train_loss:2.2476 time:239/224s step_avg:224ms
step:200/1000, tokens seen: 26.21M, val_loss:2.2367 train_time:42.49s step_avg:224ms
step:210/1000, tokens seen:27.39M, avg_train_loss:2.2365 time:250/224s step_avg:224ms
step:210/1000, tokens seen: 27.53M, val_loss:2.2327 train_time:44.73s step_avg:224ms
step:220/1000, tokens seen:28.70M, avg_train_loss:2.2201 time:261/224s step_avg:224ms
step:220/1000, tokens seen: 28.84M, val_loss:2.2388 train_time:46.96s step_avg:224ms
step:230/1000, tokens seen:30.02M, avg_train_loss:2.2127 time:271/224s step_avg:224ms
step:230/1000, tokens seen: 30.15M, val_loss:2.2005 train_time:49.19s step_avg:224ms
step:240/1000, tokens seen:31.33M, avg_train_loss:2.2032 time:282/224s step_avg:224ms
step:240/1000, tokens seen: 31.46M, val_loss:2.1896 train_time:51.43s step_avg:224ms
step:250/1000, tokens seen:32.64M, avg_train_loss:2.1868 time:293/224s step_avg:224ms
step:250/1000, tokens seen: 32.77M, val_loss:2.1770 train_time:53.66s step_avg:224ms
step:260/1000, tokens seen:33.95M, avg_train_loss:nan time:303/223s step_avg:223ms
step:260/1000, tokens seen: 34.08M, val_loss:nan train_time:55.87s step_avg:223ms
step:270/1000, tokens seen:35.26M, avg_train_loss:nan time:313/223s step_avg:223ms
step:270/1000, tokens seen: 35.39M, val_loss:nan train_time:58.05s step_avg:223ms
step:280/1000, tokens seen:36.57M, avg_train_loss:nan time:324/223s step_avg:223ms
step:280/1000, tokens seen: 36.70M, val_loss:nan train_time:60.23s step_avg:223ms
step:290/1000, tokens seen:37.88M, avg_train_loss:nan time:334/223s step_avg:223ms
step:290/1000, tokens seen: 38.01M, val_loss:nan train_time:62.41s step_avg:223ms
step:300/1000, tokens seen:39.19M, avg_train_loss:nan time:344/223s step_avg:223ms
step:300/1000, tokens seen: 39.32M, val_loss:nan train_time:64.59s step_avg:223ms
step:310/1000, tokens seen:40.50M, avg_train_loss:nan time:354/223s step_avg:223ms
step:310/1000, tokens seen: 40.63M, val_loss:nan train_time:66.76s step_avg:223ms
step:320/1000, tokens seen:41.81M, avg_train_loss:nan time:365/222s step_avg:222ms
step:320/1000, tokens seen: 41.94M, val_loss:nan train_time:68.95s step_avg:222ms
step:330/1000, tokens seen:43.12M, avg_train_loss:nan time:375/222s step_avg:222ms
step:330/1000, tokens seen: 43.25M, val_loss:nan train_time:71.12s step_avg:222ms
step:340/1000, tokens seen:44.43M, avg_train_loss:nan time:385/222s step_avg:222ms
step:340/1000, tokens seen: 44.56M, val_loss:nan train_time:73.30s step_avg:222ms
step:350/1000, tokens seen:45.74M, avg_train_loss:nan time:396/222s step_avg:222ms
step:350/1000, tokens seen: 45.88M, val_loss:nan train_time:75.48s step_avg:222ms
step:360/1000, tokens seen:47.05M, avg_train_loss:nan time:406/222s step_avg:222ms
step:360/1000, tokens seen: 47.19M, val_loss:nan train_time:77.66s step_avg:222ms
step:370/1000, tokens seen:48.37M, avg_train_loss:nan time:416/222s step_avg:222ms
step:370/1000, tokens seen: 48.50M, val_loss:nan train_time:79.84s step_avg:222ms
step:380/1000, tokens seen:49.68M, avg_train_loss:nan time:426/222s step_avg:222ms
step:380/1000, tokens seen: 49.81M, val_loss:nan train_time:82.02s step_avg:222ms
step:390/1000, tokens seen:50.99M, avg_train_loss:nan time:437/222s step_avg:222ms
step:390/1000, tokens seen: 51.12M, val_loss:nan train_time:84.20s step_avg:222ms
step:400/1000, tokens seen:52.30M, avg_train_loss:nan time:447/221s step_avg:221ms
step:400/1000, tokens seen: 52.43M, val_loss:nan train_time:86.38s step_avg:221ms
step:410/1000, tokens seen:53.61M, avg_train_loss:nan time:457/221s step_avg:221ms
step:410/1000, tokens seen: 53.74M, val_loss:nan train_time:88.56s step_avg:221ms
step:420/1000, tokens seen:54.92M, avg_train_loss:nan time:467/221s step_avg:221ms
step:420/1000, tokens seen: 55.05M, val_loss:nan train_time:90.74s step_avg:221ms
step:430/1000, tokens seen:56.23M, avg_train_loss:nan time:478/221s step_avg:221ms
step:430/1000, tokens seen: 56.36M, val_loss:nan train_time:92.92s step_avg:221ms
step:440/1000, tokens seen:57.54M, avg_train_loss:nan time:488/221s step_avg:221ms
step:440/1000, tokens seen: 57.67M, val_loss:nan train_time:95.10s step_avg:221ms
step:450/1000, tokens seen:58.85M, avg_train_loss:nan time:498/221s step_avg:221ms
step:450/1000, tokens seen: 58.98M, val_loss:nan train_time:97.29s step_avg:221ms
step:460/1000, tokens seen:60.16M, avg_train_loss:nan time:508/221s step_avg:221ms
step:460/1000, tokens seen: 60.29M, val_loss:nan train_time:99.47s step_avg:221ms
step:470/1000, tokens seen:61.47M, avg_train_loss:nan time:519/221s step_avg:221ms
step:470/1000, tokens seen: 61.60M, val_loss:nan train_time:101.65s step_avg:221ms
step:480/1000, tokens seen:62.78M, avg_train_loss:nan time:529/221s step_avg:221ms
step:480/1000, tokens seen: 62.91M, val_loss:nan train_time:103.83s step_avg:221ms
step:490/1000, tokens seen:64.09M, avg_train_loss:nan time:539/221s step_avg:221ms
step:490/1000, tokens seen: 64.23M, val_loss:nan train_time:106.00s step_avg:221ms
step:500/1000, tokens seen:65.40M, avg_train_loss:nan time:550/221s step_avg:221ms
step:500/1000, tokens seen: 65.54M, val_loss:nan train_time:108.18s step_avg:221ms
step:510/1000, tokens seen:66.72M, avg_train_loss:nan time:560/221s step_avg:221ms
step:510/1000, tokens seen: 66.85M, val_loss:nan train_time:110.36s step_avg:221ms
step:520/1000, tokens seen:68.03M, avg_train_loss:nan time:570/221s step_avg:221ms
step:520/1000, tokens seen: 68.16M, val_loss:nan train_time:112.54s step_avg:221ms
step:530/1000, tokens seen:69.34M, avg_train_loss:nan time:580/221s step_avg:221ms
step:530/1000, tokens seen: 69.47M, val_loss:nan train_time:114.72s step_avg:221ms
step:540/1000, tokens seen:70.65M, avg_train_loss:nan time:591/221s step_avg:221ms
step:540/1000, tokens seen: 70.78M, val_loss:nan train_time:116.90s step_avg:221ms
step:550/1000, tokens seen:71.96M, avg_train_loss:nan time:601/221s step_avg:221ms
step:550/1000, tokens seen: 72.09M, val_loss:nan train_time:119.09s step_avg:221ms
step:560/1000, tokens seen:73.27M, avg_train_loss:nan time:611/220s step_avg:220ms
step:560/1000, tokens seen: 73.40M, val_loss:nan train_time:121.27s step_avg:220ms
step:570/1000, tokens seen:74.58M, avg_train_loss:nan time:621/220s step_avg:220ms
step:570/1000, tokens seen: 74.71M, val_loss:nan train_time:123.45s step_avg:220ms
step:580/1000, tokens seen:75.89M, avg_train_loss:nan time:632/220s step_avg:220ms
step:580/1000, tokens seen: 76.02M, val_loss:nan train_time:125.64s step_avg:220ms
step:590/1000, tokens seen:77.20M, avg_train_loss:nan time:642/220s step_avg:220ms
step:590/1000, tokens seen: 77.33M, val_loss:nan train_time:127.83s step_avg:220ms
step:600/1000, tokens seen:78.51M, avg_train_loss:nan time:652/220s step_avg:220ms
step:600/1000, tokens seen: 78.64M, val_loss:nan train_time:130.02s step_avg:220ms
step:610/1000, tokens seen:79.82M, avg_train_loss:nan time:663/220s step_avg:220ms
step:610/1000, tokens seen: 79.95M, val_loss:nan train_time:132.20s step_avg:220ms
step:620/1000, tokens seen:81.13M, avg_train_loss:nan time:673/220s step_avg:220ms
step:620/1000, tokens seen: 81.26M, val_loss:nan train_time:134.40s step_avg:220ms
step:630/1000, tokens seen:82.44M, avg_train_loss:nan time:683/220s step_avg:220ms
step:630/1000, tokens seen: 82.58M, val_loss:nan train_time:136.57s step_avg:220ms
step:640/1000, tokens seen:83.76M, avg_train_loss:nan time:693/220s step_avg:220ms
step:640/1000, tokens seen: 83.89M, val_loss:nan train_time:138.75s step_avg:220ms
step:650/1000, tokens seen:85.07M, avg_train_loss:nan time:704/220s step_avg:220ms
step:650/1000, tokens seen: 85.20M, val_loss:nan train_time:140.93s step_avg:220ms
step:660/1000, tokens seen:86.38M, avg_train_loss:nan time:714/220s step_avg:220ms
step:660/1000, tokens seen: 86.51M, val_loss:nan train_time:143.11s step_avg:220ms
step:670/1000, tokens seen:87.69M, avg_train_loss:nan time:724/220s step_avg:220ms
step:670/1000, tokens seen: 87.82M, val_loss:nan train_time:145.29s step_avg:220ms
step:680/1000, tokens seen:89.00M, avg_train_loss:nan time:734/220s step_avg:220ms
step:680/1000, tokens seen: 89.13M, val_loss:nan train_time:147.47s step_avg:220ms
step:690/1000, tokens seen:90.31M, avg_train_loss:nan time:745/220s step_avg:220ms
step:690/1000, tokens seen: 90.44M, val_loss:nan train_time:149.65s step_avg:220ms
step:700/1000, tokens seen:91.62M, avg_train_loss:nan time:755/220s step_avg:220ms
step:700/1000, tokens seen: 91.75M, val_loss:nan train_time:151.83s step_avg:220ms
step:710/1000, tokens seen:92.93M, avg_train_loss:nan time:765/220s step_avg:220ms
step:710/1000, tokens seen: 93.06M, val_loss:nan train_time:154.00s step_avg:220ms
step:720/1000, tokens seen:94.24M, avg_train_loss:nan time:775/220s step_avg:220ms
step:720/1000, tokens seen: 94.37M, val_loss:nan train_time:156.18s step_avg:220ms
step:730/1000, tokens seen:95.55M, avg_train_loss:nan time:786/220s step_avg:220ms
step:730/1000, tokens seen: 95.68M, val_loss:nan train_time:158.36s step_avg:220ms
step:740/1000, tokens seen:96.86M, avg_train_loss:nan time:796/220s step_avg:220ms
step:740/1000, tokens seen: 96.99M, val_loss:nan train_time:160.54s step_avg:220ms
step:750/1000, tokens seen:98.17M, avg_train_loss:nan time:806/220s step_avg:220ms
step:750/1000, tokens seen: 98.30M, val_loss:nan train_time:162.72s step_avg:220ms
step:760/1000, tokens seen:99.48M, avg_train_loss:nan time:816/220s step_avg:220ms
step:760/1000, tokens seen: 99.61M, val_loss:nan train_time:164.90s step_avg:220ms
step:770/1000, tokens seen:100.79M, avg_train_loss:nan time:827/220s step_avg:220ms
step:770/1000, tokens seen: 100.93M, val_loss:nan train_time:167.08s step_avg:220ms
step:780/1000, tokens seen:102.11M, avg_train_loss:nan time:837/220s step_avg:220ms
step:780/1000, tokens seen: 102.24M, val_loss:nan train_time:169.26s step_avg:220ms
step:790/1000, tokens seen:103.42M, avg_train_loss:nan time:847/220s step_avg:220ms
step:790/1000, tokens seen: 103.55M, val_loss:nan train_time:171.44s step_avg:220ms
step:800/1000, tokens seen:104.73M, avg_train_loss:nan time:858/220s step_avg:220ms
step:800/1000, tokens seen: 104.86M, val_loss:nan train_time:173.62s step_avg:220ms
step:810/1000, tokens seen:106.04M, avg_train_loss:nan time:868/220s step_avg:220ms
step:810/1000, tokens seen: 106.17M, val_loss:nan train_time:175.80s step_avg:220ms
step:820/1000, tokens seen:107.35M, avg_train_loss:nan time:878/220s step_avg:220ms
step:820/1000, tokens seen: 107.48M, val_loss:nan train_time:177.98s step_avg:220ms
step:830/1000, tokens seen:108.66M, avg_train_loss:nan time:888/220s step_avg:220ms
step:830/1000, tokens seen: 108.79M, val_loss:nan train_time:180.16s step_avg:220ms
step:840/1000, tokens seen:109.97M, avg_train_loss:nan time:899/220s step_avg:220ms
step:840/1000, tokens seen: 110.10M, val_loss:nan train_time:182.34s step_avg:220ms
step:850/1000, tokens seen:111.28M, avg_train_loss:nan time:909/220s step_avg:220ms
step:850/1000, tokens seen: 111.41M, val_loss:nan train_time:184.51s step_avg:220ms
step:860/1000, tokens seen:112.59M, avg_train_loss:nan time:919/220s step_avg:220ms
step:860/1000, tokens seen: 112.72M, val_loss:nan train_time:186.69s step_avg:220ms
step:870/1000, tokens seen:113.90M, avg_train_loss:nan time:929/220s step_avg:220ms
step:870/1000, tokens seen: 114.03M, val_loss:nan train_time:188.87s step_avg:220ms
step:880/1000, tokens seen:115.21M, avg_train_loss:nan time:940/220s step_avg:220ms
step:880/1000, tokens seen: 115.34M, val_loss:nan train_time:191.05s step_avg:220ms
step:890/1000, tokens seen:116.52M, avg_train_loss:nan time:950/220s step_avg:220ms
step:890/1000, tokens seen: 116.65M, val_loss:nan train_time:193.23s step_avg:220ms
step:900/1000, tokens seen:117.83M, avg_train_loss:nan time:960/220s step_avg:220ms
step:900/1000, tokens seen: 117.96M, val_loss:nan train_time:195.41s step_avg:220ms
step:910/1000, tokens seen:119.14M, avg_train_loss:nan time:970/220s step_avg:220ms
step:910/1000, tokens seen: 119.28M, val_loss:nan train_time:197.59s step_avg:220ms
step:920/1000, tokens seen:120.46M, avg_train_loss:nan time:981/220s step_avg:220ms
step:920/1000, tokens seen: 120.59M, val_loss:nan train_time:199.77s step_avg:220ms
step:930/1000, tokens seen:121.77M, avg_train_loss:nan time:991/220s step_avg:220ms
step:930/1000, tokens seen: 121.90M, val_loss:nan train_time:201.95s step_avg:220ms
step:940/1000, tokens seen:123.08M, avg_train_loss:nan time:1001/219s step_avg:219ms
step:940/1000, tokens seen: 123.21M, val_loss:nan train_time:204.13s step_avg:219ms
step:950/1000, tokens seen:124.39M, avg_train_loss:nan time:1012/219s step_avg:219ms
step:950/1000, tokens seen: 124.52M, val_loss:nan train_time:206.31s step_avg:219ms
step:960/1000, tokens seen:125.70M, avg_train_loss:nan time:1022/219s step_avg:219ms
step:960/1000, tokens seen: 125.83M, val_loss:nan train_time:208.49s step_avg:219ms
step:970/1000, tokens seen:127.01M, avg_train_loss:nan time:1032/219s step_avg:219ms
step:970/1000, tokens seen: 127.14M, val_loss:nan train_time:210.67s step_avg:219ms
step:980/1000, tokens seen:128.32M, avg_train_loss:nan time:1042/219s step_avg:219ms
step:980/1000, tokens seen: 128.45M, val_loss:nan train_time:212.85s step_avg:219ms
step:990/1000, tokens seen:129.63M, avg_train_loss:nan time:1053/219s step_avg:219ms
step:990/1000, tokens seen: 129.76M, val_loss:nan train_time:215.03s step_avg:219ms
step:1000/1000, tokens seen:130.94M, avg_train_loss:nan time:1063/219s step_avg:219ms
step:1000/1000, tokens seen: 131.07M, val_loss:nan train_time:217.21s step_avg:219ms
Total training time: 1071.00s
peak memory consumption: 21820 MiB
