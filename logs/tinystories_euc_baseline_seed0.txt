W0216 01:08:45.017497 140637701769024 torch/distributed/run.py:779] 
W0216 01:08:45.017497 140637701769024 torch/distributed/run.py:779] *****************************************
W0216 01:08:45.017497 140637701769024 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 01:08:45.017497 140637701769024 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 1] Using device: cuda:1
[Rank 0] Training DataLoader: 611289391 tokens across 1 files.
[Rank 0] Validation DataLoader: 6150326 tokens across 1 files.
[Rank 0] Model wrapped in DDP.
k params lengths: head = 0, attn = 0
Tokenizer vocab size: 1000
k is not learned

=== Report ===
Model Size:    3.04M

Data Path:            data/tinystories
Sequence Length:      1024
Batch Size (global):  64
Batch Size (device):  32
n_layers:              6
n_heads:               6
head_dim:             32
n_embd:               192
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/4136_ts_ee_s0/
Writing logs to: runs/02.16/4136_ts_ee_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:7.0755 train_time:1.17s step_avg:nanms
step:10/1000, tokens seen:0.59M, avg_train_loss:5.2254 time:40/nans step_avg:nanms
step:10/1000, tokens seen: 0.66M, val_loss:4.5487 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:1.25M, avg_train_loss:4.3861 time:41/15s step_avg:15ms
step:20/1000, tokens seen: 1.31M, val_loss:4.2206 train_time:0.16s step_avg:16ms
step:30/1000, tokens seen:1.90M, avg_train_loss:4.0835 time:41/15s step_avg:15ms
step:30/1000, tokens seen: 1.97M, val_loss:3.9783 train_time:0.31s step_avg:16ms
step:40/1000, tokens seen:2.56M, avg_train_loss:3.8622 time:42/16s step_avg:16ms
step:40/1000, tokens seen: 2.62M, val_loss:3.8101 train_time:0.47s step_avg:16ms
step:50/1000, tokens seen:3.21M, avg_train_loss:3.6675 time:42/16s step_avg:16ms
step:50/1000, tokens seen: 3.28M, val_loss:3.6800 train_time:0.63s step_avg:16ms
step:60/1000, tokens seen:3.87M, avg_train_loss:3.5435 time:43/16s step_avg:16ms
step:60/1000, tokens seen: 3.93M, val_loss:3.5189 train_time:0.78s step_avg:16ms
step:70/1000, tokens seen:4.52M, avg_train_loss:3.3945 time:44/16s step_avg:16ms
step:70/1000, tokens seen: 4.59M, val_loss:3.3772 train_time:0.93s step_avg:16ms
step:80/1000, tokens seen:5.18M, avg_train_loss:3.3047 time:44/16s step_avg:16ms
step:80/1000, tokens seen: 5.24M, val_loss:3.2690 train_time:1.09s step_avg:16ms
step:90/1000, tokens seen:5.83M, avg_train_loss:3.1273 time:45/16s step_avg:16ms
step:90/1000, tokens seen: 5.90M, val_loss:3.1261 train_time:1.25s step_avg:16ms
step:100/1000, tokens seen:6.49M, avg_train_loss:3.0987 time:46/16s step_avg:16ms
step:100/1000, tokens seen: 6.55M, val_loss:3.0444 train_time:1.40s step_avg:16ms
step:110/1000, tokens seen:7.14M, avg_train_loss:3.0008 time:46/16s step_avg:16ms
step:110/1000, tokens seen: 7.21M, val_loss:2.9295 train_time:1.55s step_avg:16ms
step:120/1000, tokens seen:7.80M, avg_train_loss:2.9049 time:47/16s step_avg:16ms
step:120/1000, tokens seen: 7.86M, val_loss:2.8382 train_time:1.71s step_avg:16ms
step:130/1000, tokens seen:8.45M, avg_train_loss:2.7655 time:47/15s step_avg:15ms
step:130/1000, tokens seen: 8.52M, val_loss:2.7876 train_time:1.86s step_avg:15ms
step:140/1000, tokens seen:9.11M, avg_train_loss:2.6765 time:48/15s step_avg:15ms
step:140/1000, tokens seen: 9.18M, val_loss:2.7057 train_time:2.01s step_avg:15ms
step:150/1000, tokens seen:9.76M, avg_train_loss:2.6424 time:49/15s step_avg:15ms
step:150/1000, tokens seen: 9.83M, val_loss:2.6509 train_time:2.17s step_avg:15ms
step:160/1000, tokens seen:10.42M, avg_train_loss:2.6604 time:49/15s step_avg:15ms
step:160/1000, tokens seen: 10.49M, val_loss:2.5938 train_time:2.32s step_avg:15ms
step:170/1000, tokens seen:11.08M, avg_train_loss:2.5099 time:50/15s step_avg:15ms
step:170/1000, tokens seen: 11.14M, val_loss:2.5446 train_time:2.47s step_avg:15ms
step:180/1000, tokens seen:11.73M, avg_train_loss:2.5089 time:51/15s step_avg:15ms
step:180/1000, tokens seen: 11.80M, val_loss:2.4930 train_time:2.62s step_avg:15ms
step:190/1000, tokens seen:12.39M, avg_train_loss:2.5180 time:51/15s step_avg:15ms
step:190/1000, tokens seen: 12.45M, val_loss:2.4500 train_time:2.77s step_avg:15ms
step:200/1000, tokens seen:13.04M, avg_train_loss:2.4490 time:52/15s step_avg:15ms
step:200/1000, tokens seen: 13.11M, val_loss:2.4096 train_time:2.93s step_avg:15ms
step:210/1000, tokens seen:13.70M, avg_train_loss:2.4630 time:52/15s step_avg:15ms
step:210/1000, tokens seen: 13.76M, val_loss:2.4030 train_time:3.08s step_avg:15ms
step:220/1000, tokens seen:14.35M, avg_train_loss:2.3866 time:53/15s step_avg:15ms
step:220/1000, tokens seen: 14.42M, val_loss:2.3532 train_time:3.23s step_avg:15ms
step:230/1000, tokens seen:15.01M, avg_train_loss:2.3495 time:54/15s step_avg:15ms
step:230/1000, tokens seen: 15.07M, val_loss:2.3226 train_time:3.38s step_avg:15ms
step:240/1000, tokens seen:15.66M, avg_train_loss:2.3106 time:54/15s step_avg:15ms
step:240/1000, tokens seen: 15.73M, val_loss:2.3106 train_time:3.53s step_avg:15ms
step:250/1000, tokens seen:16.32M, avg_train_loss:2.2466 time:55/15s step_avg:15ms
step:250/1000, tokens seen: 16.38M, val_loss:2.2725 train_time:3.69s step_avg:15ms
step:260/1000, tokens seen:16.97M, avg_train_loss:2.2179 time:56/15s step_avg:15ms
step:260/1000, tokens seen: 17.04M, val_loss:2.2587 train_time:3.84s step_avg:15ms
step:270/1000, tokens seen:17.63M, avg_train_loss:2.2887 time:56/15s step_avg:15ms
step:270/1000, tokens seen: 17.69M, val_loss:2.2363 train_time:3.99s step_avg:15ms
step:280/1000, tokens seen:18.28M, avg_train_loss:2.2551 time:57/15s step_avg:15ms
step:280/1000, tokens seen: 18.35M, val_loss:2.2129 train_time:4.15s step_avg:15ms
step:290/1000, tokens seen:18.94M, avg_train_loss:2.2759 time:57/15s step_avg:15ms
step:290/1000, tokens seen: 19.01M, val_loss:2.1933 train_time:4.30s step_avg:15ms
step:300/1000, tokens seen:19.60M, avg_train_loss:2.1450 time:58/15s step_avg:15ms
step:300/1000, tokens seen: 19.66M, val_loss:2.1792 train_time:4.45s step_avg:15ms
step:310/1000, tokens seen:20.25M, avg_train_loss:2.2018 time:59/15s step_avg:15ms
step:310/1000, tokens seen: 20.32M, val_loss:2.1595 train_time:4.60s step_avg:15ms
step:320/1000, tokens seen:20.91M, avg_train_loss:2.1494 time:59/15s step_avg:15ms
step:320/1000, tokens seen: 20.97M, val_loss:2.1356 train_time:4.75s step_avg:15ms
step:330/1000, tokens seen:21.56M, avg_train_loss:2.1542 time:60/15s step_avg:15ms
step:330/1000, tokens seen: 21.63M, val_loss:2.1309 train_time:4.90s step_avg:15ms
step:340/1000, tokens seen:22.22M, avg_train_loss:2.1070 time:61/15s step_avg:15ms
step:340/1000, tokens seen: 22.28M, val_loss:2.1068 train_time:5.06s step_avg:15ms
step:350/1000, tokens seen:22.87M, avg_train_loss:2.1851 time:61/15s step_avg:15ms
step:350/1000, tokens seen: 22.94M, val_loss:2.1067 train_time:5.21s step_avg:15ms
step:360/1000, tokens seen:23.53M, avg_train_loss:2.1387 time:62/15s step_avg:15ms
step:360/1000, tokens seen: 23.59M, val_loss:2.0873 train_time:5.36s step_avg:15ms
step:370/1000, tokens seen:24.18M, avg_train_loss:2.0347 time:62/15s step_avg:15ms
step:370/1000, tokens seen: 24.25M, val_loss:2.0725 train_time:5.51s step_avg:15ms
step:380/1000, tokens seen:24.84M, avg_train_loss:2.1471 time:63/15s step_avg:15ms
step:380/1000, tokens seen: 24.90M, val_loss:2.0642 train_time:5.67s step_avg:15ms
step:390/1000, tokens seen:25.49M, avg_train_loss:2.1186 time:64/15s step_avg:15ms
step:390/1000, tokens seen: 25.56M, val_loss:2.0522 train_time:5.82s step_avg:15ms
step:400/1000, tokens seen:26.15M, avg_train_loss:2.0415 time:64/15s step_avg:15ms
step:400/1000, tokens seen: 26.21M, val_loss:2.0392 train_time:5.99s step_avg:15ms
step:410/1000, tokens seen:26.80M, avg_train_loss:1.9511 time:65/15s step_avg:15ms
step:410/1000, tokens seen: 26.87M, val_loss:2.0260 train_time:6.14s step_avg:15ms
step:420/1000, tokens seen:27.46M, avg_train_loss:1.9426 time:66/15s step_avg:15ms
step:420/1000, tokens seen: 27.53M, val_loss:2.0269 train_time:6.29s step_avg:15ms
step:430/1000, tokens seen:28.11M, avg_train_loss:2.0252 time:66/15s step_avg:15ms
step:430/1000, tokens seen: 28.18M, val_loss:2.0069 train_time:6.44s step_avg:15ms
step:440/1000, tokens seen:28.77M, avg_train_loss:2.0739 time:67/15s step_avg:15ms
step:440/1000, tokens seen: 28.84M, val_loss:2.0009 train_time:6.60s step_avg:15ms
step:450/1000, tokens seen:29.43M, avg_train_loss:2.0171 time:67/15s step_avg:15ms
step:450/1000, tokens seen: 29.49M, val_loss:2.0033 train_time:6.75s step_avg:15ms
step:460/1000, tokens seen:30.08M, avg_train_loss:1.9552 time:68/15s step_avg:15ms
step:460/1000, tokens seen: 30.15M, val_loss:2.0015 train_time:6.90s step_avg:15ms
step:470/1000, tokens seen:30.74M, avg_train_loss:1.9382 time:69/15s step_avg:15ms
step:470/1000, tokens seen: 30.80M, val_loss:1.9767 train_time:7.05s step_avg:15ms
step:480/1000, tokens seen:31.39M, avg_train_loss:1.9196 time:69/15s step_avg:15ms
step:480/1000, tokens seen: 31.46M, val_loss:1.9715 train_time:7.20s step_avg:15ms
step:490/1000, tokens seen:32.05M, avg_train_loss:1.8927 time:70/15s step_avg:15ms
step:490/1000, tokens seen: 32.11M, val_loss:1.9669 train_time:7.36s step_avg:15ms
step:500/1000, tokens seen:32.70M, avg_train_loss:2.0347 time:71/15s step_avg:15ms
step:500/1000, tokens seen: 32.77M, val_loss:1.9616 train_time:7.51s step_avg:15ms
step:510/1000, tokens seen:33.36M, avg_train_loss:1.9637 time:71/15s step_avg:15ms
step:510/1000, tokens seen: 33.42M, val_loss:1.9502 train_time:7.67s step_avg:15ms
step:520/1000, tokens seen:34.01M, avg_train_loss:1.8715 time:72/15s step_avg:15ms
step:520/1000, tokens seen: 34.08M, val_loss:1.9388 train_time:7.82s step_avg:15ms
step:530/1000, tokens seen:34.67M, avg_train_loss:1.9180 time:72/15s step_avg:15ms
step:530/1000, tokens seen: 34.73M, val_loss:1.9316 train_time:7.97s step_avg:15ms
step:540/1000, tokens seen:35.32M, avg_train_loss:1.8999 time:73/15s step_avg:15ms
step:540/1000, tokens seen: 35.39M, val_loss:1.9291 train_time:8.12s step_avg:15ms
step:550/1000, tokens seen:35.98M, avg_train_loss:1.9850 time:74/15s step_avg:15ms
step:550/1000, tokens seen: 36.04M, val_loss:1.9186 train_time:8.27s step_avg:15ms
step:560/1000, tokens seen:36.63M, avg_train_loss:1.9445 time:74/15s step_avg:15ms
step:560/1000, tokens seen: 36.70M, val_loss:1.9127 train_time:8.43s step_avg:15ms
step:570/1000, tokens seen:37.29M, avg_train_loss:1.8889 time:75/15s step_avg:15ms
step:570/1000, tokens seen: 37.36M, val_loss:1.9103 train_time:8.59s step_avg:15ms
step:580/1000, tokens seen:37.95M, avg_train_loss:1.8473 time:76/15s step_avg:15ms
step:580/1000, tokens seen: 38.01M, val_loss:1.9071 train_time:8.74s step_avg:15ms
step:590/1000, tokens seen:38.60M, avg_train_loss:1.9253 time:76/15s step_avg:15ms
step:590/1000, tokens seen: 38.67M, val_loss:1.8994 train_time:8.90s step_avg:15ms
step:600/1000, tokens seen:39.26M, avg_train_loss:1.8257 time:77/15s step_avg:15ms
step:600/1000, tokens seen: 39.32M, val_loss:1.8941 train_time:9.05s step_avg:15ms
step:610/1000, tokens seen:39.91M, avg_train_loss:1.9824 time:77/15s step_avg:15ms
step:610/1000, tokens seen: 39.98M, val_loss:1.8922 train_time:9.24s step_avg:15ms
step:620/1000, tokens seen:40.57M, avg_train_loss:1.9029 time:78/15s step_avg:15ms
step:620/1000, tokens seen: 40.63M, val_loss:1.8820 train_time:9.40s step_avg:15ms
step:630/1000, tokens seen:41.22M, avg_train_loss:1.8699 time:79/15s step_avg:15ms
step:630/1000, tokens seen: 41.29M, val_loss:1.8722 train_time:9.56s step_avg:15ms
step:640/1000, tokens seen:41.88M, avg_train_loss:1.8607 time:79/15s step_avg:15ms
step:640/1000, tokens seen: 41.94M, val_loss:1.8653 train_time:9.72s step_avg:15ms
step:650/1000, tokens seen:42.53M, avg_train_loss:1.7214 time:80/15s step_avg:15ms
step:650/1000, tokens seen: 42.60M, val_loss:1.8746 train_time:9.88s step_avg:15ms
step:660/1000, tokens seen:43.19M, avg_train_loss:1.8605 time:81/15s step_avg:15ms
step:660/1000, tokens seen: 43.25M, val_loss:1.8564 train_time:10.04s step_avg:15ms
step:670/1000, tokens seen:43.84M, avg_train_loss:1.8645 time:81/15s step_avg:15ms
step:670/1000, tokens seen: 43.91M, val_loss:1.8501 train_time:10.19s step_avg:15ms
step:680/1000, tokens seen:44.50M, avg_train_loss:1.8160 time:82/15s step_avg:15ms
step:680/1000, tokens seen: 44.56M, val_loss:1.8409 train_time:10.34s step_avg:15ms
step:690/1000, tokens seen:45.15M, avg_train_loss:1.8092 time:83/15s step_avg:15ms
step:690/1000, tokens seen: 45.22M, val_loss:1.8452 train_time:10.49s step_avg:15ms
step:700/1000, tokens seen:45.81M, avg_train_loss:1.8393 time:83/15s step_avg:15ms
step:700/1000, tokens seen: 45.88M, val_loss:1.8340 train_time:10.65s step_avg:15ms
step:710/1000, tokens seen:46.47M, avg_train_loss:1.8286 time:84/15s step_avg:15ms
step:710/1000, tokens seen: 46.53M, val_loss:1.8274 train_time:10.80s step_avg:15ms
step:720/1000, tokens seen:47.12M, avg_train_loss:1.8141 time:84/15s step_avg:15ms
step:720/1000, tokens seen: 47.19M, val_loss:1.8227 train_time:10.95s step_avg:15ms
step:730/1000, tokens seen:47.78M, avg_train_loss:1.7512 time:85/15s step_avg:15ms
step:730/1000, tokens seen: 47.84M, val_loss:1.8178 train_time:11.10s step_avg:15ms
step:740/1000, tokens seen:48.43M, avg_train_loss:1.7390 time:86/15s step_avg:15ms
step:740/1000, tokens seen: 48.50M, val_loss:1.8192 train_time:11.25s step_avg:15ms
step:750/1000, tokens seen:49.09M, avg_train_loss:1.7151 time:86/15s step_avg:15ms
step:750/1000, tokens seen: 49.15M, val_loss:1.8163 train_time:11.41s step_avg:15ms
step:760/1000, tokens seen:49.74M, avg_train_loss:1.7441 time:87/15s step_avg:15ms
step:760/1000, tokens seen: 49.81M, val_loss:1.8038 train_time:11.56s step_avg:15ms
step:770/1000, tokens seen:50.40M, avg_train_loss:1.8331 time:88/15s step_avg:15ms
step:770/1000, tokens seen: 50.46M, val_loss:1.7990 train_time:11.71s step_avg:15ms
step:780/1000, tokens seen:51.05M, avg_train_loss:1.6967 time:88/15s step_avg:15ms
step:780/1000, tokens seen: 51.12M, val_loss:1.7955 train_time:11.87s step_avg:15ms
step:790/1000, tokens seen:51.71M, avg_train_loss:1.8011 time:89/15s step_avg:15ms
step:790/1000, tokens seen: 51.77M, val_loss:1.7875 train_time:12.02s step_avg:15ms
step:800/1000, tokens seen:52.36M, avg_train_loss:1.7649 time:90/15s step_avg:15ms
step:800/1000, tokens seen: 52.43M, val_loss:1.7864 train_time:12.18s step_avg:15ms
step:810/1000, tokens seen:53.02M, avg_train_loss:1.7926 time:90/15s step_avg:15ms
step:810/1000, tokens seen: 53.08M, val_loss:1.7751 train_time:12.33s step_avg:15ms
step:820/1000, tokens seen:53.67M, avg_train_loss:1.7893 time:91/15s step_avg:15ms
step:820/1000, tokens seen: 53.74M, val_loss:1.7757 train_time:12.48s step_avg:15ms
step:830/1000, tokens seen:54.33M, avg_train_loss:1.8444 time:91/15s step_avg:15ms
step:830/1000, tokens seen: 54.39M, val_loss:1.7701 train_time:12.64s step_avg:15ms
step:840/1000, tokens seen:54.98M, avg_train_loss:1.7247 time:92/15s step_avg:15ms
step:840/1000, tokens seen: 55.05M, val_loss:1.7664 train_time:12.79s step_avg:15ms
step:850/1000, tokens seen:55.64M, avg_train_loss:1.6802 time:93/15s step_avg:15ms
step:850/1000, tokens seen: 55.71M, val_loss:1.7601 train_time:12.95s step_avg:15ms
step:860/1000, tokens seen:56.30M, avg_train_loss:1.7180 time:93/15s step_avg:15ms
step:860/1000, tokens seen: 56.36M, val_loss:1.7559 train_time:13.11s step_avg:15ms
step:870/1000, tokens seen:56.95M, avg_train_loss:1.6210 time:94/15s step_avg:15ms
step:870/1000, tokens seen: 57.02M, val_loss:1.7514 train_time:13.26s step_avg:15ms
step:880/1000, tokens seen:57.61M, avg_train_loss:1.7411 time:95/15s step_avg:15ms
step:880/1000, tokens seen: 57.67M, val_loss:1.7467 train_time:13.42s step_avg:15ms
step:890/1000, tokens seen:58.26M, avg_train_loss:1.7331 time:95/15s step_avg:15ms
step:890/1000, tokens seen: 58.33M, val_loss:1.7425 train_time:13.58s step_avg:15ms
step:900/1000, tokens seen:58.92M, avg_train_loss:1.6970 time:96/15s step_avg:15ms
step:900/1000, tokens seen: 58.98M, val_loss:1.7374 train_time:13.73s step_avg:15ms
step:910/1000, tokens seen:59.57M, avg_train_loss:1.6853 time:96/15s step_avg:15ms
step:910/1000, tokens seen: 59.64M, val_loss:1.7355 train_time:13.89s step_avg:15ms
step:920/1000, tokens seen:60.23M, avg_train_loss:1.6956 time:97/15s step_avg:15ms
step:920/1000, tokens seen: 60.29M, val_loss:1.7325 train_time:14.05s step_avg:15ms
step:930/1000, tokens seen:60.88M, avg_train_loss:1.7408 time:98/15s step_avg:15ms
step:930/1000, tokens seen: 60.95M, val_loss:1.7283 train_time:14.21s step_avg:15ms
step:940/1000, tokens seen:61.54M, avg_train_loss:1.6361 time:98/15s step_avg:15ms
step:940/1000, tokens seen: 61.60M, val_loss:1.7252 train_time:14.37s step_avg:15ms
step:950/1000, tokens seen:62.19M, avg_train_loss:1.7257 time:99/15s step_avg:15ms
step:950/1000, tokens seen: 62.26M, val_loss:1.7216 train_time:14.52s step_avg:15ms
step:960/1000, tokens seen:62.85M, avg_train_loss:1.6913 time:100/15s step_avg:15ms
step:960/1000, tokens seen: 62.91M, val_loss:1.7176 train_time:14.69s step_avg:15ms
step:970/1000, tokens seen:63.50M, avg_train_loss:1.7277 time:100/15s step_avg:15ms
step:970/1000, tokens seen: 63.57M, val_loss:1.7142 train_time:14.85s step_avg:15ms
step:980/1000, tokens seen:64.16M, avg_train_loss:1.7802 time:101/15s step_avg:15ms
step:980/1000, tokens seen: 64.23M, val_loss:1.7114 train_time:15.04s step_avg:16ms
step:990/1000, tokens seen:64.82M, avg_train_loss:1.6379 time:102/15s step_avg:15ms
step:990/1000, tokens seen: 64.88M, val_loss:1.7092 train_time:15.21s step_avg:16ms
step:1000/1000, tokens seen:65.47M, avg_train_loss:1.7117 time:102/16s step_avg:16ms
step:1000/1000, tokens seen: 65.54M, val_loss:1.7064 train_time:15.38s step_avg:16ms
Total training time: 102.80s
peak memory consumption: 2100 MiB
