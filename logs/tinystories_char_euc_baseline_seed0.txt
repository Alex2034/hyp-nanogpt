W0216 01:10:45.723928 139627560433472 torch/distributed/run.py:779] 
W0216 01:10:45.723928 139627560433472 torch/distributed/run.py:779] *****************************************
W0216 01:10:45.723928 139627560433472 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 01:10:45.723928 139627560433472 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 0] Training DataLoader: 187975984 tokens across 1 files.
[Rank 0] Validation DataLoader: 1909027 tokens across 1 files.
[Rank 1] Using device: cuda:1
[Rank 0] Model wrapped in DDP.
k params lengths: head = 0, attn = 0
Tokenizer vocab size: 122
k is not learned

=== Report ===
Model Size:    310.53K

Data Path:            data/tinystories_char
Sequence Length:      1024
Batch Size (global):  128
Batch Size (device):  64
n_layers:              6
n_heads:               4
head_dim:             16
n_embd:               64
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/4259_tsc_ee_s0/
Writing logs to: runs/02.16/4259_tsc_ee_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:5.0328 train_time:0.19s step_avg:nanms
step:10/1000, tokens seen:1.18M, avg_train_loss:3.1823 time:37/nans step_avg:nanms
step:10/1000, tokens seen: 1.31M, val_loss:2.5152 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:2.49M, avg_train_loss:2.4434 time:37/15s step_avg:15ms
step:20/1000, tokens seen: 2.62M, val_loss:2.3852 train_time:0.15s step_avg:15ms
step:30/1000, tokens seen:3.80M, avg_train_loss:2.3627 time:38/15s step_avg:15ms
step:30/1000, tokens seen: 3.93M, val_loss:2.3291 train_time:0.30s step_avg:15ms
step:40/1000, tokens seen:5.11M, avg_train_loss:2.3251 time:38/15s step_avg:15ms
step:40/1000, tokens seen: 5.24M, val_loss:2.3197 train_time:0.47s step_avg:16ms
step:50/1000, tokens seen:6.42M, avg_train_loss:2.2937 time:38/15s step_avg:15ms
step:50/1000, tokens seen: 6.55M, val_loss:2.2555 train_time:0.62s step_avg:15ms
step:60/1000, tokens seen:7.73M, avg_train_loss:2.2285 time:39/15s step_avg:15ms
step:60/1000, tokens seen: 7.86M, val_loss:2.2112 train_time:0.78s step_avg:16ms
step:70/1000, tokens seen:9.04M, avg_train_loss:2.1612 time:39/15s step_avg:15ms
step:70/1000, tokens seen: 9.18M, val_loss:2.1221 train_time:0.93s step_avg:16ms
step:80/1000, tokens seen:10.35M, avg_train_loss:2.0686 time:40/15s step_avg:15ms
step:80/1000, tokens seen: 10.49M, val_loss:2.0279 train_time:1.09s step_avg:16ms
step:90/1000, tokens seen:11.67M, avg_train_loss:1.9990 time:40/16s step_avg:16ms
step:90/1000, tokens seen: 11.80M, val_loss:1.9449 train_time:1.24s step_avg:16ms
step:100/1000, tokens seen:12.98M, avg_train_loss:1.9193 time:40/15s step_avg:15ms
step:100/1000, tokens seen: 13.11M, val_loss:1.8668 train_time:1.39s step_avg:15ms
step:110/1000, tokens seen:14.29M, avg_train_loss:1.8429 time:41/15s step_avg:15ms
step:110/1000, tokens seen: 14.42M, val_loss:1.7995 train_time:1.57s step_avg:16ms
step:120/1000, tokens seen:15.60M, avg_train_loss:1.7753 time:41/16s step_avg:16ms
step:120/1000, tokens seen: 15.73M, val_loss:1.7236 train_time:1.72s step_avg:16ms
step:130/1000, tokens seen:16.91M, avg_train_loss:1.7051 time:42/16s step_avg:16ms
step:130/1000, tokens seen: 17.04M, val_loss:1.6563 train_time:1.89s step_avg:16ms
step:140/1000, tokens seen:18.22M, avg_train_loss:1.6296 time:42/16s step_avg:16ms
step:140/1000, tokens seen: 18.35M, val_loss:1.6159 train_time:2.04s step_avg:16ms
step:150/1000, tokens seen:19.53M, avg_train_loss:1.5830 time:42/16s step_avg:16ms
step:150/1000, tokens seen: 19.66M, val_loss:1.5510 train_time:2.20s step_avg:16ms
step:160/1000, tokens seen:20.84M, avg_train_loss:1.5139 time:43/16s step_avg:16ms
step:160/1000, tokens seen: 20.97M, val_loss:1.4927 train_time:2.35s step_avg:16ms
step:170/1000, tokens seen:22.15M, avg_train_loss:1.4610 time:43/16s step_avg:16ms
step:170/1000, tokens seen: 22.28M, val_loss:1.4458 train_time:2.52s step_avg:16ms
step:180/1000, tokens seen:23.46M, avg_train_loss:1.4202 time:44/16s step_avg:16ms
step:180/1000, tokens seen: 23.59M, val_loss:1.4083 train_time:2.69s step_avg:16ms
step:190/1000, tokens seen:24.77M, avg_train_loss:1.3880 time:44/16s step_avg:16ms
step:190/1000, tokens seen: 24.90M, val_loss:1.3610 train_time:2.86s step_avg:16ms
step:200/1000, tokens seen:26.08M, avg_train_loss:1.3536 time:44/16s step_avg:16ms
step:200/1000, tokens seen: 26.21M, val_loss:1.3267 train_time:3.01s step_avg:16ms
step:210/1000, tokens seen:27.39M, avg_train_loss:1.3116 time:45/16s step_avg:16ms
step:210/1000, tokens seen: 27.53M, val_loss:1.3058 train_time:3.16s step_avg:16ms
step:220/1000, tokens seen:28.70M, avg_train_loss:1.2828 time:45/16s step_avg:16ms
step:220/1000, tokens seen: 28.84M, val_loss:1.2721 train_time:3.32s step_avg:16ms
step:230/1000, tokens seen:30.02M, avg_train_loss:1.2603 time:46/16s step_avg:16ms
step:230/1000, tokens seen: 30.15M, val_loss:1.2482 train_time:3.47s step_avg:16ms
step:240/1000, tokens seen:31.33M, avg_train_loss:1.2482 time:46/16s step_avg:16ms
step:240/1000, tokens seen: 31.46M, val_loss:1.2395 train_time:3.62s step_avg:16ms
step:250/1000, tokens seen:32.64M, avg_train_loss:1.2223 time:46/16s step_avg:16ms
step:250/1000, tokens seen: 32.77M, val_loss:1.2042 train_time:3.77s step_avg:16ms
step:260/1000, tokens seen:33.95M, avg_train_loss:1.2038 time:47/16s step_avg:16ms
step:260/1000, tokens seen: 34.08M, val_loss:1.1829 train_time:3.93s step_avg:16ms
step:270/1000, tokens seen:35.26M, avg_train_loss:1.1792 time:47/16s step_avg:16ms
step:270/1000, tokens seen: 35.39M, val_loss:1.1755 train_time:4.08s step_avg:16ms
step:280/1000, tokens seen:36.57M, avg_train_loss:1.1671 time:47/16s step_avg:16ms
step:280/1000, tokens seen: 36.70M, val_loss:1.1708 train_time:4.24s step_avg:16ms
step:290/1000, tokens seen:37.88M, avg_train_loss:1.1492 time:48/16s step_avg:16ms
step:290/1000, tokens seen: 38.01M, val_loss:1.1346 train_time:4.39s step_avg:16ms
step:300/1000, tokens seen:39.19M, avg_train_loss:1.1350 time:48/16s step_avg:16ms
step:300/1000, tokens seen: 39.32M, val_loss:1.1290 train_time:4.56s step_avg:16ms
step:310/1000, tokens seen:40.50M, avg_train_loss:1.1243 time:49/16s step_avg:16ms
step:310/1000, tokens seen: 40.63M, val_loss:1.1121 train_time:4.71s step_avg:16ms
step:320/1000, tokens seen:41.81M, avg_train_loss:1.1125 time:49/16s step_avg:16ms
step:320/1000, tokens seen: 41.94M, val_loss:1.1079 train_time:4.86s step_avg:16ms
step:330/1000, tokens seen:43.12M, avg_train_loss:1.1023 time:49/16s step_avg:16ms
step:330/1000, tokens seen: 43.25M, val_loss:1.0910 train_time:5.01s step_avg:16ms
step:340/1000, tokens seen:44.43M, avg_train_loss:1.0950 time:50/16s step_avg:16ms
step:340/1000, tokens seen: 44.56M, val_loss:1.0798 train_time:5.18s step_avg:16ms
step:350/1000, tokens seen:45.74M, avg_train_loss:1.0864 time:50/16s step_avg:16ms
step:350/1000, tokens seen: 45.88M, val_loss:1.0753 train_time:5.33s step_avg:16ms
step:360/1000, tokens seen:47.05M, avg_train_loss:1.0704 time:51/16s step_avg:16ms
step:360/1000, tokens seen: 47.19M, val_loss:1.0770 train_time:5.48s step_avg:16ms
step:370/1000, tokens seen:48.37M, avg_train_loss:1.0704 time:51/16s step_avg:16ms
step:370/1000, tokens seen: 48.50M, val_loss:1.0605 train_time:5.63s step_avg:16ms
step:380/1000, tokens seen:49.68M, avg_train_loss:1.0540 time:51/16s step_avg:16ms
step:380/1000, tokens seen: 49.81M, val_loss:1.0531 train_time:5.79s step_avg:16ms
step:390/1000, tokens seen:50.99M, avg_train_loss:1.0464 time:52/16s step_avg:16ms
step:390/1000, tokens seen: 51.12M, val_loss:1.0422 train_time:5.94s step_avg:16ms
step:400/1000, tokens seen:52.30M, avg_train_loss:1.0351 time:52/16s step_avg:16ms
step:400/1000, tokens seen: 52.43M, val_loss:1.0317 train_time:6.09s step_avg:16ms
step:410/1000, tokens seen:53.61M, avg_train_loss:1.0329 time:53/16s step_avg:16ms
step:410/1000, tokens seen: 53.74M, val_loss:1.0316 train_time:6.25s step_avg:16ms
step:420/1000, tokens seen:54.92M, avg_train_loss:1.0351 time:53/16s step_avg:16ms
step:420/1000, tokens seen: 55.05M, val_loss:1.0274 train_time:6.41s step_avg:16ms
step:430/1000, tokens seen:56.23M, avg_train_loss:1.0249 time:53/16s step_avg:16ms
step:430/1000, tokens seen: 56.36M, val_loss:1.0191 train_time:6.56s step_avg:16ms
step:440/1000, tokens seen:57.54M, avg_train_loss:1.0190 time:54/16s step_avg:16ms
step:440/1000, tokens seen: 57.67M, val_loss:1.0105 train_time:6.73s step_avg:16ms
step:450/1000, tokens seen:58.85M, avg_train_loss:1.0120 time:54/16s step_avg:16ms
step:450/1000, tokens seen: 58.98M, val_loss:1.0073 train_time:6.88s step_avg:16ms
step:460/1000, tokens seen:60.16M, avg_train_loss:1.0086 time:55/16s step_avg:16ms
step:460/1000, tokens seen: 60.29M, val_loss:0.9992 train_time:7.04s step_avg:16ms
step:470/1000, tokens seen:61.47M, avg_train_loss:1.0017 time:55/16s step_avg:16ms
step:470/1000, tokens seen: 61.60M, val_loss:0.9945 train_time:7.19s step_avg:16ms
step:480/1000, tokens seen:62.78M, avg_train_loss:0.9992 time:55/16s step_avg:16ms
step:480/1000, tokens seen: 62.91M, val_loss:0.9905 train_time:7.35s step_avg:16ms
step:490/1000, tokens seen:64.09M, avg_train_loss:0.9904 time:56/16s step_avg:16ms
step:490/1000, tokens seen: 64.23M, val_loss:0.9857 train_time:7.50s step_avg:16ms
step:500/1000, tokens seen:65.40M, avg_train_loss:0.9759 time:56/16s step_avg:16ms
step:500/1000, tokens seen: 65.54M, val_loss:0.9841 train_time:7.65s step_avg:16ms
step:510/1000, tokens seen:66.72M, avg_train_loss:0.9899 time:57/16s step_avg:16ms
step:510/1000, tokens seen: 66.85M, val_loss:0.9742 train_time:7.83s step_avg:16ms
step:520/1000, tokens seen:68.03M, avg_train_loss:0.9652 time:57/16s step_avg:16ms
step:520/1000, tokens seen: 68.16M, val_loss:0.9740 train_time:7.98s step_avg:16ms
step:530/1000, tokens seen:69.34M, avg_train_loss:0.9713 time:57/16s step_avg:16ms
step:530/1000, tokens seen: 69.47M, val_loss:0.9671 train_time:8.15s step_avg:16ms
step:540/1000, tokens seen:70.65M, avg_train_loss:0.9732 time:58/16s step_avg:16ms
step:540/1000, tokens seen: 70.78M, val_loss:0.9668 train_time:8.30s step_avg:16ms
step:550/1000, tokens seen:71.96M, avg_train_loss:0.9594 time:58/16s step_avg:16ms
step:550/1000, tokens seen: 72.09M, val_loss:0.9617 train_time:8.46s step_avg:16ms
step:560/1000, tokens seen:73.27M, avg_train_loss:0.9565 time:59/16s step_avg:16ms
step:560/1000, tokens seen: 73.40M, val_loss:0.9609 train_time:8.61s step_avg:16ms
step:570/1000, tokens seen:74.58M, avg_train_loss:0.9618 time:59/16s step_avg:16ms
step:570/1000, tokens seen: 74.71M, val_loss:0.9569 train_time:8.76s step_avg:16ms
step:580/1000, tokens seen:75.89M, avg_train_loss:0.9565 time:59/16s step_avg:16ms
step:580/1000, tokens seen: 76.02M, val_loss:0.9510 train_time:8.91s step_avg:16ms
step:590/1000, tokens seen:77.20M, avg_train_loss:0.9523 time:60/16s step_avg:16ms
step:590/1000, tokens seen: 77.33M, val_loss:0.9490 train_time:9.07s step_avg:16ms
step:600/1000, tokens seen:78.51M, avg_train_loss:0.9467 time:60/16s step_avg:16ms
step:600/1000, tokens seen: 78.64M, val_loss:0.9448 train_time:9.22s step_avg:16ms
step:610/1000, tokens seen:79.82M, avg_train_loss:0.9462 time:60/16s step_avg:16ms
step:610/1000, tokens seen: 79.95M, val_loss:0.9418 train_time:9.37s step_avg:16ms
step:620/1000, tokens seen:81.13M, avg_train_loss:0.9376 time:61/16s step_avg:16ms
step:620/1000, tokens seen: 81.26M, val_loss:0.9404 train_time:9.52s step_avg:16ms
step:630/1000, tokens seen:82.44M, avg_train_loss:0.9440 time:61/16s step_avg:16ms
step:630/1000, tokens seen: 82.58M, val_loss:0.9335 train_time:9.68s step_avg:16ms
step:640/1000, tokens seen:83.76M, avg_train_loss:0.9392 time:62/16s step_avg:16ms
step:640/1000, tokens seen: 83.89M, val_loss:0.9317 train_time:9.83s step_avg:16ms
step:650/1000, tokens seen:85.07M, avg_train_loss:0.9278 time:62/16s step_avg:16ms
step:650/1000, tokens seen: 85.20M, val_loss:0.9288 train_time:10.00s step_avg:16ms
step:660/1000, tokens seen:86.38M, avg_train_loss:0.9241 time:62/16s step_avg:16ms
step:660/1000, tokens seen: 86.51M, val_loss:0.9208 train_time:10.15s step_avg:16ms
step:670/1000, tokens seen:87.69M, avg_train_loss:0.9217 time:63/16s step_avg:16ms
step:670/1000, tokens seen: 87.82M, val_loss:0.9189 train_time:10.31s step_avg:16ms
step:680/1000, tokens seen:89.00M, avg_train_loss:0.9142 time:63/16s step_avg:16ms
step:680/1000, tokens seen: 89.13M, val_loss:0.9157 train_time:10.46s step_avg:16ms
step:690/1000, tokens seen:90.31M, avg_train_loss:0.9159 time:64/16s step_avg:16ms
step:690/1000, tokens seen: 90.44M, val_loss:0.9111 train_time:10.61s step_avg:16ms
step:700/1000, tokens seen:91.62M, avg_train_loss:0.9057 time:64/16s step_avg:16ms
step:700/1000, tokens seen: 91.75M, val_loss:0.9114 train_time:10.76s step_avg:16ms
step:710/1000, tokens seen:92.93M, avg_train_loss:0.9112 time:64/16s step_avg:16ms
step:710/1000, tokens seen: 93.06M, val_loss:0.9028 train_time:10.91s step_avg:16ms
step:720/1000, tokens seen:94.24M, avg_train_loss:0.8931 time:65/16s step_avg:16ms
step:720/1000, tokens seen: 94.37M, val_loss:0.9017 train_time:11.07s step_avg:16ms
step:730/1000, tokens seen:95.55M, avg_train_loss:0.8968 time:65/16s step_avg:16ms
step:730/1000, tokens seen: 95.68M, val_loss:0.8976 train_time:11.22s step_avg:16ms
step:740/1000, tokens seen:96.86M, avg_train_loss:0.8983 time:66/16s step_avg:16ms
step:740/1000, tokens seen: 96.99M, val_loss:0.8961 train_time:11.39s step_avg:16ms
step:750/1000, tokens seen:98.17M, avg_train_loss:0.9059 time:66/16s step_avg:16ms
step:750/1000, tokens seen: 98.30M, val_loss:0.8939 train_time:11.54s step_avg:16ms
step:760/1000, tokens seen:99.48M, avg_train_loss:0.8848 time:66/16s step_avg:16ms
step:760/1000, tokens seen: 99.61M, val_loss:0.8886 train_time:11.71s step_avg:16ms
step:770/1000, tokens seen:100.79M, avg_train_loss:0.8963 time:67/16s step_avg:16ms
step:770/1000, tokens seen: 100.93M, val_loss:0.8869 train_time:11.86s step_avg:16ms
step:780/1000, tokens seen:102.11M, avg_train_loss:0.8899 time:67/16s step_avg:16ms
step:780/1000, tokens seen: 102.24M, val_loss:0.8845 train_time:12.01s step_avg:16ms
step:790/1000, tokens seen:103.42M, avg_train_loss:0.8844 time:68/16s step_avg:16ms
step:790/1000, tokens seen: 103.55M, val_loss:0.8830 train_time:12.16s step_avg:16ms
step:800/1000, tokens seen:104.73M, avg_train_loss:0.8706 time:68/16s step_avg:16ms
step:800/1000, tokens seen: 104.86M, val_loss:0.8801 train_time:12.31s step_avg:16ms
step:810/1000, tokens seen:106.04M, avg_train_loss:0.8718 time:68/16s step_avg:16ms
step:810/1000, tokens seen: 106.17M, val_loss:0.8767 train_time:12.46s step_avg:16ms
step:820/1000, tokens seen:107.35M, avg_train_loss:0.8785 time:69/16s step_avg:16ms
step:820/1000, tokens seen: 107.48M, val_loss:0.8745 train_time:12.62s step_avg:16ms
step:830/1000, tokens seen:108.66M, avg_train_loss:0.8712 time:69/16s step_avg:16ms
step:830/1000, tokens seen: 108.79M, val_loss:0.8730 train_time:12.77s step_avg:16ms
step:840/1000, tokens seen:109.97M, avg_train_loss:0.8783 time:69/16s step_avg:16ms
step:840/1000, tokens seen: 110.10M, val_loss:0.8714 train_time:12.92s step_avg:16ms
step:850/1000, tokens seen:111.28M, avg_train_loss:0.8718 time:70/16s step_avg:16ms
step:850/1000, tokens seen: 111.41M, val_loss:0.8685 train_time:13.09s step_avg:16ms
step:860/1000, tokens seen:112.59M, avg_train_loss:0.8666 time:70/16s step_avg:16ms
step:860/1000, tokens seen: 112.72M, val_loss:0.8662 train_time:13.23s step_avg:16ms
step:870/1000, tokens seen:113.90M, avg_train_loss:0.8657 time:71/16s step_avg:16ms
step:870/1000, tokens seen: 114.03M, val_loss:0.8653 train_time:13.40s step_avg:16ms
step:880/1000, tokens seen:115.21M, avg_train_loss:0.8625 time:71/16s step_avg:16ms
step:880/1000, tokens seen: 115.34M, val_loss:0.8626 train_time:13.55s step_avg:16ms
step:890/1000, tokens seen:116.52M, avg_train_loss:0.8628 time:71/16s step_avg:16ms
step:890/1000, tokens seen: 116.65M, val_loss:0.8609 train_time:13.70s step_avg:16ms
step:900/1000, tokens seen:117.83M, avg_train_loss:0.8581 time:72/16s step_avg:16ms
step:900/1000, tokens seen: 117.96M, val_loss:0.8605 train_time:13.85s step_avg:16ms
step:910/1000, tokens seen:119.14M, avg_train_loss:0.8604 time:72/16s step_avg:16ms
step:910/1000, tokens seen: 119.28M, val_loss:0.8578 train_time:14.01s step_avg:16ms
step:920/1000, tokens seen:120.46M, avg_train_loss:0.8613 time:73/16s step_avg:16ms
step:920/1000, tokens seen: 120.59M, val_loss:0.8563 train_time:14.17s step_avg:16ms
step:930/1000, tokens seen:121.77M, avg_train_loss:0.8566 time:73/16s step_avg:16ms
step:930/1000, tokens seen: 121.90M, val_loss:0.8552 train_time:14.32s step_avg:16ms
step:940/1000, tokens seen:123.08M, avg_train_loss:0.8604 time:73/16s step_avg:16ms
step:940/1000, tokens seen: 123.21M, val_loss:0.8526 train_time:14.49s step_avg:16ms
step:950/1000, tokens seen:124.39M, avg_train_loss:0.8550 time:74/16s step_avg:16ms
step:950/1000, tokens seen: 124.52M, val_loss:0.8512 train_time:14.64s step_avg:16ms
step:960/1000, tokens seen:125.70M, avg_train_loss:0.8463 time:74/16s step_avg:16ms
step:960/1000, tokens seen: 125.83M, val_loss:0.8496 train_time:14.79s step_avg:16ms
step:970/1000, tokens seen:127.01M, avg_train_loss:0.8471 time:75/16s step_avg:16ms
step:970/1000, tokens seen: 127.14M, val_loss:0.8488 train_time:14.94s step_avg:16ms
step:980/1000, tokens seen:128.32M, avg_train_loss:0.8479 time:75/16s step_avg:16ms
step:980/1000, tokens seen: 128.45M, val_loss:0.8478 train_time:15.09s step_avg:16ms
step:990/1000, tokens seen:129.63M, avg_train_loss:0.8491 time:75/16s step_avg:16ms
step:990/1000, tokens seen: 129.76M, val_loss:0.8465 train_time:15.24s step_avg:16ms
step:1000/1000, tokens seen:130.94M, avg_train_loss:0.8473 time:76/16s step_avg:16ms
step:1000/1000, tokens seen: 131.07M, val_loss:0.8447 train_time:15.39s step_avg:16ms
Total training time: 75.99s
peak memory consumption: 1147 MiB
