W0216 07:16:13.154575 140647434610496 torch/distributed/run.py:779] 
W0216 07:16:13.154575 140647434610496 torch/distributed/run.py:779] *****************************************
W0216 07:16:13.154575 140647434610496 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 07:16:13.154575 140647434610496 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 0] Training DataLoader: 187975984 tokens across 1 files.
[Rank 0] Validation DataLoader: 1909027 tokens across 1 files.
[Rank 1] Using device: cuda:1
[Rank 0] Model wrapped in DDP.
k params lengths: head = 1, attn = 6
Tokenizer vocab size: 122
attn.k is learned

=== Report ===
Model Size:    310.55K

Data Path:            data/tinystories_char
Sequence Length:      1024
Batch Size (global):  128
Batch Size (device):  64
n_layers:              6
n_heads:               4
head_dim:             16
n_embd:               64
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/26183_tsc_hh_k1.0_lr1e+01_s0/
Writing logs to: runs/02.16/26183_tsc_hh_k1.0_lr1e+01_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:4.8923 train_time:0.19s step_avg:nanms
step:10/1000, tokens seen:1.18M, avg_train_loss:3.3555 time:43/nans step_avg:nanms
step:10/1000, tokens seen: 1.31M, val_loss:2.6016 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:2.49M, avg_train_loss:nan time:53/221s step_avg:221ms
step:20/1000, tokens seen: 2.62M, val_loss:nan train_time:2.21s step_avg:221ms
step:30/1000, tokens seen:3.80M, avg_train_loss:nan time:64/220s step_avg:220ms
step:30/1000, tokens seen: 3.93M, val_loss:nan train_time:4.39s step_avg:220ms
step:40/1000, tokens seen:5.11M, avg_train_loss:nan time:74/219s step_avg:219ms
step:40/1000, tokens seen: 5.24M, val_loss:nan train_time:6.58s step_avg:219ms
step:50/1000, tokens seen:6.42M, avg_train_loss:nan time:84/219s step_avg:219ms
step:50/1000, tokens seen: 6.55M, val_loss:nan train_time:8.76s step_avg:219ms
step:60/1000, tokens seen:7.73M, avg_train_loss:nan time:94/219s step_avg:219ms
step:60/1000, tokens seen: 7.86M, val_loss:nan train_time:10.94s step_avg:219ms
step:70/1000, tokens seen:9.04M, avg_train_loss:nan time:105/219s step_avg:219ms
step:70/1000, tokens seen: 9.18M, val_loss:nan train_time:13.12s step_avg:219ms
step:80/1000, tokens seen:10.35M, avg_train_loss:nan time:115/219s step_avg:219ms
step:80/1000, tokens seen: 10.49M, val_loss:nan train_time:15.31s step_avg:219ms
step:90/1000, tokens seen:11.67M, avg_train_loss:nan time:125/219s step_avg:219ms
step:90/1000, tokens seen: 11.80M, val_loss:nan train_time:17.50s step_avg:219ms
step:100/1000, tokens seen:12.98M, avg_train_loss:nan time:136/219s step_avg:219ms
step:100/1000, tokens seen: 13.11M, val_loss:nan train_time:19.70s step_avg:219ms
step:110/1000, tokens seen:14.29M, avg_train_loss:nan time:146/219s step_avg:219ms
step:110/1000, tokens seen: 14.42M, val_loss:nan train_time:21.88s step_avg:219ms
step:120/1000, tokens seen:15.60M, avg_train_loss:nan time:156/219s step_avg:219ms
step:120/1000, tokens seen: 15.73M, val_loss:nan train_time:24.07s step_avg:219ms
step:130/1000, tokens seen:16.91M, avg_train_loss:nan time:166/219s step_avg:219ms
step:130/1000, tokens seen: 17.04M, val_loss:nan train_time:26.25s step_avg:219ms
step:140/1000, tokens seen:18.22M, avg_train_loss:nan time:177/219s step_avg:219ms
step:140/1000, tokens seen: 18.35M, val_loss:nan train_time:28.43s step_avg:219ms
step:150/1000, tokens seen:19.53M, avg_train_loss:nan time:187/219s step_avg:219ms
step:150/1000, tokens seen: 19.66M, val_loss:nan train_time:30.61s step_avg:219ms
step:160/1000, tokens seen:20.84M, avg_train_loss:nan time:197/219s step_avg:219ms
step:160/1000, tokens seen: 20.97M, val_loss:nan train_time:32.79s step_avg:219ms
step:170/1000, tokens seen:22.15M, avg_train_loss:nan time:207/219s step_avg:219ms
step:170/1000, tokens seen: 22.28M, val_loss:nan train_time:34.98s step_avg:219ms
step:180/1000, tokens seen:23.46M, avg_train_loss:nan time:218/219s step_avg:219ms
step:180/1000, tokens seen: 23.59M, val_loss:nan train_time:37.16s step_avg:219ms
step:190/1000, tokens seen:24.77M, avg_train_loss:nan time:228/219s step_avg:219ms
step:190/1000, tokens seen: 24.90M, val_loss:nan train_time:39.34s step_avg:219ms
step:200/1000, tokens seen:26.08M, avg_train_loss:nan time:238/219s step_avg:219ms
step:200/1000, tokens seen: 26.21M, val_loss:nan train_time:41.52s step_avg:219ms
step:210/1000, tokens seen:27.39M, avg_train_loss:nan time:249/219s step_avg:219ms
step:210/1000, tokens seen: 27.53M, val_loss:nan train_time:43.71s step_avg:219ms
step:220/1000, tokens seen:28.70M, avg_train_loss:nan time:259/219s step_avg:219ms
step:220/1000, tokens seen: 28.84M, val_loss:nan train_time:45.89s step_avg:219ms
step:230/1000, tokens seen:30.02M, avg_train_loss:nan time:269/218s step_avg:218ms
step:230/1000, tokens seen: 30.15M, val_loss:nan train_time:48.07s step_avg:218ms
step:240/1000, tokens seen:31.33M, avg_train_loss:nan time:279/218s step_avg:218ms
step:240/1000, tokens seen: 31.46M, val_loss:nan train_time:50.25s step_avg:218ms
step:250/1000, tokens seen:32.64M, avg_train_loss:nan time:290/218s step_avg:218ms
step:250/1000, tokens seen: 32.77M, val_loss:nan train_time:52.43s step_avg:218ms
step:260/1000, tokens seen:33.95M, avg_train_loss:nan time:300/218s step_avg:218ms
step:260/1000, tokens seen: 34.08M, val_loss:nan train_time:54.61s step_avg:218ms
step:270/1000, tokens seen:35.26M, avg_train_loss:nan time:310/218s step_avg:218ms
step:270/1000, tokens seen: 35.39M, val_loss:nan train_time:56.79s step_avg:218ms
step:280/1000, tokens seen:36.57M, avg_train_loss:nan time:320/218s step_avg:218ms
step:280/1000, tokens seen: 36.70M, val_loss:nan train_time:58.97s step_avg:218ms
step:290/1000, tokens seen:37.88M, avg_train_loss:nan time:331/218s step_avg:218ms
step:290/1000, tokens seen: 38.01M, val_loss:nan train_time:61.15s step_avg:218ms
step:300/1000, tokens seen:39.19M, avg_train_loss:nan time:341/218s step_avg:218ms
step:300/1000, tokens seen: 39.32M, val_loss:nan train_time:63.34s step_avg:218ms
step:310/1000, tokens seen:40.50M, avg_train_loss:nan time:351/218s step_avg:218ms
step:310/1000, tokens seen: 40.63M, val_loss:nan train_time:65.52s step_avg:218ms
step:320/1000, tokens seen:41.81M, avg_train_loss:nan time:362/218s step_avg:218ms
step:320/1000, tokens seen: 41.94M, val_loss:nan train_time:67.70s step_avg:218ms
step:330/1000, tokens seen:43.12M, avg_train_loss:nan time:372/218s step_avg:218ms
step:330/1000, tokens seen: 43.25M, val_loss:nan train_time:69.88s step_avg:218ms
step:340/1000, tokens seen:44.43M, avg_train_loss:nan time:382/218s step_avg:218ms
step:340/1000, tokens seen: 44.56M, val_loss:nan train_time:72.06s step_avg:218ms
step:350/1000, tokens seen:45.74M, avg_train_loss:nan time:392/218s step_avg:218ms
step:350/1000, tokens seen: 45.88M, val_loss:nan train_time:74.24s step_avg:218ms
step:360/1000, tokens seen:47.05M, avg_train_loss:nan time:403/218s step_avg:218ms
step:360/1000, tokens seen: 47.19M, val_loss:nan train_time:76.42s step_avg:218ms
step:370/1000, tokens seen:48.37M, avg_train_loss:nan time:413/218s step_avg:218ms
step:370/1000, tokens seen: 48.50M, val_loss:nan train_time:78.60s step_avg:218ms
step:380/1000, tokens seen:49.68M, avg_train_loss:nan time:423/218s step_avg:218ms
step:380/1000, tokens seen: 49.81M, val_loss:nan train_time:80.78s step_avg:218ms
step:390/1000, tokens seen:50.99M, avg_train_loss:nan time:433/218s step_avg:218ms
step:390/1000, tokens seen: 51.12M, val_loss:nan train_time:82.96s step_avg:218ms
step:400/1000, tokens seen:52.30M, avg_train_loss:nan time:444/218s step_avg:218ms
step:400/1000, tokens seen: 52.43M, val_loss:nan train_time:85.14s step_avg:218ms
step:410/1000, tokens seen:53.61M, avg_train_loss:nan time:454/218s step_avg:218ms
step:410/1000, tokens seen: 53.74M, val_loss:nan train_time:87.32s step_avg:218ms
step:420/1000, tokens seen:54.92M, avg_train_loss:nan time:464/218s step_avg:218ms
step:420/1000, tokens seen: 55.05M, val_loss:nan train_time:89.51s step_avg:218ms
step:430/1000, tokens seen:56.23M, avg_train_loss:nan time:474/218s step_avg:218ms
step:430/1000, tokens seen: 56.36M, val_loss:nan train_time:91.69s step_avg:218ms
step:440/1000, tokens seen:57.54M, avg_train_loss:nan time:485/218s step_avg:218ms
step:440/1000, tokens seen: 57.67M, val_loss:nan train_time:93.87s step_avg:218ms
step:450/1000, tokens seen:58.85M, avg_train_loss:nan time:495/218s step_avg:218ms
step:450/1000, tokens seen: 58.98M, val_loss:nan train_time:96.05s step_avg:218ms
step:460/1000, tokens seen:60.16M, avg_train_loss:nan time:505/218s step_avg:218ms
step:460/1000, tokens seen: 60.29M, val_loss:nan train_time:98.23s step_avg:218ms
step:470/1000, tokens seen:61.47M, avg_train_loss:nan time:516/218s step_avg:218ms
step:470/1000, tokens seen: 61.60M, val_loss:nan train_time:100.41s step_avg:218ms
step:480/1000, tokens seen:62.78M, avg_train_loss:nan time:526/218s step_avg:218ms
step:480/1000, tokens seen: 62.91M, val_loss:nan train_time:102.59s step_avg:218ms
step:490/1000, tokens seen:64.09M, avg_train_loss:nan time:536/218s step_avg:218ms
step:490/1000, tokens seen: 64.23M, val_loss:nan train_time:104.77s step_avg:218ms
step:500/1000, tokens seen:65.40M, avg_train_loss:nan time:546/218s step_avg:218ms
step:500/1000, tokens seen: 65.54M, val_loss:nan train_time:106.95s step_avg:218ms
step:510/1000, tokens seen:66.72M, avg_train_loss:nan time:557/218s step_avg:218ms
step:510/1000, tokens seen: 66.85M, val_loss:nan train_time:109.13s step_avg:218ms
step:520/1000, tokens seen:68.03M, avg_train_loss:nan time:567/218s step_avg:218ms
step:520/1000, tokens seen: 68.16M, val_loss:nan train_time:111.32s step_avg:218ms
step:530/1000, tokens seen:69.34M, avg_train_loss:nan time:577/218s step_avg:218ms
step:530/1000, tokens seen: 69.47M, val_loss:nan train_time:113.50s step_avg:218ms
step:540/1000, tokens seen:70.65M, avg_train_loss:nan time:587/218s step_avg:218ms
step:540/1000, tokens seen: 70.78M, val_loss:nan train_time:115.68s step_avg:218ms
step:550/1000, tokens seen:71.96M, avg_train_loss:nan time:598/218s step_avg:218ms
step:550/1000, tokens seen: 72.09M, val_loss:nan train_time:117.86s step_avg:218ms
step:560/1000, tokens seen:73.27M, avg_train_loss:nan time:608/218s step_avg:218ms
step:560/1000, tokens seen: 73.40M, val_loss:nan train_time:120.05s step_avg:218ms
step:570/1000, tokens seen:74.58M, avg_train_loss:nan time:618/218s step_avg:218ms
step:570/1000, tokens seen: 74.71M, val_loss:nan train_time:122.23s step_avg:218ms
step:580/1000, tokens seen:75.89M, avg_train_loss:nan time:629/218s step_avg:218ms
step:580/1000, tokens seen: 76.02M, val_loss:nan train_time:124.41s step_avg:218ms
step:590/1000, tokens seen:77.20M, avg_train_loss:nan time:639/218s step_avg:218ms
step:590/1000, tokens seen: 77.33M, val_loss:nan train_time:126.60s step_avg:218ms
step:600/1000, tokens seen:78.51M, avg_train_loss:nan time:649/218s step_avg:218ms
step:600/1000, tokens seen: 78.64M, val_loss:nan train_time:128.78s step_avg:218ms
step:610/1000, tokens seen:79.82M, avg_train_loss:nan time:659/218s step_avg:218ms
step:610/1000, tokens seen: 79.95M, val_loss:nan train_time:130.96s step_avg:218ms
step:620/1000, tokens seen:81.13M, avg_train_loss:nan time:670/218s step_avg:218ms
step:620/1000, tokens seen: 81.26M, val_loss:nan train_time:133.14s step_avg:218ms
step:630/1000, tokens seen:82.44M, avg_train_loss:nan time:680/218s step_avg:218ms
step:630/1000, tokens seen: 82.58M, val_loss:nan train_time:135.32s step_avg:218ms
step:640/1000, tokens seen:83.76M, avg_train_loss:nan time:690/218s step_avg:218ms
step:640/1000, tokens seen: 83.89M, val_loss:nan train_time:137.50s step_avg:218ms
step:650/1000, tokens seen:85.07M, avg_train_loss:nan time:700/218s step_avg:218ms
step:650/1000, tokens seen: 85.20M, val_loss:nan train_time:139.68s step_avg:218ms
step:660/1000, tokens seen:86.38M, avg_train_loss:nan time:711/218s step_avg:218ms
step:660/1000, tokens seen: 86.51M, val_loss:nan train_time:141.88s step_avg:218ms
step:670/1000, tokens seen:87.69M, avg_train_loss:nan time:721/218s step_avg:218ms
step:670/1000, tokens seen: 87.82M, val_loss:nan train_time:144.06s step_avg:218ms
step:680/1000, tokens seen:89.00M, avg_train_loss:nan time:731/218s step_avg:218ms
step:680/1000, tokens seen: 89.13M, val_loss:nan train_time:146.25s step_avg:218ms
step:690/1000, tokens seen:90.31M, avg_train_loss:nan time:742/218s step_avg:218ms
step:690/1000, tokens seen: 90.44M, val_loss:nan train_time:148.43s step_avg:218ms
step:700/1000, tokens seen:91.62M, avg_train_loss:nan time:752/218s step_avg:218ms
step:700/1000, tokens seen: 91.75M, val_loss:nan train_time:150.61s step_avg:218ms
step:710/1000, tokens seen:92.93M, avg_train_loss:nan time:762/218s step_avg:218ms
step:710/1000, tokens seen: 93.06M, val_loss:nan train_time:152.79s step_avg:218ms
step:720/1000, tokens seen:94.24M, avg_train_loss:nan time:772/218s step_avg:218ms
step:720/1000, tokens seen: 94.37M, val_loss:nan train_time:154.97s step_avg:218ms
step:730/1000, tokens seen:95.55M, avg_train_loss:nan time:783/218s step_avg:218ms
step:730/1000, tokens seen: 95.68M, val_loss:nan train_time:157.15s step_avg:218ms
step:740/1000, tokens seen:96.86M, avg_train_loss:nan time:793/218s step_avg:218ms
step:740/1000, tokens seen: 96.99M, val_loss:nan train_time:159.33s step_avg:218ms
step:750/1000, tokens seen:98.17M, avg_train_loss:nan time:803/218s step_avg:218ms
step:750/1000, tokens seen: 98.30M, val_loss:nan train_time:161.51s step_avg:218ms
step:760/1000, tokens seen:99.48M, avg_train_loss:nan time:814/218s step_avg:218ms
step:760/1000, tokens seen: 99.61M, val_loss:nan train_time:163.69s step_avg:218ms
step:770/1000, tokens seen:100.79M, avg_train_loss:nan time:824/218s step_avg:218ms
step:770/1000, tokens seen: 100.93M, val_loss:nan train_time:165.87s step_avg:218ms
step:780/1000, tokens seen:102.11M, avg_train_loss:nan time:834/218s step_avg:218ms
step:780/1000, tokens seen: 102.24M, val_loss:nan train_time:168.05s step_avg:218ms
step:790/1000, tokens seen:103.42M, avg_train_loss:nan time:844/218s step_avg:218ms
step:790/1000, tokens seen: 103.55M, val_loss:nan train_time:170.23s step_avg:218ms
step:800/1000, tokens seen:104.73M, avg_train_loss:nan time:855/218s step_avg:218ms
step:800/1000, tokens seen: 104.86M, val_loss:nan train_time:172.41s step_avg:218ms
step:810/1000, tokens seen:106.04M, avg_train_loss:nan time:865/218s step_avg:218ms
step:810/1000, tokens seen: 106.17M, val_loss:nan train_time:174.60s step_avg:218ms
step:820/1000, tokens seen:107.35M, avg_train_loss:nan time:875/218s step_avg:218ms
step:820/1000, tokens seen: 107.48M, val_loss:nan train_time:176.78s step_avg:218ms
step:830/1000, tokens seen:108.66M, avg_train_loss:nan time:885/218s step_avg:218ms
step:830/1000, tokens seen: 108.79M, val_loss:nan train_time:178.96s step_avg:218ms
step:840/1000, tokens seen:109.97M, avg_train_loss:nan time:896/218s step_avg:218ms
step:840/1000, tokens seen: 110.10M, val_loss:nan train_time:181.14s step_avg:218ms
step:850/1000, tokens seen:111.28M, avg_train_loss:nan time:906/218s step_avg:218ms
step:850/1000, tokens seen: 111.41M, val_loss:nan train_time:183.32s step_avg:218ms
step:860/1000, tokens seen:112.59M, avg_train_loss:nan time:916/218s step_avg:218ms
step:860/1000, tokens seen: 112.72M, val_loss:nan train_time:185.50s step_avg:218ms
step:870/1000, tokens seen:113.90M, avg_train_loss:nan time:926/218s step_avg:218ms
step:870/1000, tokens seen: 114.03M, val_loss:nan train_time:187.68s step_avg:218ms
step:880/1000, tokens seen:115.21M, avg_train_loss:nan time:937/218s step_avg:218ms
step:880/1000, tokens seen: 115.34M, val_loss:nan train_time:189.86s step_avg:218ms
step:890/1000, tokens seen:116.52M, avg_train_loss:nan time:947/218s step_avg:218ms
step:890/1000, tokens seen: 116.65M, val_loss:nan train_time:192.04s step_avg:218ms
step:900/1000, tokens seen:117.83M, avg_train_loss:nan time:957/218s step_avg:218ms
step:900/1000, tokens seen: 117.96M, val_loss:nan train_time:194.22s step_avg:218ms
step:910/1000, tokens seen:119.14M, avg_train_loss:nan time:968/218s step_avg:218ms
step:910/1000, tokens seen: 119.28M, val_loss:nan train_time:196.41s step_avg:218ms
step:920/1000, tokens seen:120.46M, avg_train_loss:nan time:978/218s step_avg:218ms
step:920/1000, tokens seen: 120.59M, val_loss:nan train_time:198.59s step_avg:218ms
step:930/1000, tokens seen:121.77M, avg_train_loss:nan time:988/218s step_avg:218ms
step:930/1000, tokens seen: 121.90M, val_loss:nan train_time:200.77s step_avg:218ms
step:940/1000, tokens seen:123.08M, avg_train_loss:nan time:998/218s step_avg:218ms
step:940/1000, tokens seen: 123.21M, val_loss:nan train_time:202.95s step_avg:218ms
step:950/1000, tokens seen:124.39M, avg_train_loss:nan time:1009/218s step_avg:218ms
step:950/1000, tokens seen: 124.52M, val_loss:nan train_time:205.13s step_avg:218ms
step:960/1000, tokens seen:125.70M, avg_train_loss:nan time:1019/218s step_avg:218ms
step:960/1000, tokens seen: 125.83M, val_loss:nan train_time:207.31s step_avg:218ms
step:970/1000, tokens seen:127.01M, avg_train_loss:nan time:1029/218s step_avg:218ms
step:970/1000, tokens seen: 127.14M, val_loss:nan train_time:209.49s step_avg:218ms
step:980/1000, tokens seen:128.32M, avg_train_loss:nan time:1039/218s step_avg:218ms
step:980/1000, tokens seen: 128.45M, val_loss:nan train_time:211.67s step_avg:218ms
step:990/1000, tokens seen:129.63M, avg_train_loss:nan time:1050/218s step_avg:218ms
step:990/1000, tokens seen: 129.76M, val_loss:nan train_time:213.86s step_avg:218ms
step:1000/1000, tokens seen:130.94M, avg_train_loss:nan time:1060/218s step_avg:218ms
step:1000/1000, tokens seen: 131.07M, val_loss:nan train_time:216.04s step_avg:218ms
Total training time: 1068.09s
peak memory consumption: 21820 MiB
