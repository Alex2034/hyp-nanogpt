W0216 01:27:53.014457 140658065614656 torch/distributed/run.py:779] 
W0216 01:27:53.014457 140658065614656 torch/distributed/run.py:779] *****************************************
W0216 01:27:53.014457 140658065614656 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 01:27:53.014457 140658065614656 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 0] Training DataLoader: 187975984 tokens across 1 files.
[Rank 0] Validation DataLoader: 1909027 tokens across 1 files.
[Rank 1] Using device: cuda:1
[Rank 0] Model wrapped in DDP.
k params lengths: head = 1, attn = 0
Tokenizer vocab size: 122
head.k is learned with 10.0 lr

=== Report ===
Model Size:    310.53K

Data Path:            data/tinystories_char
Sequence Length:      1024
Batch Size (global):  128
Batch Size (device):  64
n_layers:              6
n_heads:               4
head_dim:             16
n_embd:               64
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/5283_tsc_he_k1.0_lr1e+01_s0/
Writing logs to: runs/02.16/5283_tsc_he_k1.0_lr1e+01_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:4.8834 train_time:0.19s step_avg:nanms
step:10/1000, tokens seen:1.18M, avg_train_loss:3.3640 time:44/nans step_avg:nanms
step:10/1000, tokens seen: 1.31M, val_loss:2.5762 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:2.49M, avg_train_loss:2.4763 time:45/16s step_avg:16ms
step:20/1000, tokens seen: 2.62M, val_loss:2.4048 train_time:0.16s step_avg:16ms
step:30/1000, tokens seen:3.80M, avg_train_loss:2.3779 time:45/16s step_avg:16ms
step:30/1000, tokens seen: 3.93M, val_loss:2.3446 train_time:0.31s step_avg:16ms
step:40/1000, tokens seen:5.11M, avg_train_loss:2.3285 time:46/16s step_avg:16ms
step:40/1000, tokens seen: 5.24M, val_loss:2.2971 train_time:0.47s step_avg:16ms
step:50/1000, tokens seen:6.42M, avg_train_loss:2.2655 time:46/16s step_avg:16ms
step:50/1000, tokens seen: 6.55M, val_loss:2.2069 train_time:0.62s step_avg:16ms
step:60/1000, tokens seen:7.73M, avg_train_loss:2.1827 time:46/16s step_avg:16ms
step:60/1000, tokens seen: 7.86M, val_loss:2.1491 train_time:0.78s step_avg:16ms
step:70/1000, tokens seen:9.04M, avg_train_loss:2.1133 time:47/16s step_avg:16ms
step:70/1000, tokens seen: 9.18M, val_loss:2.0764 train_time:0.93s step_avg:16ms
step:80/1000, tokens seen:10.35M, avg_train_loss:2.0325 time:47/16s step_avg:16ms
step:80/1000, tokens seen: 10.49M, val_loss:1.9921 train_time:1.09s step_avg:16ms
step:90/1000, tokens seen:11.67M, avg_train_loss:1.9731 time:48/16s step_avg:16ms
step:90/1000, tokens seen: 11.80M, val_loss:1.9175 train_time:1.25s step_avg:16ms
step:100/1000, tokens seen:12.98M, avg_train_loss:1.8868 time:48/16s step_avg:16ms
step:100/1000, tokens seen: 13.11M, val_loss:1.8352 train_time:1.40s step_avg:16ms
step:110/1000, tokens seen:14.29M, avg_train_loss:1.8232 time:48/16s step_avg:16ms
step:110/1000, tokens seen: 14.42M, val_loss:1.7921 train_time:1.56s step_avg:16ms
step:120/1000, tokens seen:15.60M, avg_train_loss:1.7563 time:49/16s step_avg:16ms
step:120/1000, tokens seen: 15.73M, val_loss:1.7222 train_time:1.71s step_avg:16ms
step:130/1000, tokens seen:16.91M, avg_train_loss:1.6907 time:49/16s step_avg:16ms
step:130/1000, tokens seen: 17.04M, val_loss:1.6591 train_time:1.87s step_avg:16ms
step:140/1000, tokens seen:18.22M, avg_train_loss:1.6239 time:49/16s step_avg:16ms
step:140/1000, tokens seen: 18.35M, val_loss:1.6095 train_time:2.02s step_avg:16ms
step:150/1000, tokens seen:19.53M, avg_train_loss:1.5708 time:50/16s step_avg:16ms
step:150/1000, tokens seen: 19.66M, val_loss:1.5368 train_time:2.18s step_avg:16ms
step:160/1000, tokens seen:20.84M, avg_train_loss:1.5204 time:50/16s step_avg:16ms
step:160/1000, tokens seen: 20.97M, val_loss:1.4907 train_time:2.34s step_avg:16ms
step:170/1000, tokens seen:22.15M, avg_train_loss:1.4713 time:51/16s step_avg:16ms
step:170/1000, tokens seen: 22.28M, val_loss:1.4381 train_time:2.50s step_avg:16ms
step:180/1000, tokens seen:23.46M, avg_train_loss:1.4261 time:51/16s step_avg:16ms
step:180/1000, tokens seen: 23.59M, val_loss:1.4036 train_time:2.65s step_avg:16ms
step:190/1000, tokens seen:24.77M, avg_train_loss:1.3969 time:51/16s step_avg:16ms
step:190/1000, tokens seen: 24.90M, val_loss:1.3863 train_time:2.81s step_avg:16ms
step:200/1000, tokens seen:26.08M, avg_train_loss:1.3597 time:52/16s step_avg:16ms
step:200/1000, tokens seen: 26.21M, val_loss:1.3387 train_time:2.96s step_avg:16ms
step:210/1000, tokens seen:27.39M, avg_train_loss:1.3218 time:52/16s step_avg:16ms
step:210/1000, tokens seen: 27.53M, val_loss:1.3064 train_time:3.11s step_avg:16ms
step:220/1000, tokens seen:28.70M, avg_train_loss:1.2887 time:53/16s step_avg:16ms
step:220/1000, tokens seen: 28.84M, val_loss:1.2869 train_time:3.27s step_avg:16ms
step:230/1000, tokens seen:30.02M, avg_train_loss:1.2739 time:53/16s step_avg:16ms
step:230/1000, tokens seen: 30.15M, val_loss:1.2513 train_time:3.42s step_avg:16ms
step:240/1000, tokens seen:31.33M, avg_train_loss:1.2541 time:53/16s step_avg:16ms
step:240/1000, tokens seen: 31.46M, val_loss:1.2369 train_time:3.58s step_avg:16ms
step:250/1000, tokens seen:32.64M, avg_train_loss:1.2278 time:54/16s step_avg:16ms
step:250/1000, tokens seen: 32.77M, val_loss:1.2166 train_time:3.73s step_avg:16ms
step:260/1000, tokens seen:33.95M, avg_train_loss:1.2104 time:54/16s step_avg:16ms
step:260/1000, tokens seen: 34.08M, val_loss:1.2124 train_time:3.89s step_avg:16ms
step:270/1000, tokens seen:35.26M, avg_train_loss:1.1890 time:55/16s step_avg:16ms
step:270/1000, tokens seen: 35.39M, val_loss:1.1764 train_time:4.04s step_avg:16ms
step:280/1000, tokens seen:36.57M, avg_train_loss:1.1766 time:55/16s step_avg:16ms
step:280/1000, tokens seen: 36.70M, val_loss:1.1687 train_time:4.20s step_avg:16ms
step:290/1000, tokens seen:37.88M, avg_train_loss:1.1516 time:55/16s step_avg:16ms
step:290/1000, tokens seen: 38.01M, val_loss:1.1441 train_time:4.35s step_avg:16ms
step:300/1000, tokens seen:39.19M, avg_train_loss:1.1396 time:56/16s step_avg:16ms
step:300/1000, tokens seen: 39.32M, val_loss:1.1330 train_time:4.50s step_avg:16ms
step:310/1000, tokens seen:40.50M, avg_train_loss:1.1280 time:56/16s step_avg:16ms
step:310/1000, tokens seen: 40.63M, val_loss:1.1179 train_time:4.66s step_avg:16ms
step:320/1000, tokens seen:41.81M, avg_train_loss:1.1112 time:56/16s step_avg:16ms
step:320/1000, tokens seen: 41.94M, val_loss:1.1064 train_time:4.81s step_avg:16ms
step:330/1000, tokens seen:43.12M, avg_train_loss:1.1057 time:57/16s step_avg:16ms
step:330/1000, tokens seen: 43.25M, val_loss:1.0929 train_time:4.97s step_avg:16ms
step:340/1000, tokens seen:44.43M, avg_train_loss:1.0972 time:57/16s step_avg:16ms
step:340/1000, tokens seen: 44.56M, val_loss:1.0877 train_time:5.12s step_avg:16ms
step:350/1000, tokens seen:45.74M, avg_train_loss:1.0881 time:58/16s step_avg:16ms
step:350/1000, tokens seen: 45.88M, val_loss:1.0739 train_time:5.28s step_avg:16ms
step:360/1000, tokens seen:47.05M, avg_train_loss:1.0752 time:58/16s step_avg:16ms
step:360/1000, tokens seen: 47.19M, val_loss:1.0660 train_time:5.45s step_avg:16ms
step:370/1000, tokens seen:48.37M, avg_train_loss:1.0678 time:58/16s step_avg:16ms
step:370/1000, tokens seen: 48.50M, val_loss:1.0545 train_time:5.60s step_avg:16ms
step:380/1000, tokens seen:49.68M, avg_train_loss:1.0539 time:59/16s step_avg:16ms
step:380/1000, tokens seen: 49.81M, val_loss:1.0532 train_time:5.76s step_avg:16ms
step:390/1000, tokens seen:50.99M, avg_train_loss:1.0461 time:59/16s step_avg:16ms
step:390/1000, tokens seen: 51.12M, val_loss:1.0401 train_time:5.92s step_avg:16ms
step:400/1000, tokens seen:52.30M, avg_train_loss:1.0371 time:60/16s step_avg:16ms
step:400/1000, tokens seen: 52.43M, val_loss:1.0336 train_time:6.07s step_avg:16ms
step:410/1000, tokens seen:53.61M, avg_train_loss:1.0313 time:60/16s step_avg:16ms
step:410/1000, tokens seen: 53.74M, val_loss:1.0268 train_time:6.23s step_avg:16ms
step:420/1000, tokens seen:54.92M, avg_train_loss:1.0356 time:60/16s step_avg:16ms
step:420/1000, tokens seen: 55.05M, val_loss:1.0239 train_time:6.38s step_avg:16ms
step:430/1000, tokens seen:56.23M, avg_train_loss:1.0243 time:61/16s step_avg:16ms
step:430/1000, tokens seen: 56.36M, val_loss:1.0120 train_time:6.56s step_avg:16ms
step:440/1000, tokens seen:57.54M, avg_train_loss:1.0169 time:61/16s step_avg:16ms
step:440/1000, tokens seen: 57.67M, val_loss:1.0122 train_time:6.73s step_avg:16ms
step:450/1000, tokens seen:58.85M, avg_train_loss:1.0100 time:62/16s step_avg:16ms
step:450/1000, tokens seen: 58.98M, val_loss:1.0011 train_time:6.88s step_avg:16ms
step:460/1000, tokens seen:60.16M, avg_train_loss:1.0061 time:62/16s step_avg:16ms
step:460/1000, tokens seen: 60.29M, val_loss:1.0000 train_time:7.05s step_avg:16ms
step:470/1000, tokens seen:61.47M, avg_train_loss:0.9989 time:62/16s step_avg:16ms
step:470/1000, tokens seen: 61.60M, val_loss:0.9927 train_time:7.22s step_avg:16ms
step:480/1000, tokens seen:62.78M, avg_train_loss:0.9966 time:63/16s step_avg:16ms
step:480/1000, tokens seen: 62.91M, val_loss:0.9935 train_time:7.38s step_avg:16ms
step:490/1000, tokens seen:64.09M, avg_train_loss:0.9890 time:63/16s step_avg:16ms
step:490/1000, tokens seen: 64.23M, val_loss:0.9846 train_time:7.53s step_avg:16ms
step:500/1000, tokens seen:65.40M, avg_train_loss:0.9728 time:64/16s step_avg:16ms
step:500/1000, tokens seen: 65.54M, val_loss:0.9767 train_time:7.68s step_avg:16ms
step:510/1000, tokens seen:66.72M, avg_train_loss:0.9839 time:64/16s step_avg:16ms
step:510/1000, tokens seen: 66.85M, val_loss:0.9758 train_time:7.84s step_avg:16ms
step:520/1000, tokens seen:68.03M, avg_train_loss:0.9635 time:64/16s step_avg:16ms
step:520/1000, tokens seen: 68.16M, val_loss:0.9693 train_time:7.99s step_avg:16ms
step:530/1000, tokens seen:69.34M, avg_train_loss:0.9675 time:65/16s step_avg:16ms
step:530/1000, tokens seen: 69.47M, val_loss:0.9645 train_time:8.15s step_avg:16ms
step:540/1000, tokens seen:70.65M, avg_train_loss:0.9718 time:65/16s step_avg:16ms
step:540/1000, tokens seen: 70.78M, val_loss:0.9607 train_time:8.30s step_avg:16ms
step:550/1000, tokens seen:71.96M, avg_train_loss:0.9566 time:65/16s step_avg:16ms
step:550/1000, tokens seen: 72.09M, val_loss:0.9553 train_time:8.46s step_avg:16ms
step:560/1000, tokens seen:73.27M, avg_train_loss:0.9525 time:66/16s step_avg:16ms
step:560/1000, tokens seen: 73.40M, val_loss:0.9543 train_time:8.61s step_avg:16ms
step:570/1000, tokens seen:74.58M, avg_train_loss:0.9582 time:66/16s step_avg:16ms
step:570/1000, tokens seen: 74.71M, val_loss:0.9535 train_time:8.76s step_avg:16ms
step:580/1000, tokens seen:75.89M, avg_train_loss:0.9557 time:67/16s step_avg:16ms
step:580/1000, tokens seen: 76.02M, val_loss:0.9510 train_time:8.92s step_avg:16ms
step:590/1000, tokens seen:77.20M, avg_train_loss:0.9472 time:67/16s step_avg:16ms
step:590/1000, tokens seen: 77.33M, val_loss:0.9466 train_time:9.07s step_avg:16ms
step:600/1000, tokens seen:78.51M, avg_train_loss:0.9423 time:67/16s step_avg:16ms
step:600/1000, tokens seen: 78.64M, val_loss:0.9421 train_time:9.22s step_avg:16ms
step:610/1000, tokens seen:79.82M, avg_train_loss:0.9421 time:68/16s step_avg:16ms
step:610/1000, tokens seen: 79.95M, val_loss:0.9403 train_time:9.38s step_avg:16ms
step:620/1000, tokens seen:81.13M, avg_train_loss:0.9333 time:68/16s step_avg:16ms
step:620/1000, tokens seen: 81.26M, val_loss:0.9334 train_time:9.53s step_avg:16ms
step:630/1000, tokens seen:82.44M, avg_train_loss:0.9377 time:69/16s step_avg:16ms
step:630/1000, tokens seen: 82.58M, val_loss:0.9267 train_time:9.69s step_avg:16ms
step:640/1000, tokens seen:83.76M, avg_train_loss:0.9343 time:69/16s step_avg:16ms
step:640/1000, tokens seen: 83.89M, val_loss:0.9248 train_time:9.84s step_avg:16ms
step:650/1000, tokens seen:85.07M, avg_train_loss:0.9203 time:69/16s step_avg:16ms
step:650/1000, tokens seen: 85.20M, val_loss:0.9206 train_time:10.00s step_avg:16ms
step:660/1000, tokens seen:86.38M, avg_train_loss:0.9195 time:70/16s step_avg:16ms
step:660/1000, tokens seen: 86.51M, val_loss:0.9188 train_time:10.15s step_avg:16ms
step:670/1000, tokens seen:87.69M, avg_train_loss:0.9167 time:70/16s step_avg:16ms
step:670/1000, tokens seen: 87.82M, val_loss:0.9135 train_time:10.30s step_avg:16ms
step:680/1000, tokens seen:89.00M, avg_train_loss:0.9091 time:71/16s step_avg:16ms
step:680/1000, tokens seen: 89.13M, val_loss:0.9084 train_time:10.46s step_avg:16ms
step:690/1000, tokens seen:90.31M, avg_train_loss:0.9121 time:71/16s step_avg:16ms
step:690/1000, tokens seen: 90.44M, val_loss:0.9082 train_time:10.61s step_avg:16ms
step:700/1000, tokens seen:91.62M, avg_train_loss:0.9027 time:71/16s step_avg:16ms
step:700/1000, tokens seen: 91.75M, val_loss:0.9036 train_time:10.77s step_avg:16ms
step:710/1000, tokens seen:92.93M, avg_train_loss:0.9066 time:72/16s step_avg:16ms
step:710/1000, tokens seen: 93.06M, val_loss:0.9010 train_time:10.92s step_avg:16ms
step:720/1000, tokens seen:94.24M, avg_train_loss:0.8908 time:72/16s step_avg:16ms
step:720/1000, tokens seen: 94.37M, val_loss:0.8981 train_time:11.08s step_avg:16ms
step:730/1000, tokens seen:95.55M, avg_train_loss:0.8937 time:72/16s step_avg:16ms
step:730/1000, tokens seen: 95.68M, val_loss:0.8955 train_time:11.23s step_avg:16ms
step:740/1000, tokens seen:96.86M, avg_train_loss:0.8926 time:73/16s step_avg:16ms
step:740/1000, tokens seen: 96.99M, val_loss:0.8899 train_time:11.39s step_avg:16ms
step:750/1000, tokens seen:98.17M, avg_train_loss:0.8990 time:73/16s step_avg:16ms
step:750/1000, tokens seen: 98.30M, val_loss:0.8886 train_time:11.54s step_avg:16ms
step:760/1000, tokens seen:99.48M, avg_train_loss:0.8804 time:74/16s step_avg:16ms
step:760/1000, tokens seen: 99.61M, val_loss:0.8870 train_time:11.70s step_avg:16ms
step:770/1000, tokens seen:100.79M, avg_train_loss:0.8901 time:74/16s step_avg:16ms
step:770/1000, tokens seen: 100.93M, val_loss:0.8822 train_time:11.86s step_avg:16ms
step:780/1000, tokens seen:102.11M, avg_train_loss:0.8849 time:74/16s step_avg:16ms
step:780/1000, tokens seen: 102.24M, val_loss:0.8801 train_time:12.01s step_avg:16ms
step:790/1000, tokens seen:103.42M, avg_train_loss:0.8801 time:75/16s step_avg:16ms
step:790/1000, tokens seen: 103.55M, val_loss:0.8774 train_time:12.16s step_avg:16ms
step:800/1000, tokens seen:104.73M, avg_train_loss:0.8656 time:75/16s step_avg:16ms
step:800/1000, tokens seen: 104.86M, val_loss:0.8740 train_time:12.32s step_avg:16ms
step:810/1000, tokens seen:106.04M, avg_train_loss:0.8676 time:76/16s step_avg:16ms
step:810/1000, tokens seen: 106.17M, val_loss:0.8718 train_time:12.47s step_avg:16ms
step:820/1000, tokens seen:107.35M, avg_train_loss:0.8735 time:76/16s step_avg:16ms
step:820/1000, tokens seen: 107.48M, val_loss:0.8708 train_time:12.62s step_avg:16ms
step:830/1000, tokens seen:108.66M, avg_train_loss:0.8669 time:76/16s step_avg:16ms
step:830/1000, tokens seen: 108.79M, val_loss:0.8684 train_time:12.78s step_avg:16ms
step:840/1000, tokens seen:109.97M, avg_train_loss:0.8737 time:77/16s step_avg:16ms
step:840/1000, tokens seen: 110.10M, val_loss:0.8673 train_time:12.93s step_avg:16ms
step:850/1000, tokens seen:111.28M, avg_train_loss:0.8677 time:77/16s step_avg:16ms
step:850/1000, tokens seen: 111.41M, val_loss:0.8640 train_time:13.10s step_avg:16ms
step:860/1000, tokens seen:112.59M, avg_train_loss:0.8607 time:77/16s step_avg:16ms
step:860/1000, tokens seen: 112.72M, val_loss:0.8622 train_time:13.26s step_avg:16ms
step:870/1000, tokens seen:113.90M, avg_train_loss:0.8612 time:78/16s step_avg:16ms
step:870/1000, tokens seen: 114.03M, val_loss:0.8589 train_time:13.41s step_avg:16ms
step:880/1000, tokens seen:115.21M, avg_train_loss:0.8560 time:78/16s step_avg:16ms
step:880/1000, tokens seen: 115.34M, val_loss:0.8583 train_time:13.57s step_avg:16ms
step:890/1000, tokens seen:116.52M, avg_train_loss:0.8583 time:79/16s step_avg:16ms
step:890/1000, tokens seen: 116.65M, val_loss:0.8566 train_time:13.72s step_avg:16ms
step:900/1000, tokens seen:117.83M, avg_train_loss:0.8526 time:79/16s step_avg:16ms
step:900/1000, tokens seen: 117.96M, val_loss:0.8553 train_time:13.88s step_avg:16ms
step:910/1000, tokens seen:119.14M, avg_train_loss:0.8544 time:79/16s step_avg:16ms
step:910/1000, tokens seen: 119.28M, val_loss:0.8525 train_time:14.03s step_avg:16ms
step:920/1000, tokens seen:120.46M, avg_train_loss:0.8564 time:80/16s step_avg:16ms
step:920/1000, tokens seen: 120.59M, val_loss:0.8515 train_time:14.18s step_avg:16ms
step:930/1000, tokens seen:121.77M, avg_train_loss:0.8512 time:80/16s step_avg:16ms
step:930/1000, tokens seen: 121.90M, val_loss:0.8501 train_time:14.34s step_avg:16ms
step:940/1000, tokens seen:123.08M, avg_train_loss:0.8554 time:81/16s step_avg:16ms
step:940/1000, tokens seen: 123.21M, val_loss:0.8478 train_time:14.49s step_avg:16ms
step:950/1000, tokens seen:124.39M, avg_train_loss:0.8491 time:81/16s step_avg:16ms
step:950/1000, tokens seen: 124.52M, val_loss:0.8466 train_time:14.64s step_avg:16ms
step:960/1000, tokens seen:125.70M, avg_train_loss:0.8413 time:81/16s step_avg:16ms
step:960/1000, tokens seen: 125.83M, val_loss:0.8449 train_time:14.80s step_avg:16ms
step:970/1000, tokens seen:127.01M, avg_train_loss:0.8427 time:82/16s step_avg:16ms
step:970/1000, tokens seen: 127.14M, val_loss:0.8445 train_time:14.95s step_avg:16ms
step:980/1000, tokens seen:128.32M, avg_train_loss:0.8430 time:82/16s step_avg:16ms
step:980/1000, tokens seen: 128.45M, val_loss:0.8428 train_time:15.10s step_avg:16ms
step:990/1000, tokens seen:129.63M, avg_train_loss:0.8447 time:82/16s step_avg:16ms
step:990/1000, tokens seen: 129.76M, val_loss:0.8415 train_time:15.26s step_avg:16ms
step:1000/1000, tokens seen:130.94M, avg_train_loss:0.8406 time:83/16s step_avg:16ms
step:1000/1000, tokens seen: 131.07M, val_loss:0.8402 train_time:15.41s step_avg:16ms
Total training time: 83.09s
peak memory consumption: 1525 MiB
