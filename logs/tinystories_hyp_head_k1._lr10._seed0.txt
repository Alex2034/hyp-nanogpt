W0216 01:25:42.695262 140091538331456 torch/distributed/run.py:779] 
W0216 01:25:42.695262 140091538331456 torch/distributed/run.py:779] *****************************************
W0216 01:25:42.695262 140091538331456 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 01:25:42.695262 140091538331456 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 1] Using device: cuda:1
[Rank 0] Training DataLoader: 611289391 tokens across 1 files.
[Rank 0] Validation DataLoader: 6150326 tokens across 1 files.
[Rank 0] Model wrapped in DDP.
k params lengths: head = 1, attn = 0
Tokenizer vocab size: 1000
head.k is learned with 10.0 lr

=== Report ===
Model Size:    3.04M

Data Path:            data/tinystories
Sequence Length:      1024
Batch Size (global):  64
Batch Size (device):  32
n_layers:              6
n_heads:               6
head_dim:             32
n_embd:               192
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/5153_ts_he_k1.0_lr1e+01_s0/
Writing logs to: runs/02.16/5153_ts_he_k1.0_lr1e+01_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:7.0063 train_time:1.18s step_avg:nanms
step:10/1000, tokens seen:0.59M, avg_train_loss:5.5987 time:47/nans step_avg:nanms
step:10/1000, tokens seen: 0.66M, val_loss:4.7887 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:1.25M, avg_train_loss:4.5773 time:47/16s step_avg:16ms
step:20/1000, tokens seen: 1.31M, val_loss:4.3663 train_time:0.17s step_avg:17ms
step:30/1000, tokens seen:1.90M, avg_train_loss:4.2177 time:48/16s step_avg:16ms
step:30/1000, tokens seen: 1.97M, val_loss:4.0916 train_time:0.33s step_avg:16ms
step:40/1000, tokens seen:2.56M, avg_train_loss:3.9643 time:49/16s step_avg:16ms
step:40/1000, tokens seen: 2.62M, val_loss:3.8943 train_time:0.48s step_avg:16ms
step:50/1000, tokens seen:3.21M, avg_train_loss:3.7563 time:49/16s step_avg:16ms
step:50/1000, tokens seen: 3.28M, val_loss:3.7565 train_time:0.64s step_avg:16ms
step:60/1000, tokens seen:3.87M, avg_train_loss:3.6216 time:50/16s step_avg:16ms
step:60/1000, tokens seen: 3.93M, val_loss:3.5902 train_time:0.80s step_avg:16ms
step:70/1000, tokens seen:4.52M, avg_train_loss:3.4689 time:51/16s step_avg:16ms
step:70/1000, tokens seen: 4.59M, val_loss:3.4564 train_time:0.96s step_avg:16ms
step:80/1000, tokens seen:5.18M, avg_train_loss:3.3858 time:51/16s step_avg:16ms
step:80/1000, tokens seen: 5.24M, val_loss:3.3413 train_time:1.12s step_avg:16ms
step:90/1000, tokens seen:5.83M, avg_train_loss:3.2023 time:52/16s step_avg:16ms
step:90/1000, tokens seen: 5.90M, val_loss:3.2120 train_time:1.28s step_avg:16ms
step:100/1000, tokens seen:6.49M, avg_train_loss:3.1732 time:53/16s step_avg:16ms
step:100/1000, tokens seen: 6.55M, val_loss:3.1073 train_time:1.44s step_avg:16ms
step:110/1000, tokens seen:7.14M, avg_train_loss:3.0757 time:53/16s step_avg:16ms
step:110/1000, tokens seen: 7.21M, val_loss:2.9997 train_time:1.60s step_avg:16ms
step:120/1000, tokens seen:7.80M, avg_train_loss:2.9756 time:54/16s step_avg:16ms
step:120/1000, tokens seen: 7.86M, val_loss:2.9104 train_time:1.76s step_avg:16ms
step:130/1000, tokens seen:8.45M, avg_train_loss:2.8311 time:55/16s step_avg:16ms
step:130/1000, tokens seen: 8.52M, val_loss:2.8456 train_time:1.92s step_avg:16ms
step:140/1000, tokens seen:9.11M, avg_train_loss:2.7398 time:55/16s step_avg:16ms
step:140/1000, tokens seen: 9.18M, val_loss:2.7616 train_time:2.07s step_avg:16ms
step:150/1000, tokens seen:9.76M, avg_train_loss:2.6993 time:56/16s step_avg:16ms
step:150/1000, tokens seen: 9.83M, val_loss:2.7105 train_time:2.23s step_avg:16ms
step:160/1000, tokens seen:10.42M, avg_train_loss:2.7155 time:57/16s step_avg:16ms
step:160/1000, tokens seen: 10.49M, val_loss:2.6475 train_time:2.39s step_avg:16ms
step:170/1000, tokens seen:11.08M, avg_train_loss:2.5688 time:57/16s step_avg:16ms
step:170/1000, tokens seen: 11.14M, val_loss:2.6001 train_time:2.55s step_avg:16ms
step:180/1000, tokens seen:11.73M, avg_train_loss:2.5607 time:58/16s step_avg:16ms
step:180/1000, tokens seen: 11.80M, val_loss:2.5448 train_time:2.71s step_avg:16ms
step:190/1000, tokens seen:12.39M, avg_train_loss:2.5618 time:59/16s step_avg:16ms
step:190/1000, tokens seen: 12.45M, val_loss:2.5028 train_time:2.87s step_avg:16ms
step:200/1000, tokens seen:13.04M, avg_train_loss:2.4975 time:59/16s step_avg:16ms
step:200/1000, tokens seen: 13.11M, val_loss:2.4555 train_time:3.03s step_avg:16ms
step:210/1000, tokens seen:13.70M, avg_train_loss:2.5089 time:60/16s step_avg:16ms
step:210/1000, tokens seen: 13.76M, val_loss:2.4378 train_time:3.19s step_avg:16ms
step:220/1000, tokens seen:14.35M, avg_train_loss:2.4278 time:61/16s step_avg:16ms
step:220/1000, tokens seen: 14.42M, val_loss:2.3969 train_time:3.34s step_avg:16ms
step:230/1000, tokens seen:15.01M, avg_train_loss:2.3944 time:61/16s step_avg:16ms
step:230/1000, tokens seen: 15.07M, val_loss:2.3712 train_time:3.50s step_avg:16ms
step:240/1000, tokens seen:15.66M, avg_train_loss:2.3574 time:62/16s step_avg:16ms
step:240/1000, tokens seen: 15.73M, val_loss:2.3454 train_time:3.66s step_avg:16ms
step:250/1000, tokens seen:16.32M, avg_train_loss:2.2869 time:63/16s step_avg:16ms
step:250/1000, tokens seen: 16.38M, val_loss:2.3056 train_time:3.82s step_avg:16ms
step:260/1000, tokens seen:16.97M, avg_train_loss:2.2553 time:63/16s step_avg:16ms
step:260/1000, tokens seen: 17.04M, val_loss:2.2943 train_time:3.97s step_avg:16ms
step:270/1000, tokens seen:17.63M, avg_train_loss:2.3244 time:64/16s step_avg:16ms
step:270/1000, tokens seen: 17.69M, val_loss:2.2667 train_time:4.13s step_avg:16ms
step:280/1000, tokens seen:18.28M, avg_train_loss:2.2906 time:65/16s step_avg:16ms
step:280/1000, tokens seen: 18.35M, val_loss:2.2454 train_time:4.29s step_avg:16ms
step:290/1000, tokens seen:18.94M, avg_train_loss:2.3087 time:65/16s step_avg:16ms
step:290/1000, tokens seen: 19.01M, val_loss:2.2249 train_time:4.45s step_avg:16ms
step:300/1000, tokens seen:19.60M, avg_train_loss:2.1778 time:66/16s step_avg:16ms
step:300/1000, tokens seen: 19.66M, val_loss:2.2030 train_time:4.61s step_avg:16ms
step:310/1000, tokens seen:20.25M, avg_train_loss:2.2250 time:67/16s step_avg:16ms
step:310/1000, tokens seen: 20.32M, val_loss:2.1859 train_time:4.76s step_avg:16ms
step:320/1000, tokens seen:20.91M, avg_train_loss:2.1709 time:67/16s step_avg:16ms
step:320/1000, tokens seen: 20.97M, val_loss:2.1610 train_time:4.92s step_avg:16ms
step:330/1000, tokens seen:21.56M, avg_train_loss:2.1785 time:68/16s step_avg:16ms
step:330/1000, tokens seen: 21.63M, val_loss:2.1521 train_time:5.08s step_avg:16ms
step:340/1000, tokens seen:22.22M, avg_train_loss:2.1303 time:69/16s step_avg:16ms
step:340/1000, tokens seen: 22.28M, val_loss:2.1299 train_time:5.24s step_avg:16ms
step:350/1000, tokens seen:22.87M, avg_train_loss:2.2025 time:69/16s step_avg:16ms
step:350/1000, tokens seen: 22.94M, val_loss:2.1266 train_time:5.40s step_avg:16ms
step:360/1000, tokens seen:23.53M, avg_train_loss:2.1561 time:70/16s step_avg:16ms
step:360/1000, tokens seen: 23.59M, val_loss:2.1087 train_time:5.56s step_avg:16ms
step:370/1000, tokens seen:24.18M, avg_train_loss:2.0548 time:71/16s step_avg:16ms
step:370/1000, tokens seen: 24.25M, val_loss:2.0912 train_time:5.72s step_avg:16ms
step:380/1000, tokens seen:24.84M, avg_train_loss:2.1663 time:71/16s step_avg:16ms
step:380/1000, tokens seen: 24.90M, val_loss:2.0819 train_time:5.89s step_avg:16ms
step:390/1000, tokens seen:25.49M, avg_train_loss:2.1372 time:72/16s step_avg:16ms
step:390/1000, tokens seen: 25.56M, val_loss:2.0687 train_time:6.05s step_avg:16ms
step:400/1000, tokens seen:26.15M, avg_train_loss:2.0603 time:73/16s step_avg:16ms
step:400/1000, tokens seen: 26.21M, val_loss:2.0611 train_time:6.21s step_avg:16ms
step:410/1000, tokens seen:26.80M, avg_train_loss:1.9756 time:73/16s step_avg:16ms
step:410/1000, tokens seen: 26.87M, val_loss:2.0424 train_time:6.37s step_avg:16ms
step:420/1000, tokens seen:27.46M, avg_train_loss:1.9611 time:74/16s step_avg:16ms
step:420/1000, tokens seen: 27.53M, val_loss:2.0419 train_time:6.54s step_avg:16ms
step:430/1000, tokens seen:28.11M, avg_train_loss:2.0401 time:74/16s step_avg:16ms
step:430/1000, tokens seen: 28.18M, val_loss:2.0259 train_time:6.70s step_avg:16ms
step:440/1000, tokens seen:28.77M, avg_train_loss:2.0910 time:75/16s step_avg:16ms
step:440/1000, tokens seen: 28.84M, val_loss:2.0161 train_time:6.86s step_avg:16ms
step:450/1000, tokens seen:29.43M, avg_train_loss:2.0289 time:76/16s step_avg:16ms
step:450/1000, tokens seen: 29.49M, val_loss:2.0122 train_time:7.02s step_avg:16ms
step:460/1000, tokens seen:30.08M, avg_train_loss:1.9660 time:76/16s step_avg:16ms
step:460/1000, tokens seen: 30.15M, val_loss:2.0096 train_time:7.18s step_avg:16ms
step:470/1000, tokens seen:30.74M, avg_train_loss:1.9505 time:77/16s step_avg:16ms
step:470/1000, tokens seen: 30.80M, val_loss:1.9895 train_time:7.36s step_avg:16ms
step:480/1000, tokens seen:31.39M, avg_train_loss:1.9352 time:78/16s step_avg:16ms
step:480/1000, tokens seen: 31.46M, val_loss:1.9855 train_time:7.53s step_avg:16ms
step:490/1000, tokens seen:32.05M, avg_train_loss:1.9069 time:79/16s step_avg:16ms
step:490/1000, tokens seen: 32.11M, val_loss:1.9820 train_time:7.70s step_avg:16ms
step:500/1000, tokens seen:32.70M, avg_train_loss:2.0467 time:79/16s step_avg:16ms
step:500/1000, tokens seen: 32.77M, val_loss:1.9746 train_time:7.87s step_avg:16ms
step:510/1000, tokens seen:33.36M, avg_train_loss:1.9738 time:80/16s step_avg:16ms
step:510/1000, tokens seen: 33.42M, val_loss:1.9624 train_time:8.05s step_avg:16ms
step:520/1000, tokens seen:34.01M, avg_train_loss:1.8825 time:81/16s step_avg:16ms
step:520/1000, tokens seen: 34.08M, val_loss:1.9507 train_time:8.22s step_avg:16ms
step:530/1000, tokens seen:34.67M, avg_train_loss:1.9307 time:81/16s step_avg:16ms
step:530/1000, tokens seen: 34.73M, val_loss:1.9412 train_time:8.39s step_avg:16ms
step:540/1000, tokens seen:35.32M, avg_train_loss:1.9100 time:82/16s step_avg:16ms
step:540/1000, tokens seen: 35.39M, val_loss:1.9358 train_time:8.56s step_avg:16ms
step:550/1000, tokens seen:35.98M, avg_train_loss:1.9963 time:83/16s step_avg:16ms
step:550/1000, tokens seen: 36.04M, val_loss:1.9323 train_time:8.72s step_avg:16ms
step:560/1000, tokens seen:36.63M, avg_train_loss:1.9524 time:83/16s step_avg:16ms
step:560/1000, tokens seen: 36.70M, val_loss:1.9243 train_time:8.87s step_avg:16ms
step:570/1000, tokens seen:37.29M, avg_train_loss:1.8987 time:84/16s step_avg:16ms
step:570/1000, tokens seen: 37.36M, val_loss:1.9197 train_time:9.03s step_avg:16ms
step:580/1000, tokens seen:37.95M, avg_train_loss:1.8566 time:85/16s step_avg:16ms
step:580/1000, tokens seen: 38.01M, val_loss:1.9137 train_time:9.19s step_avg:16ms
step:590/1000, tokens seen:38.60M, avg_train_loss:1.9338 time:85/16s step_avg:16ms
step:590/1000, tokens seen: 38.67M, val_loss:1.9103 train_time:9.35s step_avg:16ms
step:600/1000, tokens seen:39.26M, avg_train_loss:1.8346 time:86/16s step_avg:16ms
step:600/1000, tokens seen: 39.32M, val_loss:1.9043 train_time:9.50s step_avg:16ms
step:610/1000, tokens seen:39.91M, avg_train_loss:1.9896 time:86/16s step_avg:16ms
step:610/1000, tokens seen: 39.98M, val_loss:1.9007 train_time:9.66s step_avg:16ms
step:620/1000, tokens seen:40.57M, avg_train_loss:1.9095 time:87/16s step_avg:16ms
step:620/1000, tokens seen: 40.63M, val_loss:1.8902 train_time:9.82s step_avg:16ms
step:630/1000, tokens seen:41.22M, avg_train_loss:1.8767 time:88/16s step_avg:16ms
step:630/1000, tokens seen: 41.29M, val_loss:1.8772 train_time:9.98s step_avg:16ms
step:640/1000, tokens seen:41.88M, avg_train_loss:1.8701 time:88/16s step_avg:16ms
step:640/1000, tokens seen: 41.94M, val_loss:1.8773 train_time:10.14s step_avg:16ms
step:650/1000, tokens seen:42.53M, avg_train_loss:1.7284 time:89/16s step_avg:16ms
step:650/1000, tokens seen: 42.60M, val_loss:1.8793 train_time:10.29s step_avg:16ms
step:660/1000, tokens seen:43.19M, avg_train_loss:1.8649 time:90/16s step_avg:16ms
step:660/1000, tokens seen: 43.25M, val_loss:1.8634 train_time:10.48s step_avg:16ms
step:670/1000, tokens seen:43.84M, avg_train_loss:1.8751 time:91/16s step_avg:16ms
step:670/1000, tokens seen: 43.91M, val_loss:1.8588 train_time:10.65s step_avg:16ms
step:680/1000, tokens seen:44.50M, avg_train_loss:1.8235 time:91/16s step_avg:16ms
step:680/1000, tokens seen: 44.56M, val_loss:1.8477 train_time:10.83s step_avg:16ms
step:690/1000, tokens seen:45.15M, avg_train_loss:1.8171 time:92/16s step_avg:16ms
step:690/1000, tokens seen: 45.22M, val_loss:1.8511 train_time:11.00s step_avg:16ms
step:700/1000, tokens seen:45.81M, avg_train_loss:1.8472 time:93/16s step_avg:16ms
step:700/1000, tokens seen: 45.88M, val_loss:1.8421 train_time:11.17s step_avg:16ms
step:710/1000, tokens seen:46.47M, avg_train_loss:1.8347 time:93/16s step_avg:16ms
step:710/1000, tokens seen: 46.53M, val_loss:1.8346 train_time:11.34s step_avg:16ms
step:720/1000, tokens seen:47.12M, avg_train_loss:1.8203 time:94/16s step_avg:16ms
step:720/1000, tokens seen: 47.19M, val_loss:1.8316 train_time:11.52s step_avg:16ms
step:730/1000, tokens seen:47.78M, avg_train_loss:1.7577 time:95/16s step_avg:16ms
step:730/1000, tokens seen: 47.84M, val_loss:1.8248 train_time:11.68s step_avg:16ms
step:740/1000, tokens seen:48.43M, avg_train_loss:1.7473 time:95/16s step_avg:16ms
step:740/1000, tokens seen: 48.50M, val_loss:1.8239 train_time:11.87s step_avg:16ms
step:750/1000, tokens seen:49.09M, avg_train_loss:1.7215 time:96/16s step_avg:16ms
step:750/1000, tokens seen: 49.15M, val_loss:1.8228 train_time:12.03s step_avg:16ms
step:760/1000, tokens seen:49.74M, avg_train_loss:1.7511 time:97/16s step_avg:16ms
step:760/1000, tokens seen: 49.81M, val_loss:1.8102 train_time:12.18s step_avg:16ms
step:770/1000, tokens seen:50.40M, avg_train_loss:1.8359 time:97/16s step_avg:16ms
step:770/1000, tokens seen: 50.46M, val_loss:1.8051 train_time:12.34s step_avg:16ms
step:780/1000, tokens seen:51.05M, avg_train_loss:1.7022 time:98/16s step_avg:16ms
step:780/1000, tokens seen: 51.12M, val_loss:1.8007 train_time:12.50s step_avg:16ms
step:790/1000, tokens seen:51.71M, avg_train_loss:1.8084 time:99/16s step_avg:16ms
step:790/1000, tokens seen: 51.77M, val_loss:1.7936 train_time:12.66s step_avg:16ms
step:800/1000, tokens seen:52.36M, avg_train_loss:1.7703 time:99/16s step_avg:16ms
step:800/1000, tokens seen: 52.43M, val_loss:1.7911 train_time:12.81s step_avg:16ms
step:810/1000, tokens seen:53.02M, avg_train_loss:1.7967 time:100/16s step_avg:16ms
step:810/1000, tokens seen: 53.08M, val_loss:1.7814 train_time:12.97s step_avg:16ms
step:820/1000, tokens seen:53.67M, avg_train_loss:1.7965 time:101/16s step_avg:16ms
step:820/1000, tokens seen: 53.74M, val_loss:1.7799 train_time:13.13s step_avg:16ms
step:830/1000, tokens seen:54.33M, avg_train_loss:1.8484 time:101/16s step_avg:16ms
step:830/1000, tokens seen: 54.39M, val_loss:1.7739 train_time:13.29s step_avg:16ms
step:840/1000, tokens seen:54.98M, avg_train_loss:1.7286 time:102/16s step_avg:16ms
step:840/1000, tokens seen: 55.05M, val_loss:1.7706 train_time:13.44s step_avg:16ms
step:850/1000, tokens seen:55.64M, avg_train_loss:1.6845 time:103/16s step_avg:16ms
step:850/1000, tokens seen: 55.71M, val_loss:1.7645 train_time:13.62s step_avg:16ms
step:860/1000, tokens seen:56.30M, avg_train_loss:1.7202 time:103/16s step_avg:16ms
step:860/1000, tokens seen: 56.36M, val_loss:1.7605 train_time:13.79s step_avg:16ms
step:870/1000, tokens seen:56.95M, avg_train_loss:1.6268 time:104/16s step_avg:16ms
step:870/1000, tokens seen: 57.02M, val_loss:1.7572 train_time:13.95s step_avg:16ms
step:880/1000, tokens seen:57.61M, avg_train_loss:1.7463 time:105/16s step_avg:16ms
step:880/1000, tokens seen: 57.67M, val_loss:1.7518 train_time:14.12s step_avg:16ms
step:890/1000, tokens seen:58.26M, avg_train_loss:1.7387 time:105/16s step_avg:16ms
step:890/1000, tokens seen: 58.33M, val_loss:1.7466 train_time:14.29s step_avg:16ms
step:900/1000, tokens seen:58.92M, avg_train_loss:1.7004 time:106/16s step_avg:16ms
step:900/1000, tokens seen: 58.98M, val_loss:1.7433 train_time:14.46s step_avg:16ms
step:910/1000, tokens seen:59.57M, avg_train_loss:1.6904 time:107/16s step_avg:16ms
step:910/1000, tokens seen: 59.64M, val_loss:1.7397 train_time:14.64s step_avg:16ms
step:920/1000, tokens seen:60.23M, avg_train_loss:1.7002 time:107/16s step_avg:16ms
step:920/1000, tokens seen: 60.29M, val_loss:1.7366 train_time:14.82s step_avg:16ms
step:930/1000, tokens seen:60.88M, avg_train_loss:1.7457 time:108/16s step_avg:16ms
step:930/1000, tokens seen: 60.95M, val_loss:1.7328 train_time:15.00s step_avg:16ms
step:940/1000, tokens seen:61.54M, avg_train_loss:1.6402 time:109/16s step_avg:16ms
step:940/1000, tokens seen: 61.60M, val_loss:1.7298 train_time:15.17s step_avg:16ms
step:950/1000, tokens seen:62.19M, avg_train_loss:1.7304 time:110/16s step_avg:16ms
step:950/1000, tokens seen: 62.26M, val_loss:1.7263 train_time:15.35s step_avg:16ms
step:960/1000, tokens seen:62.85M, avg_train_loss:1.6971 time:110/16s step_avg:16ms
step:960/1000, tokens seen: 62.91M, val_loss:1.7224 train_time:15.50s step_avg:16ms
step:970/1000, tokens seen:63.50M, avg_train_loss:1.7289 time:111/16s step_avg:16ms
step:970/1000, tokens seen: 63.57M, val_loss:1.7193 train_time:15.66s step_avg:16ms
step:980/1000, tokens seen:64.16M, avg_train_loss:1.7839 time:112/16s step_avg:16ms
step:980/1000, tokens seen: 64.23M, val_loss:1.7167 train_time:15.82s step_avg:16ms
step:990/1000, tokens seen:64.82M, avg_train_loss:1.6428 time:112/16s step_avg:16ms
step:990/1000, tokens seen: 64.88M, val_loss:1.7142 train_time:15.97s step_avg:16ms
step:1000/1000, tokens seen:65.47M, avg_train_loss:1.7170 time:113/16s step_avg:16ms
step:1000/1000, tokens seen: 65.54M, val_loss:1.7113 train_time:16.13s step_avg:16ms
Total training time: 113.43s
peak memory consumption: 2793 MiB
