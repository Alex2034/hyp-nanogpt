W0216 03:06:33.355334 139972110997312 torch/distributed/run.py:779] 
W0216 03:06:33.355334 139972110997312 torch/distributed/run.py:779] *****************************************
W0216 03:06:33.355334 139972110997312 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 03:06:33.355334 139972110997312 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 1] Using device: cuda:1
[Rank 0] Training DataLoader: 611289391 tokens across 1 files.
[Rank 0] Validation DataLoader: 6150326 tokens across 1 files.
[Rank 0] Model wrapped in DDP.
k params lengths: head = 0, attn = 6
Tokenizer vocab size: 1000
attn.k is learned

=== Report ===
Model Size:    3.04M

Data Path:            data/tinystories
Sequence Length:      1024
Batch Size (global):  64
Batch Size (device):  32
n_layers:              6
n_heads:               6
head_dim:             32
n_embd:               192
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/11204_ts_eh_k1.0_lr1e+01_s0/
Writing logs to: runs/02.16/11204_ts_eh_k1.0_lr1e+01_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:7.0619 train_time:1.20s step_avg:nanms
step:10/1000, tokens seen:0.59M, avg_train_loss:5.2522 time:73/nans step_avg:nanms
step:10/1000, tokens seen: 0.66M, val_loss:4.5649 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:1.25M, avg_train_loss:4.4059 time:112/355s step_avg:355ms
step:20/1000, tokens seen: 1.31M, val_loss:4.2579 train_time:3.55s step_avg:355ms
step:30/1000, tokens seen:1.90M, avg_train_loss:4.1460 time:150/355s step_avg:355ms
step:30/1000, tokens seen: 1.97M, val_loss:4.0709 train_time:7.11s step_avg:355ms
step:40/1000, tokens seen:2.56M, avg_train_loss:3.9835 time:188/355s step_avg:355ms
step:40/1000, tokens seen: 2.62M, val_loss:3.9515 train_time:10.67s step_avg:356ms
step:50/1000, tokens seen:3.21M, avg_train_loss:3.8464 time:227/355s step_avg:355ms
step:50/1000, tokens seen: 3.28M, val_loss:3.8627 train_time:14.23s step_avg:356ms
step:60/1000, tokens seen:3.87M, avg_train_loss:3.7807 time:265/356s step_avg:356ms
step:60/1000, tokens seen: 3.93M, val_loss:3.7783 train_time:17.80s step_avg:356ms
step:70/1000, tokens seen:4.52M, avg_train_loss:3.7106 time:304/356s step_avg:356ms
step:70/1000, tokens seen: 4.59M, val_loss:3.7217 train_time:21.36s step_avg:356ms
step:80/1000, tokens seen:5.18M, avg_train_loss:3.6816 time:342/356s step_avg:356ms
step:80/1000, tokens seen: 5.24M, val_loss:3.6864 train_time:24.91s step_avg:356ms
step:90/1000, tokens seen:5.83M, avg_train_loss:3.6030 time:380/356s step_avg:356ms
step:90/1000, tokens seen: 5.90M, val_loss:3.6447 train_time:28.47s step_avg:356ms
step:100/1000, tokens seen:6.49M, avg_train_loss:3.6491 time:419/356s step_avg:356ms
step:100/1000, tokens seen: 6.55M, val_loss:3.6146 train_time:32.03s step_avg:356ms
step:110/1000, tokens seen:7.14M, avg_train_loss:3.6041 time:457/356s step_avg:356ms
step:110/1000, tokens seen: 7.21M, val_loss:3.5779 train_time:35.58s step_avg:356ms
step:120/1000, tokens seen:7.80M, avg_train_loss:3.5733 time:495/356s step_avg:356ms
step:120/1000, tokens seen: 7.86M, val_loss:3.5533 train_time:39.15s step_avg:356ms
step:130/1000, tokens seen:8.45M, avg_train_loss:3.5053 time:534/356s step_avg:356ms
step:130/1000, tokens seen: 8.52M, val_loss:3.5501 train_time:42.70s step_avg:356ms
step:140/1000, tokens seen:9.11M, avg_train_loss:3.4719 time:572/356s step_avg:356ms
step:140/1000, tokens seen: 9.18M, val_loss:3.5130 train_time:46.25s step_avg:356ms
step:150/1000, tokens seen:9.76M, avg_train_loss:3.4589 time:611/356s step_avg:356ms
step:150/1000, tokens seen: 9.83M, val_loss:3.4896 train_time:49.81s step_avg:356ms
step:160/1000, tokens seen:10.42M, avg_train_loss:3.5061 time:649/356s step_avg:356ms
step:160/1000, tokens seen: 10.49M, val_loss:3.4731 train_time:53.37s step_avg:356ms
step:170/1000, tokens seen:11.08M, avg_train_loss:3.4099 time:687/356s step_avg:356ms
step:170/1000, tokens seen: 11.14M, val_loss:3.4458 train_time:56.92s step_avg:356ms
step:180/1000, tokens seen:11.73M, avg_train_loss:3.4133 time:726/356s step_avg:356ms
step:180/1000, tokens seen: 11.80M, val_loss:3.4208 train_time:60.47s step_avg:356ms
step:190/1000, tokens seen:12.39M, avg_train_loss:3.4427 time:764/356s step_avg:356ms
step:190/1000, tokens seen: 12.45M, val_loss:3.4065 train_time:64.03s step_avg:356ms
step:200/1000, tokens seen:13.04M, avg_train_loss:3.4034 time:802/356s step_avg:356ms
step:200/1000, tokens seen: 13.11M, val_loss:3.3698 train_time:67.58s step_avg:356ms
step:210/1000, tokens seen:13.70M, avg_train_loss:3.4188 time:841/356s step_avg:356ms
step:210/1000, tokens seen: 13.76M, val_loss:3.3735 train_time:71.14s step_avg:356ms
step:220/1000, tokens seen:14.35M, avg_train_loss:3.3581 time:879/356s step_avg:356ms
step:220/1000, tokens seen: 14.42M, val_loss:3.3327 train_time:74.69s step_avg:356ms
step:230/1000, tokens seen:15.01M, avg_train_loss:3.3353 time:917/356s step_avg:356ms
step:230/1000, tokens seen: 15.07M, val_loss:3.3091 train_time:78.25s step_avg:356ms
step:240/1000, tokens seen:15.66M, avg_train_loss:3.3003 time:956/356s step_avg:356ms
step:240/1000, tokens seen: 15.73M, val_loss:3.2913 train_time:81.80s step_avg:356ms
step:250/1000, tokens seen:16.32M, avg_train_loss:3.2281 time:994/356s step_avg:356ms
step:250/1000, tokens seen: 16.38M, val_loss:3.2510 train_time:85.36s step_avg:356ms
step:260/1000, tokens seen:16.97M, avg_train_loss:3.1863 time:1032/356s step_avg:356ms
step:260/1000, tokens seen: 17.04M, val_loss:3.2379 train_time:88.92s step_avg:356ms
step:270/1000, tokens seen:17.63M, avg_train_loss:3.2758 time:1071/356s step_avg:356ms
step:270/1000, tokens seen: 17.69M, val_loss:3.2475 train_time:92.47s step_avg:356ms
step:280/1000, tokens seen:18.28M, avg_train_loss:3.2431 time:1109/356s step_avg:356ms
step:280/1000, tokens seen: 18.35M, val_loss:3.2089 train_time:96.03s step_avg:356ms
step:290/1000, tokens seen:18.94M, avg_train_loss:3.2628 time:1148/356s step_avg:356ms
step:290/1000, tokens seen: 19.01M, val_loss:3.1677 train_time:99.58s step_avg:356ms
step:300/1000, tokens seen:19.60M, avg_train_loss:3.1141 time:1186/356s step_avg:356ms
step:300/1000, tokens seen: 19.66M, val_loss:3.1540 train_time:103.14s step_avg:356ms
step:310/1000, tokens seen:20.25M, avg_train_loss:3.1757 time:1224/356s step_avg:356ms
step:310/1000, tokens seen: 20.32M, val_loss:3.1482 train_time:106.69s step_avg:356ms
step:320/1000, tokens seen:20.91M, avg_train_loss:3.1243 time:1263/356s step_avg:356ms
step:320/1000, tokens seen: 20.97M, val_loss:3.0968 train_time:110.25s step_avg:356ms
step:330/1000, tokens seen:21.56M, avg_train_loss:3.1096 time:1301/356s step_avg:356ms
step:330/1000, tokens seen: 21.63M, val_loss:3.0811 train_time:113.80s step_avg:356ms
step:340/1000, tokens seen:22.22M, avg_train_loss:3.0447 time:1339/356s step_avg:356ms
step:340/1000, tokens seen: 22.28M, val_loss:3.0468 train_time:117.36s step_avg:356ms
step:350/1000, tokens seen:22.87M, avg_train_loss:3.1200 time:1378/356s step_avg:356ms
step:350/1000, tokens seen: 22.94M, val_loss:3.0463 train_time:120.92s step_avg:356ms
step:360/1000, tokens seen:23.53M, avg_train_loss:3.0650 time:1416/356s step_avg:356ms
step:360/1000, tokens seen: 23.59M, val_loss:3.0013 train_time:124.47s step_avg:356ms
step:370/1000, tokens seen:24.18M, avg_train_loss:2.9338 time:1454/356s step_avg:356ms
step:370/1000, tokens seen: 24.25M, val_loss:2.9809 train_time:128.03s step_avg:356ms
step:380/1000, tokens seen:24.84M, avg_train_loss:3.0443 time:1493/356s step_avg:356ms
step:380/1000, tokens seen: 24.90M, val_loss:2.9505 train_time:131.58s step_avg:356ms
step:390/1000, tokens seen:25.49M, avg_train_loss:3.0099 time:1531/356s step_avg:356ms
step:390/1000, tokens seen: 25.56M, val_loss:2.9234 train_time:135.14s step_avg:356ms
step:400/1000, tokens seen:26.15M, avg_train_loss:2.9144 time:1570/356s step_avg:356ms
step:400/1000, tokens seen: 26.21M, val_loss:2.9093 train_time:138.70s step_avg:356ms
step:410/1000, tokens seen:26.80M, avg_train_loss:2.8118 time:1608/356s step_avg:356ms
step:410/1000, tokens seen: 26.87M, val_loss:2.8821 train_time:142.26s step_avg:356ms
step:420/1000, tokens seen:27.46M, avg_train_loss:nan time:1646/356s step_avg:356ms
step:420/1000, tokens seen: 27.53M, val_loss:nan train_time:145.82s step_avg:356ms
step:430/1000, tokens seen:28.11M, avg_train_loss:nan time:1685/356s step_avg:356ms
step:430/1000, tokens seen: 28.18M, val_loss:nan train_time:149.36s step_avg:356ms
step:440/1000, tokens seen:28.77M, avg_train_loss:nan time:1723/356s step_avg:356ms
step:440/1000, tokens seen: 28.84M, val_loss:nan train_time:152.91s step_avg:356ms
step:450/1000, tokens seen:29.43M, avg_train_loss:nan time:1761/356s step_avg:356ms
step:450/1000, tokens seen: 29.49M, val_loss:nan train_time:156.45s step_avg:356ms
step:460/1000, tokens seen:30.08M, avg_train_loss:nan time:1800/356s step_avg:356ms
step:460/1000, tokens seen: 30.15M, val_loss:nan train_time:160.00s step_avg:356ms
step:470/1000, tokens seen:30.74M, avg_train_loss:nan time:1838/356s step_avg:356ms
step:470/1000, tokens seen: 30.80M, val_loss:nan train_time:163.55s step_avg:356ms
step:480/1000, tokens seen:31.39M, avg_train_loss:nan time:1876/356s step_avg:356ms
step:480/1000, tokens seen: 31.46M, val_loss:nan train_time:167.09s step_avg:356ms
step:490/1000, tokens seen:32.05M, avg_train_loss:nan time:1915/355s step_avg:355ms
step:490/1000, tokens seen: 32.11M, val_loss:nan train_time:170.64s step_avg:355ms
step:500/1000, tokens seen:32.70M, avg_train_loss:nan time:1953/355s step_avg:355ms
step:500/1000, tokens seen: 32.77M, val_loss:nan train_time:174.19s step_avg:355ms
step:510/1000, tokens seen:33.36M, avg_train_loss:nan time:1992/355s step_avg:355ms
step:510/1000, tokens seen: 33.42M, val_loss:nan train_time:177.73s step_avg:355ms
step:520/1000, tokens seen:34.01M, avg_train_loss:nan time:2030/355s step_avg:355ms
step:520/1000, tokens seen: 34.08M, val_loss:nan train_time:181.28s step_avg:355ms
step:530/1000, tokens seen:34.67M, avg_train_loss:nan time:2068/355s step_avg:355ms
step:530/1000, tokens seen: 34.73M, val_loss:nan train_time:184.82s step_avg:355ms
step:540/1000, tokens seen:35.32M, avg_train_loss:nan time:2107/355s step_avg:355ms
step:540/1000, tokens seen: 35.39M, val_loss:nan train_time:188.37s step_avg:355ms
step:550/1000, tokens seen:35.98M, avg_train_loss:nan time:2145/355s step_avg:355ms
step:550/1000, tokens seen: 36.04M, val_loss:nan train_time:191.91s step_avg:355ms
step:560/1000, tokens seen:36.63M, avg_train_loss:nan time:2183/355s step_avg:355ms
step:560/1000, tokens seen: 36.70M, val_loss:nan train_time:195.46s step_avg:355ms
step:570/1000, tokens seen:37.29M, avg_train_loss:nan time:2222/355s step_avg:355ms
step:570/1000, tokens seen: 37.36M, val_loss:nan train_time:199.00s step_avg:355ms
step:580/1000, tokens seen:37.95M, avg_train_loss:nan time:2260/355s step_avg:355ms
step:580/1000, tokens seen: 38.01M, val_loss:nan train_time:202.55s step_avg:355ms
step:590/1000, tokens seen:38.60M, avg_train_loss:nan time:2298/355s step_avg:355ms
step:590/1000, tokens seen: 38.67M, val_loss:nan train_time:206.10s step_avg:355ms
step:600/1000, tokens seen:39.26M, avg_train_loss:nan time:2337/355s step_avg:355ms
step:600/1000, tokens seen: 39.32M, val_loss:nan train_time:209.64s step_avg:355ms
step:610/1000, tokens seen:39.91M, avg_train_loss:nan time:2375/355s step_avg:355ms
step:610/1000, tokens seen: 39.98M, val_loss:nan train_time:213.19s step_avg:355ms
step:620/1000, tokens seen:40.57M, avg_train_loss:nan time:2413/355s step_avg:355ms
step:620/1000, tokens seen: 40.63M, val_loss:nan train_time:216.73s step_avg:355ms
step:630/1000, tokens seen:41.22M, avg_train_loss:nan time:2452/355s step_avg:355ms
step:630/1000, tokens seen: 41.29M, val_loss:nan train_time:220.28s step_avg:355ms
step:640/1000, tokens seen:41.88M, avg_train_loss:nan time:2490/355s step_avg:355ms
step:640/1000, tokens seen: 41.94M, val_loss:nan train_time:223.82s step_avg:355ms
step:650/1000, tokens seen:42.53M, avg_train_loss:nan time:2529/355s step_avg:355ms
step:650/1000, tokens seen: 42.60M, val_loss:nan train_time:227.37s step_avg:355ms
step:660/1000, tokens seen:43.19M, avg_train_loss:nan time:2567/355s step_avg:355ms
step:660/1000, tokens seen: 43.25M, val_loss:nan train_time:230.91s step_avg:355ms
step:670/1000, tokens seen:43.84M, avg_train_loss:nan time:2605/355s step_avg:355ms
step:670/1000, tokens seen: 43.91M, val_loss:nan train_time:234.46s step_avg:355ms
step:680/1000, tokens seen:44.50M, avg_train_loss:nan time:2644/355s step_avg:355ms
step:680/1000, tokens seen: 44.56M, val_loss:nan train_time:238.00s step_avg:355ms
step:690/1000, tokens seen:45.15M, avg_train_loss:nan time:2682/355s step_avg:355ms
step:690/1000, tokens seen: 45.22M, val_loss:nan train_time:241.55s step_avg:355ms
step:700/1000, tokens seen:45.81M, avg_train_loss:nan time:2720/355s step_avg:355ms
step:700/1000, tokens seen: 45.88M, val_loss:nan train_time:245.09s step_avg:355ms
step:710/1000, tokens seen:46.47M, avg_train_loss:nan time:2759/355s step_avg:355ms
step:710/1000, tokens seen: 46.53M, val_loss:nan train_time:248.64s step_avg:355ms
step:720/1000, tokens seen:47.12M, avg_train_loss:nan time:2797/355s step_avg:355ms
step:720/1000, tokens seen: 47.19M, val_loss:nan train_time:252.18s step_avg:355ms
step:730/1000, tokens seen:47.78M, avg_train_loss:nan time:2835/355s step_avg:355ms
step:730/1000, tokens seen: 47.84M, val_loss:nan train_time:255.73s step_avg:355ms
step:740/1000, tokens seen:48.43M, avg_train_loss:nan time:2874/355s step_avg:355ms
step:740/1000, tokens seen: 48.50M, val_loss:nan train_time:259.27s step_avg:355ms
step:750/1000, tokens seen:49.09M, avg_train_loss:nan time:2912/355s step_avg:355ms
step:750/1000, tokens seen: 49.15M, val_loss:nan train_time:262.82s step_avg:355ms
step:760/1000, tokens seen:49.74M, avg_train_loss:nan time:2951/355s step_avg:355ms
step:760/1000, tokens seen: 49.81M, val_loss:nan train_time:266.36s step_avg:355ms
step:770/1000, tokens seen:50.40M, avg_train_loss:nan time:2989/355s step_avg:355ms
step:770/1000, tokens seen: 50.46M, val_loss:nan train_time:269.91s step_avg:355ms
step:780/1000, tokens seen:51.05M, avg_train_loss:nan time:3027/355s step_avg:355ms
step:780/1000, tokens seen: 51.12M, val_loss:nan train_time:273.45s step_avg:355ms
step:790/1000, tokens seen:51.71M, avg_train_loss:nan time:3066/355s step_avg:355ms
step:790/1000, tokens seen: 51.77M, val_loss:nan train_time:277.00s step_avg:355ms
step:800/1000, tokens seen:52.36M, avg_train_loss:nan time:3104/355s step_avg:355ms
step:800/1000, tokens seen: 52.43M, val_loss:nan train_time:280.54s step_avg:355ms
step:810/1000, tokens seen:53.02M, avg_train_loss:nan time:3142/355s step_avg:355ms
step:810/1000, tokens seen: 53.08M, val_loss:nan train_time:284.08s step_avg:355ms
step:820/1000, tokens seen:53.67M, avg_train_loss:nan time:3181/355s step_avg:355ms
step:820/1000, tokens seen: 53.74M, val_loss:nan train_time:287.63s step_avg:355ms
step:830/1000, tokens seen:54.33M, avg_train_loss:nan time:3219/355s step_avg:355ms
step:830/1000, tokens seen: 54.39M, val_loss:nan train_time:291.17s step_avg:355ms
step:840/1000, tokens seen:54.98M, avg_train_loss:nan time:3257/355s step_avg:355ms
step:840/1000, tokens seen: 55.05M, val_loss:nan train_time:294.72s step_avg:355ms
step:850/1000, tokens seen:55.64M, avg_train_loss:nan time:3296/355s step_avg:355ms
step:850/1000, tokens seen: 55.71M, val_loss:nan train_time:298.27s step_avg:355ms
step:860/1000, tokens seen:56.30M, avg_train_loss:nan time:3334/355s step_avg:355ms
step:860/1000, tokens seen: 56.36M, val_loss:nan train_time:301.81s step_avg:355ms
step:870/1000, tokens seen:56.95M, avg_train_loss:nan time:3372/355s step_avg:355ms
step:870/1000, tokens seen: 57.02M, val_loss:nan train_time:305.36s step_avg:355ms
step:880/1000, tokens seen:57.61M, avg_train_loss:nan time:3411/355s step_avg:355ms
step:880/1000, tokens seen: 57.67M, val_loss:nan train_time:308.90s step_avg:355ms
step:890/1000, tokens seen:58.26M, avg_train_loss:nan time:3449/355s step_avg:355ms
step:890/1000, tokens seen: 58.33M, val_loss:nan train_time:312.44s step_avg:355ms
step:900/1000, tokens seen:58.92M, avg_train_loss:nan time:3488/355s step_avg:355ms
step:900/1000, tokens seen: 58.98M, val_loss:nan train_time:315.99s step_avg:355ms
step:910/1000, tokens seen:59.57M, avg_train_loss:nan time:3526/355s step_avg:355ms
step:910/1000, tokens seen: 59.64M, val_loss:nan train_time:319.53s step_avg:355ms
step:920/1000, tokens seen:60.23M, avg_train_loss:nan time:3564/355s step_avg:355ms
step:920/1000, tokens seen: 60.29M, val_loss:nan train_time:323.08s step_avg:355ms
step:930/1000, tokens seen:60.88M, avg_train_loss:nan time:3603/355s step_avg:355ms
step:930/1000, tokens seen: 60.95M, val_loss:nan train_time:326.62s step_avg:355ms
step:940/1000, tokens seen:61.54M, avg_train_loss:nan time:3641/355s step_avg:355ms
step:940/1000, tokens seen: 61.60M, val_loss:nan train_time:330.17s step_avg:355ms
step:950/1000, tokens seen:62.19M, avg_train_loss:nan time:3679/355s step_avg:355ms
step:950/1000, tokens seen: 62.26M, val_loss:nan train_time:333.72s step_avg:355ms
step:960/1000, tokens seen:62.85M, avg_train_loss:nan time:3718/355s step_avg:355ms
step:960/1000, tokens seen: 62.91M, val_loss:nan train_time:337.26s step_avg:355ms
step:970/1000, tokens seen:63.50M, avg_train_loss:nan time:3756/355s step_avg:355ms
step:970/1000, tokens seen: 63.57M, val_loss:nan train_time:340.81s step_avg:355ms
step:980/1000, tokens seen:64.16M, avg_train_loss:nan time:3794/355s step_avg:355ms
step:980/1000, tokens seen: 64.23M, val_loss:nan train_time:344.35s step_avg:355ms
step:990/1000, tokens seen:64.82M, avg_train_loss:nan time:3833/355s step_avg:355ms
step:990/1000, tokens seen: 64.88M, val_loss:nan train_time:347.99s step_avg:355ms
step:1000/1000, tokens seen:65.47M, avg_train_loss:nan time:3871/355s step_avg:355ms
step:1000/1000, tokens seen: 65.54M, val_loss:nan train_time:351.55s step_avg:355ms
Total training time: 3906.26s
peak memory consumption: 31760 MiB
