W0216 01:12:21.400688 140216651933504 torch/distributed/run.py:779] 
W0216 01:12:21.400688 140216651933504 torch/distributed/run.py:779] *****************************************
W0216 01:12:21.400688 140216651933504 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 01:12:21.400688 140216651933504 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 0] Training DataLoader: 2700000000 tokens across 27 files.
[Rank 0] Validation DataLoader: 100000000 tokens across 1 files.
[Rank 1] Using device: cuda:1
[Rank 0] Model wrapped in DDP.
k params lengths: head = 1, attn = 0
Tokenizer vocab size: 50304
head.k is learned with 10.0 lr

=== Report ===
Model Size:    162.20M

Data Path:            data/fineweb10B
Sequence Length:      1024
Batch Size (global):  64
Batch Size (device):  16
n_layers:              12
n_heads:               6
head_dim:             128
n_embd:               768
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/4353_fw_he_k1.0_lr1e+01_s0/
Writing logs to: runs/02.16/4353_fw_he_k1.0_lr1e+01_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:10.9369 train_time:0.20s step_avg:nanms
step:10/1000, tokens seen:0.59M, avg_train_loss:9.5642 time:78/nans step_avg:nanms
step:10/1000, tokens seen: 0.66M, val_loss:8.2920 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:1.25M, avg_train_loss:7.9181 time:85/139s step_avg:139ms
step:20/1000, tokens seen: 1.31M, val_loss:7.5934 train_time:1.39s step_avg:139ms
step:30/1000, tokens seen:1.90M, avg_train_loss:7.4402 time:92/139s step_avg:139ms
step:30/1000, tokens seen: 1.97M, val_loss:7.2887 train_time:2.78s step_avg:139ms
step:40/1000, tokens seen:2.56M, avg_train_loss:7.1912 time:99/139s step_avg:139ms
step:40/1000, tokens seen: 2.62M, val_loss:7.0875 train_time:4.18s step_avg:139ms
step:50/1000, tokens seen:3.21M, avg_train_loss:6.8727 time:106/139s step_avg:139ms
step:50/1000, tokens seen: 3.28M, val_loss:6.9500 train_time:5.57s step_avg:139ms
step:60/1000, tokens seen:3.87M, avg_train_loss:6.8644 time:113/139s step_avg:139ms
step:60/1000, tokens seen: 3.93M, val_loss:6.8286 train_time:6.96s step_avg:139ms
step:70/1000, tokens seen:4.52M, avg_train_loss:6.7400 time:120/139s step_avg:139ms
step:70/1000, tokens seen: 4.59M, val_loss:6.7382 train_time:8.36s step_avg:139ms
step:80/1000, tokens seen:5.18M, avg_train_loss:6.6340 time:127/139s step_avg:139ms
step:80/1000, tokens seen: 5.24M, val_loss:6.6455 train_time:9.75s step_avg:139ms
step:90/1000, tokens seen:5.83M, avg_train_loss:6.6251 time:134/139s step_avg:139ms
step:90/1000, tokens seen: 5.90M, val_loss:6.5726 train_time:11.14s step_avg:139ms
step:100/1000, tokens seen:6.49M, avg_train_loss:6.5026 time:141/139s step_avg:139ms
step:100/1000, tokens seen: 6.55M, val_loss:6.5126 train_time:12.53s step_avg:139ms
step:110/1000, tokens seen:7.14M, avg_train_loss:6.4744 time:149/139s step_avg:139ms
step:110/1000, tokens seen: 7.21M, val_loss:6.4438 train_time:13.93s step_avg:139ms
step:120/1000, tokens seen:7.80M, avg_train_loss:6.3558 time:156/139s step_avg:139ms
step:120/1000, tokens seen: 7.86M, val_loss:6.3872 train_time:15.32s step_avg:139ms
step:130/1000, tokens seen:8.45M, avg_train_loss:6.3176 time:163/139s step_avg:139ms
step:130/1000, tokens seen: 8.52M, val_loss:6.3395 train_time:16.72s step_avg:139ms
step:140/1000, tokens seen:9.11M, avg_train_loss:6.1898 time:170/139s step_avg:139ms
step:140/1000, tokens seen: 9.18M, val_loss:6.3046 train_time:18.11s step_avg:139ms
step:150/1000, tokens seen:9.76M, avg_train_loss:6.3566 time:177/139s step_avg:139ms
step:150/1000, tokens seen: 9.83M, val_loss:6.2628 train_time:19.50s step_avg:139ms
step:160/1000, tokens seen:10.42M, avg_train_loss:6.1565 time:184/139s step_avg:139ms
step:160/1000, tokens seen: 10.49M, val_loss:6.2179 train_time:20.90s step_avg:139ms
step:170/1000, tokens seen:11.08M, avg_train_loss:6.2644 time:191/139s step_avg:139ms
step:170/1000, tokens seen: 11.14M, val_loss:6.1941 train_time:22.29s step_avg:139ms
step:180/1000, tokens seen:11.73M, avg_train_loss:6.1987 time:198/139s step_avg:139ms
step:180/1000, tokens seen: 11.80M, val_loss:6.1599 train_time:23.68s step_avg:139ms
step:190/1000, tokens seen:12.39M, avg_train_loss:6.1851 time:205/139s step_avg:139ms
step:190/1000, tokens seen: 12.45M, val_loss:6.1246 train_time:25.08s step_avg:139ms
step:200/1000, tokens seen:13.04M, avg_train_loss:6.0752 time:212/139s step_avg:139ms
step:200/1000, tokens seen: 13.11M, val_loss:6.0913 train_time:26.47s step_avg:139ms
step:210/1000, tokens seen:13.70M, avg_train_loss:6.1433 time:219/139s step_avg:139ms
step:210/1000, tokens seen: 13.76M, val_loss:6.0650 train_time:27.86s step_avg:139ms
step:220/1000, tokens seen:14.35M, avg_train_loss:6.0315 time:226/139s step_avg:139ms
step:220/1000, tokens seen: 14.42M, val_loss:6.0334 train_time:29.25s step_avg:139ms
step:230/1000, tokens seen:15.01M, avg_train_loss:6.0236 time:233/139s step_avg:139ms
step:230/1000, tokens seen: 15.07M, val_loss:6.0111 train_time:30.65s step_avg:139ms
step:240/1000, tokens seen:15.66M, avg_train_loss:5.9924 time:240/139s step_avg:139ms
step:240/1000, tokens seen: 15.73M, val_loss:5.9843 train_time:32.04s step_avg:139ms
step:250/1000, tokens seen:16.32M, avg_train_loss:5.8761 time:247/139s step_avg:139ms
step:250/1000, tokens seen: 16.38M, val_loss:5.9589 train_time:33.43s step_avg:139ms
step:260/1000, tokens seen:16.97M, avg_train_loss:6.0010 time:254/139s step_avg:139ms
step:260/1000, tokens seen: 17.04M, val_loss:5.9356 train_time:34.82s step_avg:139ms
step:270/1000, tokens seen:17.63M, avg_train_loss:5.9354 time:261/139s step_avg:139ms
step:270/1000, tokens seen: 17.69M, val_loss:5.9178 train_time:36.21s step_avg:139ms
step:280/1000, tokens seen:18.28M, avg_train_loss:6.0399 time:268/139s step_avg:139ms
step:280/1000, tokens seen: 18.35M, val_loss:5.8934 train_time:37.61s step_avg:139ms
step:290/1000, tokens seen:18.94M, avg_train_loss:5.9311 time:275/139s step_avg:139ms
step:290/1000, tokens seen: 19.01M, val_loss:5.8732 train_time:39.00s step_avg:139ms
step:300/1000, tokens seen:19.60M, avg_train_loss:5.8144 time:282/139s step_avg:139ms
step:300/1000, tokens seen: 19.66M, val_loss:5.8564 train_time:40.39s step_avg:139ms
step:310/1000, tokens seen:20.25M, avg_train_loss:5.9129 time:289/139s step_avg:139ms
step:310/1000, tokens seen: 20.32M, val_loss:5.8324 train_time:41.79s step_avg:139ms
step:320/1000, tokens seen:20.91M, avg_train_loss:5.8289 time:296/139s step_avg:139ms
step:320/1000, tokens seen: 20.97M, val_loss:5.8128 train_time:43.19s step_avg:139ms
step:330/1000, tokens seen:21.56M, avg_train_loss:5.8516 time:303/139s step_avg:139ms
step:330/1000, tokens seen: 21.63M, val_loss:5.7950 train_time:44.58s step_avg:139ms
step:340/1000, tokens seen:22.22M, avg_train_loss:5.7653 time:310/139s step_avg:139ms
step:340/1000, tokens seen: 22.28M, val_loss:5.7735 train_time:45.98s step_avg:139ms
step:350/1000, tokens seen:22.87M, avg_train_loss:5.7058 time:317/139s step_avg:139ms
step:350/1000, tokens seen: 22.94M, val_loss:5.7557 train_time:47.37s step_avg:139ms
step:360/1000, tokens seen:23.53M, avg_train_loss:5.6986 time:324/139s step_avg:139ms
step:360/1000, tokens seen: 23.59M, val_loss:5.7443 train_time:48.76s step_avg:139ms
step:370/1000, tokens seen:24.18M, avg_train_loss:5.8038 time:332/139s step_avg:139ms
step:370/1000, tokens seen: 24.25M, val_loss:5.7236 train_time:50.15s step_avg:139ms
step:380/1000, tokens seen:24.84M, avg_train_loss:5.7324 time:339/139s step_avg:139ms
step:380/1000, tokens seen: 24.90M, val_loss:5.7057 train_time:51.54s step_avg:139ms
step:390/1000, tokens seen:25.49M, avg_train_loss:5.4947 time:346/139s step_avg:139ms
step:390/1000, tokens seen: 25.56M, val_loss:5.6943 train_time:52.93s step_avg:139ms
step:400/1000, tokens seen:26.15M, avg_train_loss:5.6170 time:353/139s step_avg:139ms
step:400/1000, tokens seen: 26.21M, val_loss:5.6754 train_time:54.33s step_avg:139ms
step:410/1000, tokens seen:26.80M, avg_train_loss:5.6072 time:360/139s step_avg:139ms
step:410/1000, tokens seen: 26.87M, val_loss:5.6697 train_time:55.72s step_avg:139ms
step:420/1000, tokens seen:27.46M, avg_train_loss:5.6840 time:367/139s step_avg:139ms
step:420/1000, tokens seen: 27.53M, val_loss:5.6573 train_time:57.12s step_avg:139ms
step:430/1000, tokens seen:28.11M, avg_train_loss:5.6797 time:374/139s step_avg:139ms
step:430/1000, tokens seen: 28.18M, val_loss:5.6343 train_time:58.51s step_avg:139ms
step:440/1000, tokens seen:28.77M, avg_train_loss:5.6356 time:381/139s step_avg:139ms
step:440/1000, tokens seen: 28.84M, val_loss:5.6206 train_time:59.90s step_avg:139ms
step:450/1000, tokens seen:29.43M, avg_train_loss:5.5774 time:388/139s step_avg:139ms
step:450/1000, tokens seen: 29.49M, val_loss:5.6026 train_time:61.30s step_avg:139ms
step:460/1000, tokens seen:30.08M, avg_train_loss:5.6382 time:395/139s step_avg:139ms
step:460/1000, tokens seen: 30.15M, val_loss:5.5869 train_time:62.70s step_avg:139ms
step:470/1000, tokens seen:30.74M, avg_train_loss:5.4719 time:402/139s step_avg:139ms
step:470/1000, tokens seen: 30.80M, val_loss:5.5735 train_time:64.09s step_avg:139ms
step:480/1000, tokens seen:31.39M, avg_train_loss:5.5565 time:409/139s step_avg:139ms
step:480/1000, tokens seen: 31.46M, val_loss:5.5607 train_time:65.48s step_avg:139ms
step:490/1000, tokens seen:32.05M, avg_train_loss:5.5456 time:416/139s step_avg:139ms
step:490/1000, tokens seen: 32.11M, val_loss:5.5480 train_time:66.87s step_avg:139ms
step:500/1000, tokens seen:32.70M, avg_train_loss:5.5379 time:423/139s step_avg:139ms
step:500/1000, tokens seen: 32.77M, val_loss:5.5340 train_time:68.26s step_avg:139ms
step:510/1000, tokens seen:33.36M, avg_train_loss:5.6866 time:430/139s step_avg:139ms
step:510/1000, tokens seen: 33.42M, val_loss:5.5340 train_time:69.66s step_avg:139ms
step:520/1000, tokens seen:34.01M, avg_train_loss:5.5714 time:437/139s step_avg:139ms
step:520/1000, tokens seen: 34.08M, val_loss:5.5232 train_time:71.05s step_avg:139ms
step:530/1000, tokens seen:34.67M, avg_train_loss:5.5108 time:444/139s step_avg:139ms
step:530/1000, tokens seen: 34.73M, val_loss:5.5091 train_time:72.44s step_avg:139ms
step:540/1000, tokens seen:35.32M, avg_train_loss:5.5724 time:451/139s step_avg:139ms
step:540/1000, tokens seen: 35.39M, val_loss:5.5112 train_time:73.83s step_avg:139ms
step:550/1000, tokens seen:35.98M, avg_train_loss:5.6296 time:458/139s step_avg:139ms
step:550/1000, tokens seen: 36.04M, val_loss:5.4930 train_time:75.22s step_avg:139ms
step:560/1000, tokens seen:36.63M, avg_train_loss:5.5204 time:465/139s step_avg:139ms
step:560/1000, tokens seen: 36.70M, val_loss:5.4792 train_time:76.61s step_avg:139ms
step:570/1000, tokens seen:37.29M, avg_train_loss:5.4332 time:472/139s step_avg:139ms
step:570/1000, tokens seen: 37.36M, val_loss:5.4667 train_time:78.00s step_avg:139ms
step:580/1000, tokens seen:37.95M, avg_train_loss:5.4783 time:479/139s step_avg:139ms
step:580/1000, tokens seen: 38.01M, val_loss:5.4636 train_time:79.39s step_avg:139ms
step:590/1000, tokens seen:38.60M, avg_train_loss:5.3578 time:486/139s step_avg:139ms
step:590/1000, tokens seen: 38.67M, val_loss:5.4495 train_time:80.79s step_avg:139ms
step:600/1000, tokens seen:39.26M, avg_train_loss:5.4705 time:493/139s step_avg:139ms
step:600/1000, tokens seen: 39.32M, val_loss:5.4397 train_time:82.18s step_avg:139ms
step:610/1000, tokens seen:39.91M, avg_train_loss:5.5076 time:500/139s step_avg:139ms
step:610/1000, tokens seen: 39.98M, val_loss:5.4347 train_time:83.57s step_avg:139ms
step:620/1000, tokens seen:40.57M, avg_train_loss:5.4679 time:507/139s step_avg:139ms
step:620/1000, tokens seen: 40.63M, val_loss:5.4259 train_time:84.96s step_avg:139ms
step:630/1000, tokens seen:41.22M, avg_train_loss:5.3026 time:514/139s step_avg:139ms
step:630/1000, tokens seen: 41.29M, val_loss:5.4258 train_time:86.35s step_avg:139ms
step:640/1000, tokens seen:41.88M, avg_train_loss:5.3718 time:521/139s step_avg:139ms
step:640/1000, tokens seen: 41.94M, val_loss:5.4082 train_time:87.74s step_avg:139ms
step:650/1000, tokens seen:42.53M, avg_train_loss:5.2898 time:528/139s step_avg:139ms
step:650/1000, tokens seen: 42.60M, val_loss:5.3938 train_time:89.14s step_avg:139ms
step:660/1000, tokens seen:43.19M, avg_train_loss:5.4275 time:535/139s step_avg:139ms
step:660/1000, tokens seen: 43.25M, val_loss:5.3862 train_time:90.53s step_avg:139ms
step:670/1000, tokens seen:43.84M, avg_train_loss:5.4557 time:543/139s step_avg:139ms
step:670/1000, tokens seen: 43.91M, val_loss:5.3726 train_time:91.92s step_avg:139ms
step:680/1000, tokens seen:44.50M, avg_train_loss:5.4194 time:550/139s step_avg:139ms
step:680/1000, tokens seen: 44.56M, val_loss:5.3603 train_time:93.31s step_avg:139ms
step:690/1000, tokens seen:45.15M, avg_train_loss:5.4210 time:557/139s step_avg:139ms
step:690/1000, tokens seen: 45.22M, val_loss:5.3497 train_time:94.70s step_avg:139ms
step:700/1000, tokens seen:45.81M, avg_train_loss:5.3214 time:564/139s step_avg:139ms
step:700/1000, tokens seen: 45.88M, val_loss:5.3401 train_time:96.10s step_avg:139ms
step:710/1000, tokens seen:46.47M, avg_train_loss:5.3810 time:571/139s step_avg:139ms
step:710/1000, tokens seen: 46.53M, val_loss:5.3322 train_time:97.49s step_avg:139ms
step:720/1000, tokens seen:47.12M, avg_train_loss:5.2933 time:578/139s step_avg:139ms
step:720/1000, tokens seen: 47.19M, val_loss:5.3268 train_time:98.88s step_avg:139ms
step:730/1000, tokens seen:47.78M, avg_train_loss:5.3231 time:585/139s step_avg:139ms
step:730/1000, tokens seen: 47.84M, val_loss:5.3146 train_time:100.27s step_avg:139ms
step:740/1000, tokens seen:48.43M, avg_train_loss:5.3740 time:592/139s step_avg:139ms
step:740/1000, tokens seen: 48.50M, val_loss:5.3065 train_time:101.66s step_avg:139ms
step:750/1000, tokens seen:49.09M, avg_train_loss:5.2726 time:599/139s step_avg:139ms
step:750/1000, tokens seen: 49.15M, val_loss:5.3002 train_time:103.05s step_avg:139ms
step:760/1000, tokens seen:49.74M, avg_train_loss:5.2869 time:606/139s step_avg:139ms
step:760/1000, tokens seen: 49.81M, val_loss:5.2905 train_time:104.45s step_avg:139ms
step:770/1000, tokens seen:50.40M, avg_train_loss:5.2450 time:613/139s step_avg:139ms
step:770/1000, tokens seen: 50.46M, val_loss:5.2822 train_time:105.84s step_avg:139ms
step:780/1000, tokens seen:51.05M, avg_train_loss:5.3182 time:620/139s step_avg:139ms
step:780/1000, tokens seen: 51.12M, val_loss:5.2737 train_time:107.23s step_avg:139ms
step:790/1000, tokens seen:51.71M, avg_train_loss:5.2438 time:627/139s step_avg:139ms
step:790/1000, tokens seen: 51.77M, val_loss:5.2663 train_time:108.62s step_avg:139ms
step:800/1000, tokens seen:52.36M, avg_train_loss:5.1542 time:634/139s step_avg:139ms
step:800/1000, tokens seen: 52.43M, val_loss:5.2601 train_time:110.01s step_avg:139ms
step:810/1000, tokens seen:53.02M, avg_train_loss:5.1621 time:641/139s step_avg:139ms
step:810/1000, tokens seen: 53.08M, val_loss:5.2573 train_time:111.40s step_avg:139ms
step:820/1000, tokens seen:53.67M, avg_train_loss:5.2088 time:648/139s step_avg:139ms
step:820/1000, tokens seen: 53.74M, val_loss:5.2486 train_time:112.79s step_avg:139ms
step:830/1000, tokens seen:54.33M, avg_train_loss:5.1786 time:655/139s step_avg:139ms
step:830/1000, tokens seen: 54.39M, val_loss:5.2451 train_time:114.18s step_avg:139ms
step:840/1000, tokens seen:54.98M, avg_train_loss:5.2983 time:662/139s step_avg:139ms
step:840/1000, tokens seen: 55.05M, val_loss:5.2361 train_time:115.57s step_avg:139ms
step:850/1000, tokens seen:55.64M, avg_train_loss:5.3023 time:669/139s step_avg:139ms
step:850/1000, tokens seen: 55.71M, val_loss:5.2289 train_time:116.96s step_avg:139ms
step:860/1000, tokens seen:56.30M, avg_train_loss:5.2670 time:676/139s step_avg:139ms
step:860/1000, tokens seen: 56.36M, val_loss:5.2232 train_time:118.35s step_avg:139ms
step:870/1000, tokens seen:56.95M, avg_train_loss:5.3407 time:683/139s step_avg:139ms
step:870/1000, tokens seen: 57.02M, val_loss:5.2165 train_time:119.74s step_avg:139ms
step:880/1000, tokens seen:57.61M, avg_train_loss:5.2039 time:690/139s step_avg:139ms
step:880/1000, tokens seen: 57.67M, val_loss:5.2106 train_time:121.13s step_avg:139ms
step:890/1000, tokens seen:58.26M, avg_train_loss:5.2349 time:697/139s step_avg:139ms
step:890/1000, tokens seen: 58.33M, val_loss:5.2046 train_time:122.52s step_avg:139ms
step:900/1000, tokens seen:58.92M, avg_train_loss:5.2604 time:704/139s step_avg:139ms
step:900/1000, tokens seen: 58.98M, val_loss:5.1990 train_time:123.91s step_avg:139ms
step:910/1000, tokens seen:59.57M, avg_train_loss:5.1347 time:711/139s step_avg:139ms
step:910/1000, tokens seen: 59.64M, val_loss:5.1947 train_time:125.30s step_avg:139ms
step:920/1000, tokens seen:60.23M, avg_train_loss:5.2760 time:718/139s step_avg:139ms
step:920/1000, tokens seen: 60.29M, val_loss:5.1890 train_time:126.69s step_avg:139ms
step:930/1000, tokens seen:60.88M, avg_train_loss:5.1684 time:725/139s step_avg:139ms
step:930/1000, tokens seen: 60.95M, val_loss:5.1843 train_time:128.08s step_avg:139ms
step:940/1000, tokens seen:61.54M, avg_train_loss:5.1644 time:732/139s step_avg:139ms
step:940/1000, tokens seen: 61.60M, val_loss:5.1798 train_time:129.47s step_avg:139ms
step:950/1000, tokens seen:62.19M, avg_train_loss:5.1299 time:739/139s step_avg:139ms
step:950/1000, tokens seen: 62.26M, val_loss:5.1750 train_time:130.86s step_avg:139ms
step:960/1000, tokens seen:62.85M, avg_train_loss:5.1218 time:746/139s step_avg:139ms
step:960/1000, tokens seen: 62.91M, val_loss:5.1714 train_time:132.27s step_avg:139ms
step:970/1000, tokens seen:63.50M, avg_train_loss:5.2129 time:753/139s step_avg:139ms
step:970/1000, tokens seen: 63.57M, val_loss:5.1673 train_time:133.66s step_avg:139ms
step:980/1000, tokens seen:64.16M, avg_train_loss:5.0720 time:760/139s step_avg:139ms
step:980/1000, tokens seen: 64.23M, val_loss:5.1639 train_time:135.05s step_avg:139ms
step:990/1000, tokens seen:64.82M, avg_train_loss:5.2258 time:767/139s step_avg:139ms
step:990/1000, tokens seen: 64.88M, val_loss:5.1607 train_time:136.44s step_avg:139ms
step:1000/1000, tokens seen:65.47M, avg_train_loss:5.1420 time:775/139s step_avg:139ms
step:1000/1000, tokens seen: 65.54M, val_loss:5.1580 train_time:137.83s step_avg:139ms
Total training time: 782.25s
peak memory consumption: 30699 MiB
