W0216 06:10:46.391052 140301291992896 torch/distributed/run.py:779] 
W0216 06:10:46.391052 140301291992896 torch/distributed/run.py:779] *****************************************
W0216 06:10:46.391052 140301291992896 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0216 06:10:46.391052 140301291992896 torch/distributed/run.py:779] *****************************************
[Rank 0] Using device: cuda:0
[Rank 0] This is the master process.
[Rank 1] Using device: cuda:1
[Rank 0] Training DataLoader: 611289391 tokens across 1 files.
[Rank 0] Validation DataLoader: 6150326 tokens across 1 files.
[Rank 0] Model wrapped in DDP.
k params lengths: head = 1, attn = 6
Tokenizer vocab size: 1000
attn.k is learned

=== Report ===
Model Size:    3.04M

Data Path:            data/tinystories
Sequence Length:      1024
Batch Size (global):  64
Batch Size (device):  32
n_layers:              6
n_heads:               6
head_dim:             32
n_embd:               192
Seed:                 0
==============================

Logs for this run will be stored in: runs/02.16/22261_ts_hh_k1.0_lr1e+01_s0/
Writing logs to: runs/02.16/22261_ts_hh_k1.0_lr1e+01_s0/tensorboard_logs
step:0/1000, tokens seen: 0.00M, val_loss:7.0006 train_time:1.20s step_avg:nanms
step:10/1000, tokens seen:0.59M, avg_train_loss:5.6132 time:68/nans step_avg:nanms
step:10/1000, tokens seen: 0.66M, val_loss:4.7914 train_time:0.00s step_avg:nanms
step:20/1000, tokens seen:1.25M, avg_train_loss:4.5974 time:106/356s step_avg:356ms
step:20/1000, tokens seen: 1.31M, val_loss:4.3980 train_time:3.56s step_avg:356ms
step:30/1000, tokens seen:1.90M, avg_train_loss:4.2728 time:145/356s step_avg:356ms
step:30/1000, tokens seen: 1.97M, val_loss:4.1775 train_time:7.13s step_avg:356ms
step:40/1000, tokens seen:2.56M, avg_train_loss:4.0863 time:183/356s step_avg:356ms
step:40/1000, tokens seen: 2.62M, val_loss:4.0360 train_time:10.69s step_avg:356ms
step:50/1000, tokens seen:3.21M, avg_train_loss:3.9368 time:222/356s step_avg:356ms
step:50/1000, tokens seen: 3.28M, val_loss:3.9417 train_time:14.25s step_avg:356ms
step:60/1000, tokens seen:3.87M, avg_train_loss:3.8646 time:260/356s step_avg:356ms
step:60/1000, tokens seen: 3.93M, val_loss:3.8571 train_time:17.82s step_avg:356ms
step:70/1000, tokens seen:4.52M, avg_train_loss:3.7854 time:298/356s step_avg:356ms
step:70/1000, tokens seen: 4.59M, val_loss:3.7941 train_time:21.38s step_avg:356ms
step:80/1000, tokens seen:5.18M, avg_train_loss:3.7532 time:337/356s step_avg:356ms
step:80/1000, tokens seen: 5.24M, val_loss:3.7552 train_time:24.94s step_avg:356ms
step:90/1000, tokens seen:5.83M, avg_train_loss:3.6709 time:375/356s step_avg:356ms
step:90/1000, tokens seen: 5.90M, val_loss:3.7013 train_time:28.51s step_avg:356ms
step:100/1000, tokens seen:6.49M, avg_train_loss:3.7066 time:414/356s step_avg:356ms
step:100/1000, tokens seen: 6.55M, val_loss:3.6758 train_time:32.07s step_avg:356ms
step:110/1000, tokens seen:7.14M, avg_train_loss:3.6615 time:452/356s step_avg:356ms
step:110/1000, tokens seen: 7.21M, val_loss:3.6351 train_time:35.63s step_avg:356ms
step:120/1000, tokens seen:7.80M, avg_train_loss:3.6245 time:490/356s step_avg:356ms
step:120/1000, tokens seen: 7.86M, val_loss:3.6041 train_time:39.20s step_avg:356ms
step:130/1000, tokens seen:8.45M, avg_train_loss:3.5503 time:529/356s step_avg:356ms
step:130/1000, tokens seen: 8.52M, val_loss:3.5929 train_time:42.76s step_avg:356ms
step:140/1000, tokens seen:9.11M, avg_train_loss:3.5166 time:567/356s step_avg:356ms
step:140/1000, tokens seen: 9.18M, val_loss:3.5513 train_time:46.32s step_avg:356ms
step:150/1000, tokens seen:9.76M, avg_train_loss:3.5050 time:606/356s step_avg:356ms
step:150/1000, tokens seen: 9.83M, val_loss:3.5303 train_time:49.89s step_avg:356ms
step:160/1000, tokens seen:10.42M, avg_train_loss:3.5424 time:644/356s step_avg:356ms
step:160/1000, tokens seen: 10.49M, val_loss:3.5051 train_time:53.45s step_avg:356ms
step:170/1000, tokens seen:11.08M, avg_train_loss:3.4427 time:682/356s step_avg:356ms
step:170/1000, tokens seen: 11.14M, val_loss:3.4885 train_time:57.01s step_avg:356ms
step:180/1000, tokens seen:11.73M, avg_train_loss:3.4506 time:721/356s step_avg:356ms
step:180/1000, tokens seen: 11.80M, val_loss:3.4640 train_time:60.58s step_avg:356ms
step:190/1000, tokens seen:12.39M, avg_train_loss:3.4852 time:759/356s step_avg:356ms
step:190/1000, tokens seen: 12.45M, val_loss:3.4447 train_time:64.14s step_avg:356ms
step:200/1000, tokens seen:13.04M, avg_train_loss:3.4430 time:798/356s step_avg:356ms
step:200/1000, tokens seen: 13.11M, val_loss:3.4171 train_time:67.70s step_avg:356ms
step:210/1000, tokens seen:13.70M, avg_train_loss:3.4600 time:836/356s step_avg:356ms
step:210/1000, tokens seen: 13.76M, val_loss:3.4068 train_time:71.27s step_avg:356ms
step:220/1000, tokens seen:14.35M, avg_train_loss:3.3932 time:874/356s step_avg:356ms
step:220/1000, tokens seen: 14.42M, val_loss:3.3739 train_time:74.83s step_avg:356ms
step:230/1000, tokens seen:15.01M, avg_train_loss:3.3682 time:913/356s step_avg:356ms
step:230/1000, tokens seen: 15.07M, val_loss:3.3464 train_time:78.39s step_avg:356ms
step:240/1000, tokens seen:15.66M, avg_train_loss:3.3315 time:951/356s step_avg:356ms
step:240/1000, tokens seen: 15.73M, val_loss:3.3341 train_time:81.96s step_avg:356ms
step:250/1000, tokens seen:16.32M, avg_train_loss:3.2602 time:990/356s step_avg:356ms
step:250/1000, tokens seen: 16.38M, val_loss:3.2838 train_time:85.52s step_avg:356ms
step:260/1000, tokens seen:16.97M, avg_train_loss:3.2186 time:1028/356s step_avg:356ms
step:260/1000, tokens seen: 17.04M, val_loss:3.2691 train_time:89.09s step_avg:356ms
step:270/1000, tokens seen:17.63M, avg_train_loss:3.3002 time:1066/356s step_avg:356ms
step:270/1000, tokens seen: 17.69M, val_loss:3.2553 train_time:92.65s step_avg:356ms
step:280/1000, tokens seen:18.28M, avg_train_loss:3.2600 time:1105/356s step_avg:356ms
step:280/1000, tokens seen: 18.35M, val_loss:3.2230 train_time:96.21s step_avg:356ms
step:290/1000, tokens seen:18.94M, avg_train_loss:3.2778 time:1143/356s step_avg:356ms
step:290/1000, tokens seen: 19.01M, val_loss:3.1877 train_time:99.78s step_avg:356ms
step:300/1000, tokens seen:19.60M, avg_train_loss:3.1341 time:1182/356s step_avg:356ms
step:300/1000, tokens seen: 19.66M, val_loss:3.1696 train_time:103.34s step_avg:356ms
step:310/1000, tokens seen:20.25M, avg_train_loss:3.1931 time:1220/356s step_avg:356ms
step:310/1000, tokens seen: 20.32M, val_loss:3.1524 train_time:106.91s step_avg:356ms
step:320/1000, tokens seen:20.91M, avg_train_loss:3.1337 time:1258/356s step_avg:356ms
step:320/1000, tokens seen: 20.97M, val_loss:3.1170 train_time:110.47s step_avg:356ms
step:330/1000, tokens seen:21.56M, avg_train_loss:3.1321 time:1297/356s step_avg:356ms
step:330/1000, tokens seen: 21.63M, val_loss:3.1240 train_time:114.03s step_avg:356ms
step:340/1000, tokens seen:22.22M, avg_train_loss:3.0784 time:1335/356s step_avg:356ms
step:340/1000, tokens seen: 22.28M, val_loss:3.0625 train_time:117.59s step_avg:356ms
step:350/1000, tokens seen:22.87M, avg_train_loss:3.1354 time:1374/356s step_avg:356ms
step:350/1000, tokens seen: 22.94M, val_loss:3.0696 train_time:121.16s step_avg:356ms
step:360/1000, tokens seen:23.53M, avg_train_loss:3.0783 time:1412/356s step_avg:356ms
step:360/1000, tokens seen: 23.59M, val_loss:3.0174 train_time:124.72s step_avg:356ms
step:370/1000, tokens seen:24.18M, avg_train_loss:2.9534 time:1450/356s step_avg:356ms
step:370/1000, tokens seen: 24.25M, val_loss:2.9981 train_time:128.29s step_avg:356ms
step:380/1000, tokens seen:24.84M, avg_train_loss:3.0663 time:1489/356s step_avg:356ms
step:380/1000, tokens seen: 24.90M, val_loss:2.9770 train_time:131.85s step_avg:356ms
step:390/1000, tokens seen:25.49M, avg_train_loss:3.0308 time:1527/356s step_avg:356ms
step:390/1000, tokens seen: 25.56M, val_loss:2.9458 train_time:135.41s step_avg:356ms
step:400/1000, tokens seen:26.15M, avg_train_loss:2.9336 time:1566/356s step_avg:356ms
step:400/1000, tokens seen: 26.21M, val_loss:2.9280 train_time:138.97s step_avg:356ms
step:410/1000, tokens seen:26.80M, avg_train_loss:2.8330 time:1604/356s step_avg:356ms
step:410/1000, tokens seen: 26.87M, val_loss:2.9065 train_time:142.54s step_avg:356ms
step:420/1000, tokens seen:27.46M, avg_train_loss:2.8015 time:1642/356s step_avg:356ms
step:420/1000, tokens seen: 27.53M, val_loss:2.8846 train_time:146.10s step_avg:356ms
step:430/1000, tokens seen:28.11M, avg_train_loss:nan time:1681/356s step_avg:356ms
step:430/1000, tokens seen: 28.18M, val_loss:nan train_time:149.67s step_avg:356ms
step:440/1000, tokens seen:28.77M, avg_train_loss:nan time:1719/356s step_avg:356ms
step:440/1000, tokens seen: 28.84M, val_loss:nan train_time:153.22s step_avg:356ms
step:450/1000, tokens seen:29.43M, avg_train_loss:nan time:1758/356s step_avg:356ms
step:450/1000, tokens seen: 29.49M, val_loss:nan train_time:156.77s step_avg:356ms
step:460/1000, tokens seen:30.08M, avg_train_loss:nan time:1796/356s step_avg:356ms
step:460/1000, tokens seen: 30.15M, val_loss:nan train_time:160.33s step_avg:356ms
step:470/1000, tokens seen:30.74M, avg_train_loss:nan time:1834/356s step_avg:356ms
step:470/1000, tokens seen: 30.80M, val_loss:nan train_time:163.88s step_avg:356ms
step:480/1000, tokens seen:31.39M, avg_train_loss:nan time:1873/356s step_avg:356ms
step:480/1000, tokens seen: 31.46M, val_loss:nan train_time:167.43s step_avg:356ms
step:490/1000, tokens seen:32.05M, avg_train_loss:nan time:1911/356s step_avg:356ms
step:490/1000, tokens seen: 32.11M, val_loss:nan train_time:170.99s step_avg:356ms
step:500/1000, tokens seen:32.70M, avg_train_loss:nan time:1950/356s step_avg:356ms
step:500/1000, tokens seen: 32.77M, val_loss:nan train_time:174.54s step_avg:356ms
step:510/1000, tokens seen:33.36M, avg_train_loss:nan time:1988/356s step_avg:356ms
step:510/1000, tokens seen: 33.42M, val_loss:nan train_time:178.09s step_avg:356ms
step:520/1000, tokens seen:34.01M, avg_train_loss:nan time:2026/356s step_avg:356ms
step:520/1000, tokens seen: 34.08M, val_loss:nan train_time:181.65s step_avg:356ms
step:530/1000, tokens seen:34.67M, avg_train_loss:nan time:2065/356s step_avg:356ms
step:530/1000, tokens seen: 34.73M, val_loss:nan train_time:185.20s step_avg:356ms
step:540/1000, tokens seen:35.32M, avg_train_loss:nan time:2103/356s step_avg:356ms
step:540/1000, tokens seen: 35.39M, val_loss:nan train_time:188.76s step_avg:356ms
step:550/1000, tokens seen:35.98M, avg_train_loss:nan time:2142/356s step_avg:356ms
step:550/1000, tokens seen: 36.04M, val_loss:nan train_time:192.31s step_avg:356ms
step:560/1000, tokens seen:36.63M, avg_train_loss:nan time:2180/356s step_avg:356ms
step:560/1000, tokens seen: 36.70M, val_loss:nan train_time:195.87s step_avg:356ms
step:570/1000, tokens seen:37.29M, avg_train_loss:nan time:2218/356s step_avg:356ms
step:570/1000, tokens seen: 37.36M, val_loss:nan train_time:199.42s step_avg:356ms
step:580/1000, tokens seen:37.95M, avg_train_loss:nan time:2257/356s step_avg:356ms
step:580/1000, tokens seen: 38.01M, val_loss:nan train_time:202.97s step_avg:356ms
step:590/1000, tokens seen:38.60M, avg_train_loss:nan time:2295/356s step_avg:356ms
step:590/1000, tokens seen: 38.67M, val_loss:nan train_time:206.53s step_avg:356ms
step:600/1000, tokens seen:39.26M, avg_train_loss:nan time:2334/356s step_avg:356ms
step:600/1000, tokens seen: 39.32M, val_loss:nan train_time:210.08s step_avg:356ms
step:610/1000, tokens seen:39.91M, avg_train_loss:nan time:2372/356s step_avg:356ms
step:610/1000, tokens seen: 39.98M, val_loss:nan train_time:213.63s step_avg:356ms
step:620/1000, tokens seen:40.57M, avg_train_loss:nan time:2410/356s step_avg:356ms
step:620/1000, tokens seen: 40.63M, val_loss:nan train_time:217.19s step_avg:356ms
step:630/1000, tokens seen:41.22M, avg_train_loss:nan time:2449/356s step_avg:356ms
step:630/1000, tokens seen: 41.29M, val_loss:nan train_time:220.74s step_avg:356ms
step:640/1000, tokens seen:41.88M, avg_train_loss:nan time:2487/356s step_avg:356ms
step:640/1000, tokens seen: 41.94M, val_loss:nan train_time:224.29s step_avg:356ms
step:650/1000, tokens seen:42.53M, avg_train_loss:nan time:2526/356s step_avg:356ms
step:650/1000, tokens seen: 42.60M, val_loss:nan train_time:227.84s step_avg:356ms
step:660/1000, tokens seen:43.19M, avg_train_loss:nan time:2564/356s step_avg:356ms
step:660/1000, tokens seen: 43.25M, val_loss:nan train_time:231.40s step_avg:356ms
step:670/1000, tokens seen:43.84M, avg_train_loss:nan time:2602/356s step_avg:356ms
step:670/1000, tokens seen: 43.91M, val_loss:nan train_time:234.95s step_avg:356ms
step:680/1000, tokens seen:44.50M, avg_train_loss:nan time:2641/356s step_avg:356ms
step:680/1000, tokens seen: 44.56M, val_loss:nan train_time:238.51s step_avg:356ms
step:690/1000, tokens seen:45.15M, avg_train_loss:nan time:2679/356s step_avg:356ms
step:690/1000, tokens seen: 45.22M, val_loss:nan train_time:242.06s step_avg:356ms
step:700/1000, tokens seen:45.81M, avg_train_loss:nan time:2718/356s step_avg:356ms
step:700/1000, tokens seen: 45.88M, val_loss:nan train_time:245.62s step_avg:356ms
step:710/1000, tokens seen:46.47M, avg_train_loss:nan time:2756/356s step_avg:356ms
step:710/1000, tokens seen: 46.53M, val_loss:nan train_time:249.17s step_avg:356ms
step:720/1000, tokens seen:47.12M, avg_train_loss:nan time:2794/356s step_avg:356ms
step:720/1000, tokens seen: 47.19M, val_loss:nan train_time:252.72s step_avg:356ms
step:730/1000, tokens seen:47.78M, avg_train_loss:nan time:2833/356s step_avg:356ms
step:730/1000, tokens seen: 47.84M, val_loss:nan train_time:256.27s step_avg:356ms
step:740/1000, tokens seen:48.43M, avg_train_loss:nan time:2871/356s step_avg:356ms
step:740/1000, tokens seen: 48.50M, val_loss:nan train_time:259.84s step_avg:356ms
step:750/1000, tokens seen:49.09M, avg_train_loss:nan time:2910/356s step_avg:356ms
step:750/1000, tokens seen: 49.15M, val_loss:nan train_time:263.39s step_avg:356ms
step:760/1000, tokens seen:49.74M, avg_train_loss:nan time:2948/356s step_avg:356ms
step:760/1000, tokens seen: 49.81M, val_loss:nan train_time:266.95s step_avg:356ms
step:770/1000, tokens seen:50.40M, avg_train_loss:nan time:2986/356s step_avg:356ms
step:770/1000, tokens seen: 50.46M, val_loss:nan train_time:270.51s step_avg:356ms
step:780/1000, tokens seen:51.05M, avg_train_loss:nan time:3025/356s step_avg:356ms
step:780/1000, tokens seen: 51.12M, val_loss:nan train_time:274.06s step_avg:356ms
step:790/1000, tokens seen:51.71M, avg_train_loss:nan time:3063/356s step_avg:356ms
step:790/1000, tokens seen: 51.77M, val_loss:nan train_time:277.62s step_avg:356ms
step:800/1000, tokens seen:52.36M, avg_train_loss:nan time:3102/356s step_avg:356ms
step:800/1000, tokens seen: 52.43M, val_loss:nan train_time:281.17s step_avg:356ms
step:810/1000, tokens seen:53.02M, avg_train_loss:nan time:3140/356s step_avg:356ms
step:810/1000, tokens seen: 53.08M, val_loss:nan train_time:284.72s step_avg:356ms
step:820/1000, tokens seen:53.67M, avg_train_loss:nan time:3178/356s step_avg:356ms
step:820/1000, tokens seen: 53.74M, val_loss:nan train_time:288.28s step_avg:356ms
step:830/1000, tokens seen:54.33M, avg_train_loss:nan time:3217/356s step_avg:356ms
step:830/1000, tokens seen: 54.39M, val_loss:nan train_time:291.83s step_avg:356ms
step:840/1000, tokens seen:54.98M, avg_train_loss:nan time:3255/356s step_avg:356ms
step:840/1000, tokens seen: 55.05M, val_loss:nan train_time:295.39s step_avg:356ms
step:850/1000, tokens seen:55.64M, avg_train_loss:nan time:3294/356s step_avg:356ms
step:850/1000, tokens seen: 55.71M, val_loss:nan train_time:298.94s step_avg:356ms
step:860/1000, tokens seen:56.30M, avg_train_loss:nan time:3332/356s step_avg:356ms
step:860/1000, tokens seen: 56.36M, val_loss:nan train_time:302.49s step_avg:356ms
step:870/1000, tokens seen:56.95M, avg_train_loss:nan time:3370/356s step_avg:356ms
step:870/1000, tokens seen: 57.02M, val_loss:nan train_time:306.05s step_avg:356ms
step:880/1000, tokens seen:57.61M, avg_train_loss:nan time:3409/356s step_avg:356ms
step:880/1000, tokens seen: 57.67M, val_loss:nan train_time:309.60s step_avg:356ms
step:890/1000, tokens seen:58.26M, avg_train_loss:nan time:3447/356s step_avg:356ms
step:890/1000, tokens seen: 58.33M, val_loss:nan train_time:313.16s step_avg:356ms
step:900/1000, tokens seen:58.92M, avg_train_loss:nan time:3486/356s step_avg:356ms
step:900/1000, tokens seen: 58.98M, val_loss:nan train_time:316.71s step_avg:356ms
step:910/1000, tokens seen:59.57M, avg_train_loss:nan time:3524/356s step_avg:356ms
step:910/1000, tokens seen: 59.64M, val_loss:nan train_time:320.26s step_avg:356ms
step:920/1000, tokens seen:60.23M, avg_train_loss:nan time:3563/356s step_avg:356ms
step:920/1000, tokens seen: 60.29M, val_loss:nan train_time:323.82s step_avg:356ms
step:930/1000, tokens seen:60.88M, avg_train_loss:nan time:3601/356s step_avg:356ms
step:930/1000, tokens seen: 60.95M, val_loss:nan train_time:327.37s step_avg:356ms
step:940/1000, tokens seen:61.54M, avg_train_loss:nan time:3639/356s step_avg:356ms
step:940/1000, tokens seen: 61.60M, val_loss:nan train_time:330.93s step_avg:356ms
step:950/1000, tokens seen:62.19M, avg_train_loss:nan time:3678/356s step_avg:356ms
step:950/1000, tokens seen: 62.26M, val_loss:nan train_time:334.48s step_avg:356ms
step:960/1000, tokens seen:62.85M, avg_train_loss:nan time:3716/356s step_avg:356ms
step:960/1000, tokens seen: 62.91M, val_loss:nan train_time:338.03s step_avg:356ms
step:970/1000, tokens seen:63.50M, avg_train_loss:nan time:3755/356s step_avg:356ms
step:970/1000, tokens seen: 63.57M, val_loss:nan train_time:341.59s step_avg:356ms
step:980/1000, tokens seen:64.16M, avg_train_loss:nan time:3793/356s step_avg:356ms
step:980/1000, tokens seen: 64.23M, val_loss:nan train_time:345.14s step_avg:356ms
step:990/1000, tokens seen:64.82M, avg_train_loss:nan time:3831/356s step_avg:356ms
step:990/1000, tokens seen: 64.88M, val_loss:nan train_time:348.69s step_avg:356ms
step:1000/1000, tokens seen:65.47M, avg_train_loss:nan time:3870/356s step_avg:356ms
step:1000/1000, tokens seen: 65.54M, val_loss:nan train_time:352.25s step_avg:356ms
Total training time: 3904.61s
peak memory consumption: 31760 MiB
